<?xml version="1.0" encoding="utf-8"?>
<django-objects version="1.0">
    <object pk="288" model="buildingblock.buildingblock">
        <field type="CharField" name="type">operator</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Item Group Mixer</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "mix",
    "preconditions": [
      {
        "id": "list1",
        "label": {"en-gb": "An item group"},
        "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
        "positive": "true"
      },
      {
        "id": "list2",
        "label": {"en-gb": "An item group"},
        "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
        "positive": "true"
      }
    ],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/operators/listMixer.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This operator converts two item lists into a mixed item list"},
  "homepage": "http://www.deri.ie/eBayList",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/eBayList.png",
  "id": 288,
  "label": {"en-gb": "Item Group Mixer"},
  "libraries": [],
  "name": "Item Group Mixer",
  "postconditions": [{
    "id": "mixedList",
    "label": {"en-gb": "A mixed item group"},
    "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/eBayList-screenshot.jpg",
  "tags": [
    {"label": {"en-gb": "mixer"}},
    {"label": {"en-gb": "generic"}}
  ],
  "triggers": [],
  "type": "operator",
  "uri": "http://localhost:9000/FASTCatalogue/operators/288",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/operators/288</field>
    </object>
    <object pk="301" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Suggestion Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "fetch",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "An Amazon item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonSuggetionListService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides suggestions related to a product in Amazon Catalogue"},
  "homepage": "http://www.deri.ie/amazonSuggetionListService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSuggetionListService.png",
  "id": 301,
  "label": {"en-gb": "Amazon Suggestions"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Amazon Suggestion Service",
  "postconditions": [
    {
      "id": "list",
      "label": {"en-gb": "A product list"},
      "pattern": "?PList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ProductList",
      "positive": "true"
    },
    {
      "id": "message",
      "label": {"en-gb": "A message"},
      "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonSuggetionListService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "suggestion"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["list"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/301",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/301</field>
    </object>
    <object pk="308" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Amazon Search Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:24</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "filter",
      "label": {"en-gb": "A search criteria"},
      "pattern": "?F http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/SearchCriteria",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazon/amazonGenericSearchService.src.js",
  "creationDate": "2011-02-01T13:06:24+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides a list of all data items that match the query string in Amazon"},
  "homepage": "hhttp://www.deri.ie/amazonSearchService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearchService.png",
  "id": 308,
  "label": {"en-gb": "Generic Amazon Search Service"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Generic Amazon Search Service",
  "parameterized": true,
  "postconditions": [
    {
      "id": "list",
      "label": {"en-gb": "A Generic Item List"},
      "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
      "positive": "true"
    },
    {
      "id": "message",
      "label": {"en-gb": "A message"},
      "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericMessage",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonList-screenshot.jpg",
  "tags": [
    {"label": {"en-gb": "amazon"}},
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "shopping"}},
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["itemList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/308",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/308</field>
    </object>
    <object pk="316" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Suggestion Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:28</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/amazonSuggestion.scr.html",
  "creationDate": "2011-02-01T13:06:28+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the list of products related to a given one. It allows users select a new product from this list."},
  "homepage": "http://www.deri.ie/amazonSuggestion",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSuggestion.png",
  "id": 316,
  "label": {"en-gb": "Suggestion List"},
  "name": "Amazon Suggestion Screen",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "An item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
    "positive": "true"
  }],
  "preconditions": [{
    "id": "item",
    "label": {"en-gb": "An item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonSuggestion.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "suggestion"}},
    {"label": {"en-gb": "list"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/316",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/316</field>
    </object>
    <object pk="317" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Search Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:28</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/genericSearch.scr.html",
  "creationDate": "2011-02-01T13:06:28+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen allows users to look for a item, providing a keyword search interface. It produces a search criteria or filter fact."},
  "homepage": "http://www.deri.ie/amazonSearch",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearch.png",
  "id": 317,
  "label": {"en-gb": "Generic Search Screen"},
  "name": "Generic Search Screen",
  "postconditions": [{
    "id": "filter",
    "label": {"en-gb": "A search criteria"},
    "pattern": "?F http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/SearchCriteria",
    "positive": "true"
  }],
  "preconditions": [],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonSearch.png",
  "tags": [
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "search"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/317",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/317</field>
    </object>
    <object pk="318" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Product Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:28</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/amazonProduct.scr.html",
  "creationDate": "2011-02-01T13:06:28+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the the details of a product in Amazon"},
  "homepage": "http://www.deri.ie/amazonProduct",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonProduct.png",
  "id": 318,
  "label": {"en-gb": "Product Details"},
  "name": "Amazon Product Screen",
  "postconditions": [{
    "id": "cart",
    "label": {"en-gb": "An shopping cart"},
    "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
    "positive": "true"
  }],
  "preconditions": [{
    "id": "item",
    "label": {"en-gb": "An item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonProductDetail.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "product"}},
    {"label": {"en-gb": "details"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/318",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/318</field>
    </object>
    <object pk="314" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Price Comparative Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:28</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/amazonPrice.scr.html",
  "creationDate": "2011-02-01T13:06:28+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows a price comparative for a given product."},
  "homepage": "http://www.deri.ie/amazonPrice",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonPrice.png",
  "id": 314,
  "label": {"en-gb": "Price Comparative"},
  "name": "Amazon Price Comparative Screen",
  "postconditions": [{
    "id": "cart",
    "label": {"en-gb": "An shopping cart"},
    "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
    "positive": "true"
  }],
  "preconditions": [{
    "id": "item",
    "label": {"en-gb": "An item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonPriceComparative.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "comparative"}},
    {"label": {"en-gb": "list"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/314",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/314</field>
    </object>
    <object pk="315" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Order Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:28</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/amazonOrder.scr.html",
  "creationDate": "2011-02-01T13:06:28+0100",
  "creator": "admin",
  "description": {"en-gb": "This form allows users to purchase their shopping cart. It shows an Amazon interface to fulfill the required data to purchase the shopping cart"},
  "homepage": "http://www.deri.ie/amazonOrder",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonOrder.png",
  "id": 315,
  "label": {"en-gb": "Order"},
  "name": "Amazon Order Screen",
  "postconditions": [],
  "preconditions": [{
    "id": "purchaseURL",
    "label": {"en-gb": "A Amazon Purchase URL"},
    "pattern": "?P http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonOrder.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "order"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/315",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/315</field>
    </object>
    <object pk="313" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Shopping Cart Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:27</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/amazonShopping.scr.html",
  "creationDate": "2011-02-01T13:06:27+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the list of products added to the user shopping cart. It allows users to update product quantity and clear the cart."},
  "homepage": "http://www.deri.ie/amazonShopping",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonShopping.png",
  "id": 313,
  "label": {"en-gb": "Shopping Cart"},
  "name": "Amazon Shopping Cart Screen",
  "postconditions": [
    {
      "id": "notpurchase",
      "label": {"en-gb": "A purchase"},
      "pattern": "?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL",
      "positive": "false"
    },
    {
      "id": "purchase",
      "label": {"en-gb": "A purchase"},
      "pattern": "?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL",
      "positive": "true"
    },
    {
      "id": "item",
      "label": {"en-gb": "An item"},
      "origin": "amazonShoppingCartForm1",
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    }
  ],
  "preconditions": [{
    "id": "cart",
    "label": {"en-gb": "A Cart"},
    "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonShoppingCart.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "cart"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/313",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/313</field>
    </object>
    <object pk="311" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Search Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:27</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/amazonSearch.scr.html",
  "creationDate": "2011-02-01T13:06:27+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen allows users to look for a product in Amazon, providing a keyword search interface. It produces a search criteria or filter fact."},
  "homepage": "http://www.deri.ie/amazonSearch",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearch.png",
  "id": 311,
  "label": {"en-gb": "Product Search"},
  "name": "Amazon Search Screen",
  "postconditions": [{
    "id": "filter",
    "label": {"en-gb": "A search criteria"},
    "pattern": "?F http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#SearchRequest",
    "positive": "true"
  }],
  "preconditions": [],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonSearch.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "search"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/311",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/311</field>
    </object>
    <object pk="312" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Ebay List Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:27</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/eBayList.scr.html",
  "creationDate": "2011-02-01T13:06:27+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the results of a given search in eBay of a related Amazon product. It allows users to choose a product to see its details"},
  "homepage": "http://www.deri.ie/eBayList",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/eBayList.png",
  "id": 312,
  "label": {"en-gb": "Ebay List"},
  "name": "Ebay List Screen",
  "postconditions": [{
    "id": "itemEbay",
    "label": {"en-gb": "An eBay item"},
    "pattern": "?eItem http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://developer.ebay.com/DevZone/shopping/docs/CallRef/GetSingleItem.html#Request",
    "positive": "true"
  }],
  "preconditions": [{
    "id": "item",
    "label": {"en-gb": "An Amazon item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/ebayComparative.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "ebay"}},
    {"label": {"en-gb": "list"}}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/312",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/312</field>
    </object>
    <object pk="310" model="buildingblock.buildingblock">
        <field type="CharField" name="type">screen</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon List Screen</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:24</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "code": "http://demo.fast.morfeo-project.org/gvsdata/screens/amazonList.scr.html",
  "creationDate": "2011-02-01T13:06:24+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the results of a given search in Amazon. It allows users to choose a product to see its details."},
  "homepage": "http://www.deri.ie/amazonList",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonList.png",
  "id": 310,
  "label": {"en-gb": "Product List"},
  "name": "Amazon List Screen",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "An item"},
    "pattern": "?I http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
    "positive": "true"
  }],
  "preconditions": [{
    "id": "searchCriteria",
    "label": {"en-gb": "A search criteria"},
    "pattern": "?F http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#SearchRequest",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://localhost:8010/images/screenshots/amazonProductList.png",
  "tags": [
    {"label": {"en-gb": "scratch"}},
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {
      "en-gb": "list",
      "es-es": "lista"
    }}
  ],
  "type": "screen",
  "uri": "http://localhost:9000/FASTCatalogue/screens/310",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/screens/310</field>
    </object>
    <object pk="309" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Amazon Lookup Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:24</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "A generic item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazon/amazonGenericLookupService.src.js",
  "creationDate": "2011-02-01T13:06:24+0100",
  "creator": "admin",
  "description": {"en-gb": "This service search information about an Amazon product"},
  "homepage": "http://www.deri.ie/amazonLookupService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonLookupService.png",
  "id": 309,
  "label": {"en-gb": "Generic Amazon Lookup Service"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Generic Amazon Lookup Service",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "A generic item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonLookupService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "item"}}
  ],
  "triggers": ["newItem"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/309",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/309</field>
    </object>
    <object pk="307" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Google Base Lookup Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:24</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "A generic item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/googlebase/googlebaseGenericLookupService.src.js",
  "creationDate": "2011-02-01T13:06:24+0100",
  "creator": "admin",
  "description": {"en-gb": "This service search information about an Google Base product"},
  "homepage": "http://www.deri.ie/amazonLookupService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonLookupService.png",
  "id": 307,
  "label": {"en-gb": "Generic Google Base Lookup Service"},
  "libraries": [],
  "name": "Generic Google Base Lookup Service",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "A generic item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonLookupService.jpg",
  "tags": [
    {"label": {"en-gb": "google"}},
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "item"}}
  ],
  "triggers": ["newItem"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/307",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/307</field>
    </object>
    <object pk="306" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Google Base Search Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "filter",
      "label": {"en-gb": "A search criteria"},
      "pattern": "?F http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/SearchCriteria",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/googlebase/googlebaseGenericSearchService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides a list of all data items that match the query string in Google Base"},
  "homepage": "hhttp://www.deri.ie/amazonSearchService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearchService.png",
  "id": 306,
  "label": {"en-gb": "Generic Google Base Search Service"},
  "libraries": [],
  "name": "Generic Google Base Search Service",
  "parameterized": true,
  "postconditions": [{
    "id": "list",
    "label": {"en-gb": "A Generic Item List"},
    "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonList-screenshot.jpg",
  "tags": [
    {"label": {"en-gb": "google"}},
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "shopping"}},
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["itemList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/306",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/306</field>
    </object>
    <object pk="304" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Nvivo Search Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "filter",
      "label": {"en-gb": "A search criteria"},
      "pattern": "?F http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/nvivo/EventSearchCriteria",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/nvivo/nvivoSearchService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "Returns the gigs that will be happening at a specific venue, city"},
  "homepage": "hhttp://www.deri.ie/amazonSearchService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearchService.png",
  "id": 304,
  "label": {"en-gb": "Nvivo Search Service"},
  "libraries": [],
  "name": "Nvivo Search Service",
  "parameterized": true,
  "postconditions": [{
    "id": "list",
    "label": {"en-gb": "Nvivo Event List"},
    "pattern": "?EList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/nvivo/EventList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonList-screenshot.jpg",
  "tags": [
    {"label": {"en-gb": "nvivo"}},
    {"label": {"en-gb": "events"}},
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["eventList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/304",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/304</field>
    </object>
    <object pk="305" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Google Base Search Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "filter",
      "label": {"en-gb": "A search criteria"},
      "pattern": "?Filter http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/google/BaseSearchCriteria",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/googlebase/googlebaseSearchService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides a list of all data items that match the query string in Google Base"},
  "homepage": "hhttp://www.deri.ie/amazonSearchService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearchService.png",
  "id": 305,
  "label": {"en-gb": "Google Base Search Service"},
  "libraries": [],
  "name": "Google Base Search Service",
  "parameterized": true,
  "postconditions": [{
    "id": "list",
    "label": {"en-gb": "A Google Base Item List"},
    "pattern": "?IList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/google/BaseList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonList-screenshot.jpg",
  "tags": [
    {"label": {"en-gb": "google"}},
    {"label": {"en-gb": "shopping"}},
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["itemList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/305",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/305</field>
    </object>
    <object pk="303" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Ebay Search Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "filter",
      "label": {"en-gb": "A filter"},
      "pattern": "?eFilter http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/SearchCriteria",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/ebay/ebayGenericSearchService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides information about products in eBay Catalogue"},
  "homepage": "http://www.deri.ie/ebaySearchService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/ebaySearchService.png",
  "id": 303,
  "label": {"en-gb": "Generic Ebay Search Service"},
  "libraries": [],
  "name": "Generic Ebay Search Service",
  "postconditions": [{
    "id": "list",
    "label": {"en-gb": "A Generic Item List"},
    "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/ebaySearchService.jpg",
  "tags": [
    {"label": {"en-gb": "ebay"}},
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["itemList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/303",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/303</field>
    </object>
    <object pk="302" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic eBay Lookup Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "A generic item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/ebay/ebayGenericLookupService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service search information about an eBay product"},
  "homepage": "http://www.deri.ie/amazonLookupService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonLookupService.png",
  "id": 302,
  "label": {"en-gb": "Generic eBay Lookup Service"},
  "libraries": [],
  "name": "Generic eBay Lookup Service",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "A generic item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonLookupService.jpg",
  "tags": [
    {"label": {"en-gb": "ebay"}},
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "item"}}
  ],
  "triggers": ["newItem"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/302",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/302</field>
    </object>
    <object pk="300" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Price Comparative Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "fetch",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "An item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonPriceComparativeService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides a price comparative related to an Amazon product"},
  "homepage": "http://www.deri.ie/amazonPriceComparativeService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonPriceComparativeService.png",
  "id": 300,
  "label": {"en-gb": "Amazon Price Comparative"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Amazon Price Comparative Service",
  "postconditions": [{
    "id": "list",
    "label": {"en-gb": "A product list"},
    "pattern": "?OList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#OfferList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonPriceComparativeService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "price"}},
    {"label": {"en-gb": "comparative"}}
  ],
  "triggers": ["productList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/300",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/300</field>
    </object>
    <object pk="299" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Update Amazon Cart Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "updateService",
    "preconditions": [
      {
        "id": "cart",
        "label": {"en-gb": "A shopping cart"},
        "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
        "positive": "true"
      },
      {
        "id": "update",
        "label": {"en-gb": "A shopping cart update"},
        "pattern": "?UCart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#UpdatingCart",
        "positive": "true"
      }
    ],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonUpdateCartService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service updates an Amazon shopping cart"},
  "homepage": "http://www.deri.ie/amazonUpdateCartService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonUpdateCartService.png",
  "id": 299,
  "label": {"en-gb": "Update Amazon Shopping Cart"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Update Amazon Cart Service",
  "postconditions": [{
    "id": "purchase",
    "label": {"en-gb": "A purchase"},
    "pattern": "?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL",
    "positive": "false"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonUpdateCartService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "cart"}},
    {"label": {"en-gb": "shopping"}},
    {"label": {"en-gb": "update"}}
  ],
  "triggers": ["cartUpdated"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/299",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/299</field>
    </object>
    <object pk="298" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Search Amazon Cart Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "fetch",
    "preconditions": [{
      "id": "cart",
      "label": {"en-gb": "A shopping cart"},
      "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonSearchCartService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides information about user shopping cart"},
  "homepage": "http://www.deri.ie/amazonSearchCartService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearchCartService.png",
  "id": 298,
  "label": {"en-gb": "Amazon Cart"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Search Amazon Cart Service",
  "postconditions": [
    {
      "id": "list",
      "label": {"en-gb": "A product list"},
      "pattern": "?PList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ProductList",
      "positive": "true"
    },
    {
      "id": "message",
      "label": {"en-gb": "A message"},
      "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonSearchCartService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}},
    {"label": {"en-gb": "cart"}}
  ],
  "triggers": [],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/298",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/298</field>
    </object>
    <object pk="297" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Lookup Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "searchProduct",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "An Amazon item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonLookupService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service search information about an Amazon product"},
  "homepage": "http://www.deri.ie/amazonLookupService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonLookupService.png",
  "id": 297,
  "label": {"en-gb": "Amazon Lookup Service"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Amazon Lookup Service",
  "postconditions": [
    {
      "id": "product",
      "label": {"en-gb": "An item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    },
    {
      "id": "message",
      "label": {"en-gb": "A message"},
      "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonLookupService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "product"}}
  ],
  "triggers": ["newProduct"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/297",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/297</field>
    </object>
    <object pk="296" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Search Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:23</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "search",
    "preconditions": [{
      "id": "filter",
      "label": {"en-gb": "A search criteria"},
      "pattern": "?F http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#SearchRequest",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonSearchService.src.js",
  "creationDate": "2011-02-01T13:06:23+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides information about products in Amazon Catalogue"},
  "homepage": "hhttp://www.deri.ie/amazonSearchService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearchService.png",
  "id": 296,
  "label": {"en-gb": "Amazon Search"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Amazon Search Service",
  "postconditions": [{
    "id": "list",
    "label": {"en-gb": "An Amazon Item List"},
    "pattern": "?PList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ProductList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonList-screenshot.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["productList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/296",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/296</field>
    </object>
    <object pk="294" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Clear Amazon Cart Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "clearService",
    "preconditions": [{
      "id": "cart",
      "label": {"en-gb": "A shopping cart"},
      "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonClearCartService.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This service clears an Amazon shopping cart"},
  "homepage": "http://www.deri.ie/amazonClearCartService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonClearCartService.png",
  "id": 294,
  "label": {"en-gb": "Clear Amazon Shopping Cart"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Clear Amazon Cart Service",
  "postconditions": [{
    "id": "purchase",
    "label": {"en-gb": "A purchase"},
    "pattern": "?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL",
    "positive": "false"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonClearCartService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "clear"}},
    {"label": {"en-gb": "cart"}},
    {"label": {"en-gb": "shopping"}}
  ],
  "triggers": ["cartCleared"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/294",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/294</field>
    </object>
    <object pk="295" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Add Item to Cart Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "add",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "An item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    }],
    "uses": [{
      "id": "cart",
      "uri": "http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart"
    }]
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonAddItemToCartService.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This service adds items to an Amazon shopping cart"},
  "homepage": "http://www.deri.ie/amazonAddItemToCartService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonAddItemToCartService.png",
  "id": 295,
  "label": {"en-gb": "Add Item To Amazon Shopping Cart"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Amazon Add Item to Cart Service",
  "postconditions": [
    {
      "id": "cart",
      "label": {"en-gb": "A shopping cart"},
      "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
      "positive": "true"
    },
    {
      "id": "message",
      "label": {"en-gb": "A message"},
      "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonAddItemToCartService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "item"}},
    {"label": {"en-gb": "cart"}}
  ],
  "triggers": ["message"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/295",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/295</field>
    </object>
    <object pk="293" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Add Offer to Amazon Cart Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "addToCart",
    "preconditions": [{
      "id": "offer",
      "label": {"en-gb": "An offer"},
      "pattern": "?Offer http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Offer",
      "positive": "true"
    }],
    "uses": [{
      "id": "cart",
      "uri": "http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart"
    }]
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/amazonAddOfferToCartService.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This service adds offers to an Amazon shopping cart"},
  "homepage": "http://www.deri.ie/amazonAddOfferToCartService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonAddOfferToCartService.png",
  "id": 293,
  "label": {"en-gb": "Add Offer To Amazon Shopping Cart"},
  "libraries": [
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"
    },
    {
      "language": "JavaScript",
      "source": "http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"
    }
  ],
  "name": "Add Offer to Amazon Cart Service",
  "postconditions": [
    {
      "id": "cart",
      "label": {"en-gb": "A shopping cart"},
      "pattern": "?Cart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart",
      "positive": "true"
    },
    {
      "id": "message",
      "label": {"en-gb": "A message"},
      "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/amazonAddOfferToCartService.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "offer"}},
    {"label": {"en-gb": "shopping"}}
  ],
  "triggers": ["message"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/293",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/293</field>
    </object>
    <object pk="291" model="buildingblock.buildingblock">
        <field type="CharField" name="type">operator</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Item to Ebay Filter</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "createFilter",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "An item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/operators/amazonEbayFilter.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This operator generates an eBay filter from a Amazon item"},
  "homepage": "http://www.deri.ie/eBayList",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/eBayList.png",
  "id": 291,
  "label": {"en-gb": "Ebay List"},
  "libraries": [],
  "name": "Amazon Item to Ebay Filter",
  "postconditions": [{
    "id": "filterEbay",
    "label": {"en-gb": "An eBay filter"},
    "pattern": "?eFilter http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://developer.ebay.com/DevZone/shopping/docs/CallRef/FindItemsAdvanced.html#Request",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/eBayList-screenshot.jpg",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "ebay"}},
    {"label": {"en-gb": "filter"}}
  ],
  "triggers": ["filterEbay"],
  "type": "operator",
  "uri": "http://localhost:9000/FASTCatalogue/operators/291",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/operators/291</field>
    </object>
    <object pk="292" model="buildingblock.buildingblock">
        <field type="CharField" name="type">resource</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Ebay Search Service</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "fetch",
    "preconditions": [{
      "id": "filter",
      "label": {"en-gb": "A filter"},
      "pattern": "?eFilter http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://developer.ebay.com/DevZone/shopping/docs/CallRef/FindItemsAdvanced.html#Request",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/resources/ebaySearchService.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This service provides information about products in eBay Catalogue"},
  "homepage": "http://www.deri.ie/ebaySearchService",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/ebaySearchService.png",
  "id": 292,
  "label": {"en-gb": "eBay Search"},
  "libraries": [],
  "name": "Ebay Search Service",
  "postconditions": [{
    "id": "list",
    "label": {"en-gb": "A product list"},
    "pattern": "?eList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://developer.ebay.com/DevZone/shopping/docs/CallRef/FindItemsAdvanced.html#Response",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://www.deri.ie/ebaySearchService.jpg",
  "tags": [
    {"label": {"en-gb": "ebay"}},
    {"label": {"en-gb": "search"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["productList"],
  "type": "resource",
  "uri": "http://localhost:9000/FASTCatalogue/services/292",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/services/292</field>
    </object>
    <object pk="290" model="buildingblock.buildingblock">
        <field type="CharField" name="type">operator</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Group to Item Filter</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "filter",
    "preconditions": [{
      "id": "list",
      "label": {"en-gb": "An item group"},
      "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/operators/group2itemFilter.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This operator returns the first item that fulfill the contition"},
  "homepage": "http://www.deri.ie/itemFilter",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/itemFilter.png",
  "id": 290,
  "label": {"en-gb": "Group to Item Filter"},
  "libraries": [],
  "name": "Group to Item Filter",
  "parameterTemplate": "[//List of filters (And)\n{\n\"keyField\": \"source\", //Name of the attribute\n\"searchCondition\": \"eq\", //Comparator function: eq (=), ne (!=), lt (&lt;), le (&lt;=), gt (&gt;), ge (&gt;=)\n\"searchValue\": \"Amazon\" //Value to compare\n},\n{\n\"keyField\": \"type\", \n\"searchCondition\": \"eq\",\n\"searchValue\": \"Book\"\n}\n]",
  "postconditions": [{
    "id": "filteredItem",
    "label": {"en-gb": "A filtered item"},
    "pattern": "?Element http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/itemFilter.png",
  "tags": [
    {"label": {"en-gb": "filter"}},
    {"label": {"en-gb": "item"}},
    {"label": {"en-gb": "generic"}}
  ],
  "triggers": [],
  "type": "operator",
  "uri": "http://localhost:9000/FASTCatalogue/operators/290",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/operators/290</field>
    </object>
    <object pk="289" model="buildingblock.buildingblock">
        <field type="CharField" name="type">operator</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Group to Group Filter</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "filter",
    "preconditions": [{
      "id": "list",
      "label": {"en-gb": "An item group"},
      "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/operators/group2groupFilter.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This operator returns the first item that fulfill the contition"},
  "homepage": "http://www.deri.ie/itemFilter",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/itemFilter.png",
  "id": 289,
  "label": {"en-gb": "Group to Group Filter"},
  "libraries": [],
  "name": "Group to Group Filter",
  "parameterTemplate": "[//List of filters (And)\n{\n\"keyField\": \"source\", //Name of the attribute\n\"searchCondition\": \"eq\", //Comparator function: eq (=), ne (!=), lt (&lt;), le (&lt;=), gt (&gt;), ge (&gt;=)\n\"searchValue\": \"Amazon\" //Value to compare\n},\n{\n\"keyField\": \"type\", \n\"searchCondition\": \"eq\",\n\"searchValue\": \"Book\"\n}\n]",
  "postconditions": [{
    "id": "filteredGroup",
    "label": {"en-gb": "A filtered group"},
    "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/itemFilter.png",
  "tags": [
    {"label": {"en-gb": "filter"}},
    {"label": {"en-gb": "item"}},
    {"label": {"en-gb": "generic"}}
  ],
  "triggers": [],
  "type": "operator",
  "uri": "http://localhost:9000/FASTCatalogue/operators/289",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/operators/289</field>
    </object>
    <object pk="287" model="buildingblock.buildingblock">
        <field type="CharField" name="type">operator</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Item to Item Filter</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "filter",
    "preconditions": [{
      "id": "item",
      "label": {"en-gb": "An item"},
      "pattern": "?Element http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/operators/item2itemFilter.src.js",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This operator returns the first item that fulfill the contition"},
  "homepage": "http://www.deri.ie/itemFilter",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/itemFilter.png",
  "id": 287,
  "label": {"en-gb": "Item to Item Filter"},
  "libraries": [],
  "name": "Item to Item Filter",
  "parameterTemplate": "[//List of filters (And)\n{\n\"keyField\": \"source\", //Name of the attribute\n\"searchCondition\": \"eq\", //Comparator function: eq (=), ne (!=), lt (&lt;), le (&lt;=), gt (&gt;), ge (&gt;=)\n\"searchValue\": \"Amazon\" //Value to compare\n},\n{\n\"keyField\": \"type\", \n\"searchCondition\": \"eq\",\n\"searchValue\": \"Book\"\n}\n]",
  "postconditions": [{
    "id": "filteredItem",
    "label": {"en-gb": "A filtered item"},
    "pattern": "?Element http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/itemFilter.png",
  "tags": [
    {"label": {"en-gb": "filter"}},
    {"label": {"en-gb": "item"}},
    {"label": {"en-gb": "generic"}}
  ],
  "triggers": [],
  "type": "operator",
  "uri": "http://localhost:9000/FASTCatalogue/operators/287",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/operators/287</field>
    </object>
    <object pk="285" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Suggestion Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [{
        "id": "item",
        "label": {"en-gb": "An item"},
        "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
        "positive": "true"
      }],
      "uses": []
    },
    {
      "name": "showTable",
      "preconditions": [{
        "id": "list",
        "label": {"en-gb": "A product list"},
        "pattern": "?PList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ProductList",
        "positive": "true"
      }],
      "uses": []
    },
    {
      "name": "showMessage",
      "preconditions": [{
        "id": "message",
        "label": {"en-gb": "A message"},
        "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/amazonSuggestion.src.html",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the list of products related to a given one. It allows users select a new product from this list."},
  "homepage": "http://www.deri.ie/amazonSuggestion",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSuggestion.png",
  "id": 285,
  "label": {"en-gb": "Suggestion List"},
  "libraries": [],
  "name": "Amazon Suggestion Form",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "An item"},
    "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonSuggestion.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "suggestion"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["item"],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/285",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/285</field>
    </object>
    <object pk="286" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Product Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:22</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [],
      "uses": []
    },
    {
      "name": "showProductInfo",
      "preconditions": [{
        "id": "product",
        "label": {"en-gb": "An item"},
        "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
        "positive": "true"
      }],
      "uses": []
    },
    {
      "name": "showMessage",
      "preconditions": [{
        "id": "message",
        "label": {"en-gb": "A message"},
        "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/amazonProduct.src.html",
  "creationDate": "2011-02-01T13:06:22+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the the details of a product in Amazon"},
  "homepage": "http://www.deri.ie/amazonProduct",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonProduct.png",
  "id": 286,
  "label": {"en-gb": "Product Details"},
  "libraries": [],
  "name": "Amazon Product Form",
  "postconditions": [],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonProductDetail.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "product"}},
    {"label": {"en-gb": "details"}}
  ],
  "triggers": ["addToCart"],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/286",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/286</field>
    </object>
    <object pk="283" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Price Comparative Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:21</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [{
        "id": "item",
        "label": {"en-gb": "An item"},
        "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
        "positive": "true"
      }],
      "uses": []
    },
    {
      "name": "showTable",
      "preconditions": [{
        "id": "list",
        "label": {"en-gb": "An offer list"},
        "pattern": "?OList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#OfferList",
        "positive": "true"
      }],
      "uses": []
    },
    {
      "name": "showMessage",
      "preconditions": [{
        "id": "message",
        "label": {"en-gb": "A message"},
        "pattern": "?Message http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Message",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/amazonPrice.src.html",
  "creationDate": "2011-02-01T13:06:21+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows a price comparative for a given product."},
  "homepage": "http://www.deri.ie/amazonPrice",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonPrice.png",
  "id": 283,
  "label": {"en-gb": "Price Comparative"},
  "libraries": [],
  "name": "Amazon Price Comparative Form",
  "postconditions": [{
    "id": "offer",
    "label": {"en-gb": "An offer"},
    "pattern": "?Offer http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Offer",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonPriceComparative.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "price"}},
    {"label": {"en-gb": "comparative"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": ["offer"],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/283",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/283</field>
    </object>
    <object pk="284" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Order Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:21</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "init",
    "preconditions": [{
      "id": "purchase",
      "label": {"en-gb": "A purchase"},
      "pattern": "?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL",
      "positive": "true"
    }],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/amazonOrder.src.html",
  "creationDate": "2011-02-01T13:06:21+0100",
  "creator": "admin",
  "description": {"en-gb": "This form allows users to purchase their shopping cart. It shows an Amazon interface to fulfill the required data to purchase the shopping cart"},
  "homepage": "http://www.deri.ie/amazonOrder",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonOrder.png",
  "id": 284,
  "label": {"en-gb": "Order"},
  "libraries": [],
  "name": "Amazon Order Form",
  "postconditions": [],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonOrder.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "order"}},
    {"label": {"en-gb": "purchase"}}
  ],
  "triggers": [],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/284",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/284</field>
    </object>
    <object pk="282" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Shopping Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:21</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [],
      "uses": []
    },
    {
      "name": "showTable",
      "preconditions": [{
        "id": "list",
        "label": {"en-gb": "A product list"},
        "pattern": "?PList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ProductList",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/amazonShopping.src.html",
  "creationDate": "2011-02-01T13:06:21+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the list of products added to the user shopping cart. It allows users to update product quantity and clear the cart."},
  "homepage": "http://www.deri.ie/amazonShopping",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonShopping.png",
  "id": 282,
  "label": {"en-gb": "Shopping Cart"},
  "libraries": [],
  "name": "Amazon Shopping Form",
  "postconditions": [
    {
      "id": "cartUpdate",
      "label": {"en-gb": "A shopping cart update"},
      "pattern": "?UCart http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#UpdatingCart",
      "positive": "true"
    },
    {
      "id": "purchase",
      "label": {"en-gb": "A purchase"},
      "pattern": "?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL",
      "positive": "true"
    },
    {
      "id": "item",
      "label": {"en-gb": "An item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonShoppingCart.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "cart"}},
    {"label": {"en-gb": "shopping"}}
  ],
  "triggers": [
    "purchase",
    "clearCart",
    "updateCart",
    "newItem"
  ],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/282",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/282</field>
    </object>
    <object pk="281" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Ebay List Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:21</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [],
      "uses": []
    },
    {
      "name": "showTable",
      "preconditions": [{
        "id": "list",
        "label": {"en-gb": "An item"},
        "pattern": "?eList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://developer.ebay.com/DevZone/shopping/docs/CallRef/FindItemsAdvanced.html#Response",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/eBayList.src.html",
  "creationDate": "2011-02-01T13:06:21+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the results of a given search in eBay of a related Amazon product. It allows users to choose a product to see its details"},
  "homepage": "http://www.deri.ie/eBayList",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/eBayList.png",
  "id": 281,
  "label": {"en-gb": "Ebay List"},
  "libraries": [],
  "name": "Ebay List Form",
  "postconditions": [
    {
      "id": "itemEbay",
      "label": {"en-gb": "An eBay item"},
      "pattern": "?eItem http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://developer.ebay.com/DevZone/shopping/docs/CallRef/GetSingleItem.html#Request",
      "positive": "true"
    },
    {
      "id": "filterEbay",
      "label": {"en-gb": "An eBay filter"},
      "pattern": "?eFilter http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://developer.ebay.com/DevZone/shopping/docs/CallRef/FindItemsAdvanced.html#Request",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/ebayComparative.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "ebay"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": [
    "ebayItem",
    "newFilter"
  ],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/281",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/281</field>
    </object>
    <object pk="279" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Detailed List Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:21</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [],
      "uses": []
    },
    {
      "name": "showListElements",
      "preconditions": [{
        "id": "list",
        "label": {"en-gb": "An item group"},
        "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/detailList.src.html",
  "creationDate": "2011-02-01T13:06:21+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the the details of a list of items"},
  "homepage": "http://www.deri.ie/amazonProduct",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonProduct.png",
  "id": 279,
  "label": {"en-gb": "Generic Detailed List Form"},
  "libraries": [],
  "name": "Generic Detailed List Form",
  "parameterTemplate": "{\n    // The itemTitle is a string which represents the type of element being showed\n    // in the form. e.g. \"Product\", \"User\", etc.\n    \"itemTitle\": \"title\", \n    \n    // Elements contains a list of fields which will be shown as relevant information and not\n    // in the \"details\" area. The name of the fields depend on the underlying service being used\n    \"elements\": [\"description\", \"otherField\" /*, ... (More fields)*/]\n}",
  "postconditions": [],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonProductDetail.png",
  "tags": [
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "details"}}
  ],
  "triggers": [],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/279",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/279</field>
    </object>
    <object pk="276" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic List Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:20</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [],
      "uses": []
    },
    {
      "name": "showTable",
      "preconditions": [{
        "id": "list",
        "label": {"en-gb": "A list"},
        "pattern": "?ElementList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/ElementList",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/list.src.html",
  "creationDate": "2011-02-01T13:06:20+0100",
  "creator": "admin",
  "description": {"en-gb": "This form shows a list of items."},
  "homepage": "http://www.deri.ie/amazonList",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonList.png",
  "id": 276,
  "label": {"en-gb": "Generic List Form"},
  "libraries": [],
  "name": "Generic List Form",
  "parameterTemplate": "{\n    /*\n     * The title attribute is a string with a text to show in the top area of\n     * the screen.\n     */\n    \"title\": \"Item list\",\n\n    /*\n     * The logo attribute is a string containing the url of the logo to show in\n     * the top right area of the screen\n     */\n    \"logo\":  \"http://demo.fast.morfeo-project.org/fast/images/gui/fastLogo.png\",\n\n    /*\n     * The columns attribute is a list of column descriptions, each of them containing\n     * the following attributes:\n     *    - field  (required): the input data field to be shown in the column\n     *    - title  (required): the label to show in the header of the column\n     *    - type   (required): data type. It can be text or an image url (img)\n     *    - width  (optional): cell width\n     *    - height (optional): cell height\n     * \n     * If this attribute is not defined, the following columns will be used\n     */\n    \"columns\": [\n            {\n                \"field\": \"image\",\n                \"title\": \"\",\n                \"type\":  \"img\",\n                \"width\": \"80px\",\n                \"heigth\": \"80px\"\n            },{\n                \"field\": \"source\",\n                \"title\": \"Source\",\n                \"type\":  \"text\",\n                \"width\": \"10%\"\n            },{\n                \"field\": \"title\",\n                \"title\": \"Title\",\n                \"type\":  \"text\",\n                \"width\": \"50%\"\n            }, {\n                \"field\": \"type\",\n                \"title\": \"Product Group\",\n                \"width\": \"20%\"\n            }, {\n                \"field\": \"price\",\n                \"title\": \"Price\",\n                \"type\":  \"text\"\n            }\n    ]\n}",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "An item"},
    "pattern": "?Element http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonProductList.png",
  "tags": [
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "list"}}
  ],
  "triggers": [],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/276",
  "user": "admin",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/276</field>
    </object>
    <object pk="277" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:20</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "init",
    "preconditions": [],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/genericForm.src.html",
  "creationDate": "2011-02-01T13:06:20+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen is generic and allows users define fields"},
  "homepage": "http://www.deri.ie/genericForm",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/genericForm.png",
  "id": 277,
  "label": {"en-gb": "Generic Form"},
  "libraries": [],
  "name": "Generic Form",
  "parameterTemplate": "{\n    /*\n     * The acceptButtonLabel attribute is the label of the accept or send button\n     */\n    \"acceptButtonLabel\": \"Accept\",\n\n    /*\n     * The canceltButtonLabel attribute is the label of the clear button. If\n     * this attribute is not used, no reset button will be shown.\n     */\n    \"cancelButtonLabel\": \"Clear\",\n\n    /*\n     * The fields attribute is a list of fields of the form, each of them\n     * containing the following attributes:\n     *     - name(required):  identifier of the field that will be used as a key\n     *                        in the output data.\n     *     - type(optional):  type of the field in text | password | checkbox |\n     *                        textbox. By default: text.\n     *     - label(optional): the label to show for this input entry. If this\n     *                        attribute is not defined, the name attribute will\n     *                        be use.\n     *     - value(optional): the initial value for this field. If this\n     *                        attribute is not defined, the field will be empty\n     *                        at the beginning.\n     *     - required(optional): a boolean value indicating whether this field\n     *                        is required or not.\n     *\n     * If this attribute is not defined, the following fields will be used.\n     */\n    \"fields\": [\n        {\n            \"name\":     \"input\",\n            \"value\":    \"value\"\n        }/*,\n        {\n            // Other field\n            \"name\":     \"pass\",\n            \"type\":     \"password\",\n            \"label\":    \"Password\",\n            \"value\":    \"\",\n            \"required\": true\n        },\n\n        ... more fields ...\n        \n        */\n    ]\n}",
  "postconditions": [{
    "id": "item",
    "label": {"en-gb": "A Item"},
    "pattern": "?Element http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/genericForm.png",
  "tags": [
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "form"}}
  ],
  "triggers": ["newItem"],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/277",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/277</field>
    </object>
    <object pk="280" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon Search Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:21</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [{
    "name": "init",
    "preconditions": [],
    "uses": []
  }],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/amazonSearch.src.html",
  "creationDate": "2011-02-01T13:06:21+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen allows users to look for a product in Amazon, providing a keyword search interface. It produces a search criteria or filter fact."},
  "homepage": "http://www.deri.ie/amazonSearch",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonSearch.png",
  "id": 280,
  "label": {"en-gb": "Product Search"},
  "libraries": [],
  "name": "Amazon Search Form",
  "postconditions": [{
    "id": "filter",
    "label": {"en-gb": "A filter"},
    "pattern": "?Filter http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#SearchRequest",
    "positive": "true"
  }],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonSearch.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "search"}}
  ],
  "triggers": ["newFilter"],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/280",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/280</field>
    </object>
    <object pk="278" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Amazon List Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:21</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [],
      "uses": []
    },
    {
      "name": "showTable",
      "preconditions": [{
        "id": "list",
        "label": {"en-gb": "A product list"},
        "pattern": "?PList http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#ProductList",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/amazonList.src.html",
  "creationDate": "2011-02-01T13:06:21+0100",
  "creator": "admin",
  "description": {"en-gb": "This form shows the results of a given search in Amazon. It allows users to choose a product to see its details"},
  "homepage": "http://www.deri.ie/amazonList",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonList.png",
  "id": 278,
  "label": {"en-gb": "Product List"},
  "libraries": [],
  "name": "Amazon List Form",
  "postconditions": [
    {
      "id": "item",
      "label": {"en-gb": "An item"},
      "pattern": "?Item http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#Item",
      "positive": "true"
    },
    {
      "id": "filter",
      "label": {"en-gb": "A filter"},
      "pattern": "?Filter http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#SearchRequest",
      "positive": "true"
    }
  ],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonProductList.png",
  "tags": [
    {
      "label": {"en-gb": "amazon"},
      "means": "http://dbpedia.org/page/Amazon.com"
    },
    {"label": {"en-gb": "list"}}
  ],
  "triggers": [],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/278",
  "user": "admin",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/278</field>
    </object>
    <object pk="275" model="buildingblock.buildingblock">
        <field type="CharField" name="type">form</field>
        <field to="auth.user" name="author" rel="ManyToOneRel">1</field>
        <field type="CharField" name="name">Generic Detail Form</field>
        <field type="DateTimeField" name="creationDate">2011-02-01 12:06:20</field>
        <field type="CharField" name="version">1.0</field>
        <field type="TextField" name="data">{
  "actions": [
    {
      "name": "init",
      "preconditions": [],
      "uses": []
    },
    {
      "name": "showProductInfo",
      "preconditions": [{
        "id": "product",
        "label": {"en-gb": "An item"},
        "pattern": "?Element http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://localhost:9000/FASTCatalogue/concepts/generic/GenericElement",
        "positive": "true"
      }],
      "uses": []
    }
  ],
  "code": "http://demo.fast.morfeo-project.org/gvsdata/forms/productDetail.src.html",
  "creationDate": "2011-02-01T13:06:20+0100",
  "creator": "admin",
  "description": {"en-gb": "This screen shows the the details of an item"},
  "homepage": "http://www.deri.ie/amazonProduct",
  "icon": "http://demo.fast.morfeo-project.org/gvsdata/images/catalogue/amazonProduct.png",
  "id": 275,
  "label": {"en-gb": "Generic Detail Form"},
  "libraries": [],
  "name": "Generic Detail Form",
  "parameterTemplate": "{\n    // The itemTitle is a string which represents the type of element being showed\n    // in the form. e.g. \"Product\", \"User\", etc.\n    \"itemTitle\": \"title\", \n    \n    // Elements contains a list of fields which will be shown as relevant information and not\n    // in the \"details\" area. The name of the fields depend on the underlying service being used\n    \"elements\": [\"description\", \"otherField\" /*, ... (More fields)*/]\n}",
  "postconditions": [],
  "rights": "http://creativecommons.org/",
  "screenshot": "http://demo.fast.morfeo-project.org/gvsdata/images/screenshots/amazonProductDetail.png",
  "tags": [
    {"label": {"en-gb": "generic"}},
    {"label": {"en-gb": "details"}}
  ],
  "triggers": [],
  "type": "form",
  "uri": "http://localhost:9000/FASTCatalogue/forms/275",
  "version": "1.0"
}</field>
        <field type="DecimalField" name="popularity"><None></None></field>
        <field type="CharField" name="uri">http://localhost:9000/FASTCatalogue/forms/275</field>
    </object>
    <object pk="310" model="buildingblock.screen">
    </object>
    <object pk="311" model="buildingblock.screen">
    </object>
    <object pk="312" model="buildingblock.screen">
    </object>
    <object pk="313" model="buildingblock.screen">
    </object>
    <object pk="314" model="buildingblock.screen">
    </object>
    <object pk="315" model="buildingblock.screen">
    </object>
    <object pk="316" model="buildingblock.screen">
    </object>
    <object pk="317" model="buildingblock.screen">
    </object>
    <object pk="318" model="buildingblock.screen">
    </object>
    <object pk="275" model="buildingblock.form">
    </object>
    <object pk="276" model="buildingblock.form">
    </object>
    <object pk="277" model="buildingblock.form">
    </object>
    <object pk="278" model="buildingblock.form">
    </object>
    <object pk="279" model="buildingblock.form">
    </object>
    <object pk="280" model="buildingblock.form">
    </object>
    <object pk="281" model="buildingblock.form">
    </object>
    <object pk="282" model="buildingblock.form">
    </object>
    <object pk="283" model="buildingblock.form">
    </object>
    <object pk="284" model="buildingblock.form">
    </object>
    <object pk="285" model="buildingblock.form">
    </object>
    <object pk="286" model="buildingblock.form">
    </object>
    <object pk="287" model="buildingblock.operator">
    </object>
    <object pk="288" model="buildingblock.operator">
    </object>
    <object pk="289" model="buildingblock.operator">
    </object>
    <object pk="290" model="buildingblock.operator">
    </object>
    <object pk="291" model="buildingblock.operator">
    </object>
    <object pk="292" model="buildingblock.resource">
    </object>
    <object pk="293" model="buildingblock.resource">
    </object>
    <object pk="294" model="buildingblock.resource">
    </object>
    <object pk="295" model="buildingblock.resource">
    </object>
    <object pk="296" model="buildingblock.resource">
    </object>
    <object pk="297" model="buildingblock.resource">
    </object>
    <object pk="298" model="buildingblock.resource">
    </object>
    <object pk="299" model="buildingblock.resource">
    </object>
    <object pk="300" model="buildingblock.resource">
    </object>
    <object pk="301" model="buildingblock.resource">
    </object>
    <object pk="302" model="buildingblock.resource">
    </object>
    <object pk="303" model="buildingblock.resource">
    </object>
    <object pk="304" model="buildingblock.resource">
    </object>
    <object pk="305" model="buildingblock.resource">
    </object>
    <object pk="306" model="buildingblock.resource">
    </object>
    <object pk="307" model="buildingblock.resource">
    </object>
    <object pk="308" model="buildingblock.resource">
    </object>
    <object pk="309" model="buildingblock.resource">
    </object>
    <object pk="276" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">276</field>
        <field type="TextField" name="code">&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
        &lt;style type="text/css"&gt;
            .list_title {
                color:       #FEBF43;
                font-family: Arial,Helvetica,sans-serif;
                font-size:   24px;
                font-style:  italic;
                font-weight: bold;
                margin:      5px;
                text-align:  center;
            }

            .pages {
                color: #FEBF43;
                font-weight: bold;
                padding: 10px;
            }

            .firstColumn {
                -moz-border-radius: 13px 0px 0px 0px;
            }

            .lastColumn {
                -moz-border-radius: 0px 13px 0px 0px;
            }

            .previousButton, .nextButton {
                visibility: hidden;
            }

            .imgCell {
                text-align:center;
            }

            .imgCell img{
                max-width:150px;
                max-heigh:150px;
            }

            .loadingImg {
                text-align: center;
            }

            .logoLayer {
                position: absolute;
                right: 0px;
                top: 3px;
            }
            .logoLayer img {
                height: 35px;
            }

            .selectCell {
                border-right: none;
            }

            .buttonArea {
                text-align: center;
            }

            .button {
                cursor: pointer;
            }

            tr.selected {
                background: #FFF8E8;
            }
        &lt;/style&gt;

        &lt;script type="text/javascript"&gt;

            var {{buildingblockId}} = Class.create(BuildingBlock,{

                init: function () {
                    var defaultParams = {
                        'title': 'Item list',
                        'logo':  'http://demo.fast.morfeo-project.org/fast/images/gui/fastLogo.png',
                        'columns': [
                                {
                                    field: 'image',
                                    title: '',
                                    type:  'img',
                                    width: '80px',
                                    heigth: '80px'
                                },{
                                    field: 'source',
                                    title: 'Source',
                                    type:  'text',
                                    width: '10%'
                                },{
                                    field: 'title',
                                    title: 'Title',
                                    type:  'text',
                                    width: '50%'
                                }, {
                                    field: 'type',
                                    title: 'Product Group',
                                    width: '20%'
                                }, {
                                    field: 'price',
                                    title: 'Price',
                                    type:  'text'
                                }
                        ]
                    };
                    var params = Object.extend(defaultParams, this.parameter);
                    this._columns = params.columns;

                    $("{{screenId}}_logo").href = params.logo;
                    $("{{screenId}}_title").update(params.title);

                    // Base elements
                    this._loadingImg = $("{{screenId}}_loadingImg");

/*                    this._nextButton = $("{{screenId}}_nextButton");
                    this._nextButton.observe('click', this.nextPage.bind(this));

                    this._previousButton = $("{{screenId}}_previousButton")
                    this._previousButton.observe('click', this.previousPage.bind(this));*/

                    this._tableHeader = $("{{screenId}}_tableHeader");
                    this._tableHeader.update();
                    var row = this._tableHeader.insertRow(-1);
                    for (var i = 0; i &lt; this._columns.length; i++) {
                        var cell = document.createElement('th');
                        row.appendChild(cell);
                        cell.innerHTML = this._columns[i].title;
                        cell.style.width = this._columns[i].width;

                        if (i == 0) {
                            cell.addClassName('firstColumn');
                        }
                    }
                    // select column
                    var cell = document.createElement('th');
                    row.appendChild(cell);
                    cell.addClassName('lastColumn');

                    this._tableBody = $("{{screenId}}_listBody");
                    this._tableBody.update("");

                    this._buttonArea = $("{{screenId}}_buttonArea");
                    this._buttonArea.hide();

                    this.showProgress();

                    this._items = [];
                    this._selectedItem = null;
                },

                productDetail: function (index) {
                    this.clearSelected();

                    var entryInfo = this._items[index];
                    entryInfo.row.addClassName('selected');
                    this._selectedItem = entryInfo;

                    var item = {
                        id: 'item',
                        data: entryInfo.entry
                    };

                    this.manageData(null, [item], []);
                },

                clearSelected: function () {
                    if (this._selectedItem !== null) {
                        this._selectedItem.row.removeClassName('selected');
                        this._selectedItem = null;
                    }
                },

                showProgress: function () {
                    this._loadingImg.show();
                },

                showTable: function (_listFact) {
                    var listFact = _listFact.data;

                    this._loadingImg.hide();

                    this._tableBody.update("");
                    this._items = [];

                    // Print the appropriate elements
                    //for (var i = 0; i &lt; listFact.productList.length; i++) {
                    for (var i = 0; i &lt; listFact.length; i++) {
                        //var entry = listFact.productList[i];
                        var entry = listFact[i];

                        if (!entry)
                            continue

                        var row = this._tableBody.insertRow(-1);

                        for (var j = 0; j &lt; this._columns.length; j++) {
                            var colDef = this._columns[j];
                            var cell = row.insertCell(-1);

                            switch (colDef.type) {
                            case 'img':
                                cell.className = 'imgCell';
                                cell.innerHTML = '';
                                var img = document.createElement('img');
                                img.src = entry[colDef.field];
                                cell.appendChild(img);
                                img.style.maxWidth = cell.width;
                                img.style.maxHeigth = cell.heigth;
                                break;
                            case 'text':
                            default:
                                cell.className = '';
                                cell.innerHTML = entry[colDef.field];
                            }
                        }

                        var selectCell = row.insertCell(-1);
                        selectCell.addClassName('selectCell');
                        var button = document.createElement('input');
                        button.addClassName('button');
                        button.type = 'button';
                        button.value = 'Select';
                        selectCell.appendChild(button);

                        var context = {'form': this, 'item': this._items.length};
                        button.observe('click', function() { this.form.productDetail(this.item);}.bind(context));

                        this._items.push({'entry': entry, 'row': row});
                    }

                    /* Update Interface
                    if (listFact.currentPage &lt; listFact.totalPages - 1) {
                        $("nextButton").setStyle({visibility: "visible"});
                    } else {
                        $("nextButton").setStyle({visibility: "hidden"});
                    }
                    if (listFact.currentPage &gt; 1) {
                        $("previousButton").setStyle({visibility: "visible"});
                    } else {
                        $("previousButton").setStyle({visibility: "hidden"});
                    }

                    if (listFact.totalPages &gt; 0) {
                        $("curPage").innerHTML = listFact.currentPage;
                        $("totalPages").update(listFact.totalPages);
                    } else {
                        $("curPage").innerHTML = "-";
                        $("totalPages").update("-");
                    }*/

                    this._lastFact = listFact;
                }/*,

                nextPage: function () {
                    this._tableBody.update("");
                    this.showProgress();

                    var listFact = this._lastFact;

                    var filter = {
                        id: "filter",
                        data: {
                            productType: listFact.productType,
                            searchText: listFact.searchText,
                            currentPage: parseInt(listFact.currentPage) + 1
                        }
                    };
                    this.manageData(["newFilter"], [filter], []);
                },

                previousPage: function () {
                    this._tableBody.update("");
                    this.showProgress();

                    var listFact = this._lastFact;

                    var filter = {
                                     id: "filter",
                                     data: {
                                         productType: listFact.productType,
                                         searchText:  listFact.searchText,
                                         currentPage: parseInt(listFact.currentPage) - 1
                                     }
                                 };
                    this.manageData(["newFilter"], [filter], []);
                }*/
            });
        &lt;/script&gt;
    &lt;/head&gt;

    &lt;body&gt;
        &lt;div id="{{screenId}}_bodyDiv"&gt;
            &lt;div class="logoLayer"&gt;&lt;img id="{{screenId}}_logo" src="http://demo.fast.morfeo-project.org/fast/images/gui/fastLogo.png" /&gt;&lt;/div&gt;
            &lt;h1 id="{{screenId}}_title" class="list_title"&gt;Item list&lt;/h1&gt;
            &lt;div&gt;
                &lt;table&gt;
                    &lt;thead id="{{screenId}}_tableHeader"&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="{{screenId}}_listBody"&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;div class="loadingImg"&gt;
                    &lt;img id="{{screenId}}_loadingImg" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;
                &lt;/div&gt;               
                &lt;div id="{{screenId}}_buttonArea" class="buttonArea"&gt;
                    &lt;input type="button" id="{{screenId}}_previousButton" class="button previousButton" value="&lt;" /&gt;
                    &lt;span id="pages" class="pages"&gt; Page &lt;span id="curPage"&gt;-&lt;/span&gt;/&lt;span id="totalPages"&gt;-&lt;/span&gt;&lt;/span&gt;
                    &lt;input type="button" id="{{screenId}}_nextButton" class="button nextButton" value="&gt;" /&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
        &lt;style type="text/css"&gt;
            .list_title {
                color:       #FEBF43;
                font-family: Arial,Helvetica,sans-serif;
                font-size:   24px;
                font-style:  italic;
                font-weight: bold;
                margin:      5px;
                text-align:  center;
            }

            .pages {
                color: #FEBF43;
                font-weight: bold;
                padding: 10px;
            }

            .firstColumn {
                -moz-border-radius: 13px 0px 0px 0px;
            }

            .lastColumn {
                -moz-border-radius: 0px 13px 0px 0px;
            }

            .previousButton, .nextButton {
                visibility: hidden;
            }

            .imgCell {
                text-align:center;
            }

            .imgCell img{
                max-width:150px;
                max-heigh:150px;
            }

            .loadingImg {
                text-align: center;
            }

            .logoLayer {
                position: absolute;
                right: 0px;
                top: 3px;
            }
            .logoLayer img {
                height: 35px;
            }

            .selectCell {
                border-right: none;
            }

            .buttonArea {
                text-align: center;
            }

            .button {
                cursor: pointer;
            }

            tr.selected {
                background: #FFF8E8;
            }
        &lt;/style&gt;

        &lt;script type="text/javascript"&gt;

            var {{buildingblockId}} = Class.create(BuildingBlock,{

                init: function () {
                    var defaultParams = {
                        'title': 'Item list',
                        'logo':  'http://demo.fast.morfeo-project.org/fast/images/gui/fastLogo.png',
                        'columns': [
                                {
                                    field: 'image',
                                    title: '',
                                    type:  'img',
                                    width: '80px',
                                    heigth: '80px'
                                },{
                                    field: 'source',
                                    title: 'Source',
                                    type:  'text',
                                    width: '10%'
                                },{
                                    field: 'title',
                                    title: 'Title',
                                    type:  'text',
                                    width: '50%'
                                }, {
                                    field: 'type',
                                    title: 'Product Group',
                                    width: '20%'
                                }, {
                                    field: 'price',
                                    title: 'Price',
                                    type:  'text'
                                }
                        ]
                    };
                    var params = Object.extend(defaultParams, this.parameter);
                    this._columns = params.columns;

                    $("{{screenId}}_logo").href = params.logo;
                    $("{{screenId}}_title").update(params.title);

                    // Base elements
                    this._loadingImg = $("{{screenId}}_loadingImg");

/*                    this._nextButton = $("{{screenId}}_nextButton");
                    this._nextButton.observe('click', this.nextPage.bind(this));

                    this._previousButton = $("{{screenId}}_previousButton")
                    this._previousButton.observe('click', this.previousPage.bind(this));*/

                    this._tableHeader = $("{{screenId}}_tableHeader");
                    this._tableHeader.update();
                    var row = this._tableHeader.insertRow(-1);
                    for (var i = 0; i &lt; this._columns.length; i++) {
                        var cell = document.createElement('th');
                        row.appendChild(cell);
                        cell.innerHTML = this._columns[i].title;
                        cell.style.width = this._columns[i].width;

                        if (i == 0) {
                            cell.addClassName('firstColumn');
                        }
                    }
                    // select column
                    var cell = document.createElement('th');
                    row.appendChild(cell);
                    cell.addClassName('lastColumn');

                    this._tableBody = $("{{screenId}}_listBody");
                    this._tableBody.update("");

                    this._buttonArea = $("{{screenId}}_buttonArea");
                    this._buttonArea.hide();

                    this.showProgress();

                    this._items = [];
                    this._selectedItem = null;
                },

                productDetail: function (index) {
                    this.clearSelected();

                    var entryInfo = this._items[index];
                    entryInfo.row.addClassName('selected');
                    this._selectedItem = entryInfo;

                    var item = {
                        id: 'item',
                        data: entryInfo.entry
                    };

                    this.manageData(null, [item], []);
                },

                clearSelected: function () {
                    if (this._selectedItem !== null) {
                        this._selectedItem.row.removeClassName('selected');
                        this._selectedItem = null;
                    }
                },

                showProgress: function () {
                    this._loadingImg.show();
                },

                showTable: function (_listFact) {
                    var listFact = _listFact.data;

                    this._loadingImg.hide();

                    this._tableBody.update("");
                    this._items = [];

                    // Print the appropriate elements
                    //for (var i = 0; i &lt; listFact.productList.length; i++) {
                    for (var i = 0; i &lt; listFact.length; i++) {
                        //var entry = listFact.productList[i];
                        var entry = listFact[i];

                        if (!entry)
                            continue

                        var row = this._tableBody.insertRow(-1);

                        for (var j = 0; j &lt; this._columns.length; j++) {
                            var colDef = this._columns[j];
                            var cell = row.insertCell(-1);

                            switch (colDef.type) {
                            case 'img':
                                cell.className = 'imgCell';
                                cell.innerHTML = '';
                                var img = document.createElement('img');
                                img.src = entry[colDef.field];
                                cell.appendChild(img);
                                img.style.maxWidth = cell.width;
                                img.style.maxHeigth = cell.heigth;
                                break;
                            case 'text':
                            default:
                                cell.className = '';
                                cell.innerHTML = entry[colDef.field];
                            }
                        }

                        var selectCell = row.insertCell(-1);
                        selectCell.addClassName('selectCell');
                        var button = document.createElement('input');
                        button.addClassName('button');
                        button.type = 'button';
                        button.value = 'Select';
                        selectCell.appendChild(button);

                        var context = {'form': this, 'item': this._items.length};
                        button.observe('click', function() { this.form.productDetail(this.item);}.bind(context));

                        this._items.push({'entry': entry, 'row': row});
                    }

                    /* Update Interface
                    if (listFact.currentPage &lt; listFact.totalPages - 1) {
                        $("nextButton").setStyle({visibility: "visible"});
                    } else {
                        $("nextButton").setStyle({visibility: "hidden"});
                    }
                    if (listFact.currentPage &gt; 1) {
                        $("previousButton").setStyle({visibility: "visible"});
                    } else {
                        $("previousButton").setStyle({visibility: "hidden"});
                    }

                    if (listFact.totalPages &gt; 0) {
                        $("curPage").innerHTML = listFact.currentPage;
                        $("totalPages").update(listFact.totalPages);
                    } else {
                        $("curPage").innerHTML = "-";
                        $("totalPages").update("-");
                    }*/

                    this._lastFact = listFact;
                }/*,

                nextPage: function () {
                    this._tableBody.update("");
                    this.showProgress();

                    var listFact = this._lastFact;

                    var filter = {
                        id: "filter",
                        data: {
                            productType: listFact.productType,
                            searchText: listFact.searchText,
                            currentPage: parseInt(listFact.currentPage) + 1
                        }
                    };
                    this.manageData(["newFilter"], [filter], []);
                },

                previousPage: function () {
                    this._tableBody.update("");
                    this.showProgress();

                    var listFact = this._lastFact;

                    var filter = {
                                     id: "filter",
                                     data: {
                                         productType: listFact.productType,
                                         searchText:  listFact.searchText,
                                         currentPage: parseInt(listFact.currentPage) - 1
                                     }
                                 };
                    this.manageData(["newFilter"], [filter], []);
                }*/
            });
        &lt;/script&gt;
    &lt;/head&gt;

    &lt;body&gt;
        &lt;div id="{{screenId}}_bodyDiv"&gt;
            &lt;div class="logoLayer"&gt;&lt;img id="{{screenId}}_logo" src="http://demo.fast.morfeo-project.org/fast/images/gui/fastLogo.png" /&gt;&lt;/div&gt;
            &lt;h1 id="{{screenId}}_title" class="list_title"&gt;Item list&lt;/h1&gt;
            &lt;div&gt;
                &lt;table&gt;
                    &lt;thead id="{{screenId}}_tableHeader"&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="{{screenId}}_listBody"&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;div class="loadingImg"&gt;
                    &lt;img id="{{screenId}}_loadingImg" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;
                &lt;/div&gt;               
                &lt;div id="{{screenId}}_buttonArea" class="buttonArea"&gt;
                    &lt;input type="button" id="{{screenId}}_previousButton" class="button previousButton" value="&lt;" /&gt;
                    &lt;span id="pages" class="pages"&gt; Page &lt;span id="curPage"&gt;-&lt;/span&gt;/&lt;span id="totalPages"&gt;-&lt;/span&gt;&lt;/span&gt;
                    &lt;input type="button" id="{{screenId}}_nextButton" class="button nextButton" value="&gt;" /&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="277" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">277</field>
        <field type="TextField" name="code">&lt;html&gt;
&lt;head&gt;
&lt;script lang="javascript"&gt;
var {{buildingblockId}} = Class.create(BuildingBlock,{
    _fields: [],

    init: function () {
        var defaultParams = {
            acceptButtonLabel: "Accept",
            fields: [ {name:"input", value:"value"} ]
        };
        var params = Object.extend(defaultParams, this.parameter);
        
        var title = $("{{screenId}}_title");
        title.innerHTML = params['title'] || "";
        
        var tableBody = $("{{screenId}}_tableBody");
        this.buildFields(tableBody, params.fields);
        
        var cancelButton = $("{{screenId}}_cancelButton");
        cancelButton.observe('click', function() {
            for (var i=0, field; field=this._fields[i]; i++){
                field.value = "";
            }
        }.bind(this));
        if (params['cancelButtonLabel']) {
            cancelButton.innerHTML = params['cancelButtonLabel'];
        } else {
            cancelButton.remove();
        }
        
        var acceptButton = $("{{screenId}}_acceptButton");
        acceptButton.innerHTML = params['acceptButtonLabel'];
        acceptButton.observe('click', function() {
            var formData = this.getFieldsValues();
            var item = {id: "item", data: formData};
			this.manageData(["newItem"], [item], []);
        }.bind(this));
    },
    
    getFieldsValues: function() {
        var fieldsValues = {};
        for (var i=0, field; field=this._fields[i]; i++) {
            fieldsValues[field.name] = field.value;
        }
        return fieldsValues;
    },
    
    buildFields: function (table, fields) {
        table.innerHTML = "";
        this._fields = [];
        
        for (var i=0, field; field = fields[i]; i++) {
            var fieldName = field['name'];
            var fieldType = field['type'];
        
            var row = table.insertRow(-1);
                        
            var label = document.createElement('label');
            label.appendChild(document.createTextNode(field['label'] || fieldName));
            
            var input = this.inputFactory.create(fieldName, fieldType, field);
            this._fields.push(input);
            
            if (field['required']) {
                row.addClassName('required');
            }
                      
            var labelCell = row.insertCell(-1);
            labelCell.appendChild(label);
            
            var inputCell = row.insertCell(-1);
            inputCell.appendChild(input);               
        }
    },
    
    inputFactory: {
        create: function(name, type, options) {
            var element;
            if (this[type]) {
                element = this[type](name, options)
            } else {
                element = this['text'](name, options);
            }
            
            return element;
        },
        
        createElement: function(elementName, options) {
            var element = document.createElement(elementName);
            Element.writeAttribute(element, options);
            return element;
        },


        input: function(type, name, options) {
            var element = this.createElement('input', options);
            element.setAttribute('name', name);
            element.setAttribute('type', type);
            return element;
        },

        text: function(name, options) {
            return this.input('text', name, options);
        },
        
        password: function(name, options) {
            return this.input('password', name, options);
        },
        
//       hidden: function(name, options) {
//            return this.input('hidden', name, options);
//        },
        
        checkbox: function(name, options) {
            return this.input('checkbox', name, options);
        },
        
        radio: function(name, options) {
            return this.input('radio', name, options);
        },
        
        textbox: function(name, options) {
            var element = this.createElement('textarea', options);
        	element.setAttribute('name', name);
        	element.innerHTML = options['value'];
        	return element;
        }
    }  
});
&lt;/script&gt;
&lt;style&gt;
.genericForm {
    text-align:center;
}

.genericForm .box {
    background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x scroll 0 0;
    border:1px solid #F8A704;
    margin:5px auto 0;
    padding:.8em;
    text-align:center;

    border-radius:13px;
    -moz-border-radius:13px;
    -webkit-border-radius:13px;
}

.genericForm label {
    color:#979797;
    font-family:Arial,Helvetica,sans-serif;
    font-weight:bold;
    overflow:hidden;
    padding:2px;
    white-space:nowrap
}
.genericForm h1 {
    color:#FEBF43;
    font-family:Arial,Helvetica,sans-serif;
    font-size:24px;
    font-style:italic;
    font-weight:bold;
    margin:5px;
}

.genericForm button {
    background-color:#FFCA5E;
    border:medium none;
    color:white;
    font-weight:bold;
    margin:3px;
    padding:2px 4px;

    cursor:pointer;

    border-radius:5px;
    -moz-border-radius:5px;
    -webkit-border-radius:5px;
}

.genericForm button.cancel:hover {
     background-color:#fc5746;
}

.genericForm button.accept:hover {
    background-color:#69cb55;
}

&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class="genericForm"&gt;
    &lt;h1 id="{{screenId}}_title"&gt;&lt;/h1&gt;
    &lt;div class="box"&gt;
        &lt;table&gt;&lt;tbody id="{{screenId}}_tableBody"&gt;&lt;/tbody&gt;&lt;/table&gt;
        &lt;div style="text-align:right"&gt;
        &lt;button type="button" class="cancel" id="{{screenId}}_cancelButton"&gt;Cancel&lt;/button&gt;
        &lt;button type="button" class="accept" id="{{screenId}}_acceptButton"&gt;Accept&lt;/button&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
&lt;head&gt;
&lt;script lang="javascript"&gt;
var {{buildingblockId}} = Class.create(BuildingBlock,{
    _fields: [],

    init: function () {
        var defaultParams = {
            acceptButtonLabel: "Accept",
            fields: [ {name:"input", value:"value"} ]
        };
        var params = Object.extend(defaultParams, this.parameter);
        
        var title = $("{{screenId}}_title");
        title.innerHTML = params['title'] || "";
        
        var tableBody = $("{{screenId}}_tableBody");
        this.buildFields(tableBody, params.fields);
        
        var cancelButton = $("{{screenId}}_cancelButton");
        cancelButton.observe('click', function() {
            for (var i=0, field; field=this._fields[i]; i++){
                field.value = "";
            }
        }.bind(this));
        if (params['cancelButtonLabel']) {
            cancelButton.innerHTML = params['cancelButtonLabel'];
        } else {
            cancelButton.remove();
        }
        
        var acceptButton = $("{{screenId}}_acceptButton");
        acceptButton.innerHTML = params['acceptButtonLabel'];
        acceptButton.observe('click', function() {
            var formData = this.getFieldsValues();
            var item = {id: "item", data: formData};
			this.manageData(["newItem"], [item], []);
        }.bind(this));
    },
    
    getFieldsValues: function() {
        var fieldsValues = {};
        for (var i=0, field; field=this._fields[i]; i++) {
            fieldsValues[field.name] = field.value;
        }
        return fieldsValues;
    },
    
    buildFields: function (table, fields) {
        table.innerHTML = "";
        this._fields = [];
        
        for (var i=0, field; field = fields[i]; i++) {
            var fieldName = field['name'];
            var fieldType = field['type'];
        
            var row = table.insertRow(-1);
                        
            var label = document.createElement('label');
            label.appendChild(document.createTextNode(field['label'] || fieldName));
            
            var input = this.inputFactory.create(fieldName, fieldType, field);
            this._fields.push(input);
            
            if (field['required']) {
                row.addClassName('required');
            }
                      
            var labelCell = row.insertCell(-1);
            labelCell.appendChild(label);
            
            var inputCell = row.insertCell(-1);
            inputCell.appendChild(input);               
        }
    },
    
    inputFactory: {
        create: function(name, type, options) {
            var element;
            if (this[type]) {
                element = this[type](name, options)
            } else {
                element = this['text'](name, options);
            }
            
            return element;
        },
        
        createElement: function(elementName, options) {
            var element = document.createElement(elementName);
            Element.writeAttribute(element, options);
            return element;
        },


        input: function(type, name, options) {
            var element = this.createElement('input', options);
            element.setAttribute('name', name);
            element.setAttribute('type', type);
            return element;
        },

        text: function(name, options) {
            return this.input('text', name, options);
        },
        
        password: function(name, options) {
            return this.input('password', name, options);
        },
        
//       hidden: function(name, options) {
//            return this.input('hidden', name, options);
//        },
        
        checkbox: function(name, options) {
            return this.input('checkbox', name, options);
        },
        
        radio: function(name, options) {
            return this.input('radio', name, options);
        },
        
        textbox: function(name, options) {
            var element = this.createElement('textarea', options);
        	element.setAttribute('name', name);
        	element.innerHTML = options['value'];
        	return element;
        }
    }  
});
&lt;/script&gt;
&lt;style&gt;
.genericForm {
    text-align:center;
}

.genericForm .box {
    background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x scroll 0 0;
    border:1px solid #F8A704;
    margin:5px auto 0;
    padding:.8em;
    text-align:center;

    border-radius:13px;
    -moz-border-radius:13px;
    -webkit-border-radius:13px;
}

.genericForm label {
    color:#979797;
    font-family:Arial,Helvetica,sans-serif;
    font-weight:bold;
    overflow:hidden;
    padding:2px;
    white-space:nowrap
}
.genericForm h1 {
    color:#FEBF43;
    font-family:Arial,Helvetica,sans-serif;
    font-size:24px;
    font-style:italic;
    font-weight:bold;
    margin:5px;
}

.genericForm button {
    background-color:#FFCA5E;
    border:medium none;
    color:white;
    font-weight:bold;
    margin:3px;
    padding:2px 4px;

    cursor:pointer;

    border-radius:5px;
    -moz-border-radius:5px;
    -webkit-border-radius:5px;
}

.genericForm button.cancel:hover {
     background-color:#fc5746;
}

.genericForm button.accept:hover {
    background-color:#69cb55;
}

&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class="genericForm"&gt;
    &lt;h1 id="{{screenId}}_title"&gt;&lt;/h1&gt;
    &lt;div class="box"&gt;
        &lt;table&gt;&lt;tbody id="{{screenId}}_tableBody"&gt;&lt;/tbody&gt;&lt;/table&gt;
        &lt;div style="text-align:right"&gt;
        &lt;button type="button" class="cancel" id="{{screenId}}_cancelButton"&gt;Cancel&lt;/button&gt;
        &lt;button type="button" class="accept" id="{{screenId}}_acceptButton"&gt;Accept&lt;/button&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="278" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">278</field>
        <field type="TextField" name="code">&lt;html&gt;
	&lt;head&gt;
		&lt;meta http-equiv="Content-Type"
		    content="application/xhtml+xml; charset=UTF-8" /&gt;
		&lt;link type="text/css" rel="stylesheet"
		    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
		&lt;link type="text/css" rel="stylesheet"
		    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pages {
			    color: #FEBF43;
			    font-weight: bold;
			    padding: 10px;
			}
			
			#previousButton,#nextButton {
			    visibility: hidden;
			}
			
			#loadingImg {
			    margin: auto;
			    padding-top: 10px;
			}
			
			#amazonImage {
			    position: absolute;
			    right: 0px;
			    top: 3px;
			}
		&lt;/style&gt;
		
		&lt;script language="JavaScript"&gt;

			var {{buildingblockId}} = Class.create(BuildingBlock,{

				init: function (){
					$("nextButton").onclick = this.nextPage.bind(this);
			        $("previousButton").onclick = this.previousPage.bind(this);
			        $$('input[type="button"]').each(function(element){
			            element.onmouseover = function(event){
				            var e = Event.element(event);
			                e.setStyle({cursor:"pointer"});
			            };		
			        });
			
			        var tableBody = $("listBody");
			        tableBody.update("");
			        this.showProgress();
			    },
	
				productDetail: function (nodeElement,_ASIN){
					this.clearSelected ();
			        //select the element
			        nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
			        var item = {id: 'item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
			        this.manageData(null, [item], []);
			    },
			    
			    clearSelected: function (){
			        $$("tbody tr").each(function (element){
			            element.setStyle({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
			        });
			    },
	
			    showProgress: function (){
			        $("loadingImg").show();
			    },
			    
			    showTable: function (l){
			    	$("loadingImg").hide();
			    	var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
			        templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(this,\'#{ASIN}\');"';
			        templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
			        var rowTemplate = new Template(templateString);
			        var tableBody = $("listBody");
			        tableBody.update("");
			        for (var i = 0; i &lt; l.data.productList.length; i++) { //print the appropriate elements
			            if (l.data.productList[i]) { //only if the product table is fetched
			                tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
			            }
			        }
			        //Update Interface
			        if (l.data.currentPage &lt; l.data.totalPages - 1) {
			            $("nextButton").setStyle({visibility: "visible"});
			        } else {
			            $("nextButton").setStyle({visibility: "hidden"});
			        }
			        if (l.data.currentPage &gt; 1) {
			            $("previousButton").setStyle({visibility: "visible"});
			        } else {
			            $("previousButton").setStyle({visibility: "hidden"});
			        }
	
			        $("CP").value = l.data.currentPage;
			        $("TP").value = l.data.totalPages;
			        $("ST").value = l.data.searchText;
			        $("PT").value = l.data.productType;
			        if(l.data.totalPages&gt;0){
				        $("curPage").innerHTML = l.data.currentPage;
				        $("totalPages").update(l.data.totalPages);
			        } else {
			        	$("curPage").innerHTML = "-";
				        $("totalPages").update("-");
				    }
			    },
			    
			    nextPage: function (){
			    	var tableBody = $("listBody");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: "filter", data: {productType: $F("PT"), searchText: $F("ST"), currentPage:(parseInt($F("CP"))+1) }};
			        this.manageData(["newFilter"], [filter], []);
			    },
			    
			    previousPage: function (){
			    	var tableBody = $("listBody");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: "filter", data: {productType: $F("PT"), searchText: $F("ST"), currentPage:(parseInt($F("CP"))-1) }};
			        this.manageData(["newFilter"], [filter], []);
			    },
	
			    showMessage: function (message){
			    	$("loadingImg").hide();
					alert(message.data.message);
				}
			});
		&lt;/script&gt;
	&lt;/head&gt;
	
	&lt;body&gt;
		&lt;div id="bodyDiv"&gt;
			&lt;input type="hidden" id="CP" /&gt;
			&lt;input type="hidden" id="TP" /&gt;
			&lt;input type="hidden" id="ST" /&gt;
			&lt;input type="hidden" id="PT" /&gt;
		    &lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
			&lt;h1 id="title"&gt;Item list&lt;/h1&gt;
			&lt;div id="listDiv"&gt;
				&lt;table&gt;
				    &lt;thead&gt;
				        &lt;tr&gt;
				            &lt;th style="width: 60%; -moz-border-radius: 13px 0px 0px 0px;"&gt;Title&lt;/th&gt;
				            &lt;th style="width: 10%"&gt;Price&lt;/th&gt;
				            &lt;th style="width: 20%"&gt;Product Group&lt;/th&gt;
				            &lt;th style="width: 10%; -moz-border-radius: 0px 13px 0px 0px;"&gt;&amp;nbsp;&lt;/th&gt;
				        &lt;/tr&gt;
				    &lt;/thead&gt;
				    &lt;tbody id="listBody"&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				    &lt;/tbody&gt;
				&lt;/table&gt;
				&lt;img id="loadingImg" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;
				&lt;div id="buttonContainerDiv"&gt;
				    &lt;input type="button" id="previousButton" class="button" value="&lt;" /&gt;
				    &lt;span id="pages"&gt; Page &lt;span id="curPage"&gt;-&lt;/span&gt;/&lt;span id="totalPages"&gt;-&lt;/span&gt;&lt;/span&gt;
				    &lt;input type="button" id="nextButton" class="button" value="&gt;" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/body&gt;
&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
	&lt;head&gt;
		&lt;meta http-equiv="Content-Type"
		    content="application/xhtml+xml; charset=UTF-8" /&gt;
		&lt;link type="text/css" rel="stylesheet"
		    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
		&lt;link type="text/css" rel="stylesheet"
		    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pages {
			    color: #FEBF43;
			    font-weight: bold;
			    padding: 10px;
			}
			
			#previousButton,#nextButton {
			    visibility: hidden;
			}
			
			#loadingImg {
			    margin: auto;
			    padding-top: 10px;
			}
			
			#amazonImage {
			    position: absolute;
			    right: 0px;
			    top: 3px;
			}
		&lt;/style&gt;
		
		&lt;script language="JavaScript"&gt;

			var {{buildingblockId}} = Class.create(BuildingBlock,{

				init: function (){
					$("nextButton").onclick = this.nextPage.bind(this);
			        $("previousButton").onclick = this.previousPage.bind(this);
			        $$('input[type="button"]').each(function(element){
			            element.onmouseover = function(event){
				            var e = Event.element(event);
			                e.setStyle({cursor:"pointer"});
			            };		
			        });
			
			        var tableBody = $("listBody");
			        tableBody.update("");
			        this.showProgress();
			    },
	
				productDetail: function (nodeElement,_ASIN){
					this.clearSelected ();
			        //select the element
			        nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
			        var item = {id: 'item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
			        this.manageData(null, [item], []);
			    },
			    
			    clearSelected: function (){
			        $$("tbody tr").each(function (element){
			            element.setStyle({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
			        });
			    },
	
			    showProgress: function (){
			        $("loadingImg").show();
			    },
			    
			    showTable: function (l){
			    	$("loadingImg").hide();
			    	var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
			        templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(this,\'#{ASIN}\');"';
			        templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
			        var rowTemplate = new Template(templateString);
			        var tableBody = $("listBody");
			        tableBody.update("");
			        for (var i = 0; i &lt; l.data.productList.length; i++) { //print the appropriate elements
			            if (l.data.productList[i]) { //only if the product table is fetched
			                tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
			            }
			        }
			        //Update Interface
			        if (l.data.currentPage &lt; l.data.totalPages - 1) {
			            $("nextButton").setStyle({visibility: "visible"});
			        } else {
			            $("nextButton").setStyle({visibility: "hidden"});
			        }
			        if (l.data.currentPage &gt; 1) {
			            $("previousButton").setStyle({visibility: "visible"});
			        } else {
			            $("previousButton").setStyle({visibility: "hidden"});
			        }
	
			        $("CP").value = l.data.currentPage;
			        $("TP").value = l.data.totalPages;
			        $("ST").value = l.data.searchText;
			        $("PT").value = l.data.productType;
			        if(l.data.totalPages&gt;0){
				        $("curPage").innerHTML = l.data.currentPage;
				        $("totalPages").update(l.data.totalPages);
			        } else {
			        	$("curPage").innerHTML = "-";
				        $("totalPages").update("-");
				    }
			    },
			    
			    nextPage: function (){
			    	var tableBody = $("listBody");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: "filter", data: {productType: $F("PT"), searchText: $F("ST"), currentPage:(parseInt($F("CP"))+1) }};
			        this.manageData(["newFilter"], [filter], []);
			    },
			    
			    previousPage: function (){
			    	var tableBody = $("listBody");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: "filter", data: {productType: $F("PT"), searchText: $F("ST"), currentPage:(parseInt($F("CP"))-1) }};
			        this.manageData(["newFilter"], [filter], []);
			    },
	
			    showMessage: function (message){
			    	$("loadingImg").hide();
					alert(message.data.message);
				}
			});
		&lt;/script&gt;
	&lt;/head&gt;
	
	&lt;body&gt;
		&lt;div id="bodyDiv"&gt;
			&lt;input type="hidden" id="CP" /&gt;
			&lt;input type="hidden" id="TP" /&gt;
			&lt;input type="hidden" id="ST" /&gt;
			&lt;input type="hidden" id="PT" /&gt;
		    &lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
			&lt;h1 id="title"&gt;Item list&lt;/h1&gt;
			&lt;div id="listDiv"&gt;
				&lt;table&gt;
				    &lt;thead&gt;
				        &lt;tr&gt;
				            &lt;th style="width: 60%; -moz-border-radius: 13px 0px 0px 0px;"&gt;Title&lt;/th&gt;
				            &lt;th style="width: 10%"&gt;Price&lt;/th&gt;
				            &lt;th style="width: 20%"&gt;Product Group&lt;/th&gt;
				            &lt;th style="width: 10%; -moz-border-radius: 0px 13px 0px 0px;"&gt;&amp;nbsp;&lt;/th&gt;
				        &lt;/tr&gt;
				    &lt;/thead&gt;
				    &lt;tbody id="listBody"&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				        &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
				    &lt;/tbody&gt;
				&lt;/table&gt;
				&lt;img id="loadingImg" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;
				&lt;div id="buttonContainerDiv"&gt;
				    &lt;input type="button" id="previousButton" class="button" value="&lt;" /&gt;
				    &lt;span id="pages"&gt; Page &lt;span id="curPage"&gt;-&lt;/span&gt;/&lt;span id="totalPages"&gt;-&lt;/span&gt;&lt;/span&gt;
				    &lt;input type="button" id="nextButton" class="button" value="&gt;" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/body&gt;
&lt;/html&gt;</field>
    </object>
    <object pk="279" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">279</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
		    .detailsForm {
		        max-width:550px;
				text-align:center;
				margin: 8px auto 20px auto;
				height:270px;
		    }
		    .container {
		        -moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
		    }
			.image{
				height: 170px;
				margin:0px auto 13px;
				text-align:center;
				width:88%;
				padding-bottom:5px;
				padding-top:10px;
			}
            .image img {
                max-width: 99%;
                max-height: 99%;
            }
			.leftColumn{
				position: relative;
				float:left;
				width: 35%;
			}
			.rightColumn{
				position: relative;
				float:right;
				height: 268px;
				width: 60%;

				padding-top:5px;
				padding-right:0px;
				padding-left:5px;
				padding-bottom: 5px;
				position:relative;
			}
			.loadingImg {
			    position: relative;
			    top: 118px;
			    
			}
			.itemTitle {
			    font-size: 20px;
			    padding: 2px;
			    color:#F8A704;
			    font-weight: bold;
			    font-style: italic;
			    font-family: Arial, Helvetica, sans-serif;
			    overflow: hidden;
			}
			.infoArea{
				text-align: left;
			}
			.titleInfo{
				float:left;
				margin: 5px;
				width:25%;
				overflow: hidden;
			}
			.valueInfo{
				float:left;
				margin: 5px;
				width: 65%;
			}
			.moreInfo{
				float:left;
				margin-left: 5px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
			.info{
				padding: 2px;
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-weight: bold;
				text-align: justify;
				white-space: nowrap;
				overflow: hidden;
			}
			.moreInfoText {
				color: #888888;
				font-family: Arial, Helvetica, sans-serif;
				font-size: 13px;
				height: 133px;
				margin: 0;
				overflow: auto;
				padding: 2px 15px 2px 2px;
				text-align: left;
				width: 300px;
				max-width: 300px;
				border-top:1px dotted #AAAAAA;
			}
			.detailsElement {
				color:#888888;
				font-weight:bold;
			}
			
			.elements {
			    color: #FEBF43;
			    font-weight: bold;
			    padding: 10px;
			}
			.buttonArea {
                float:left;
                margin:15px 10px;
                padding:18px 3px;
                width:30%;
			}
			.button {
			    cursor: hand;
			    cursor: pointer;
			    color: white;
			    font-weight: bold;
			}
			.disabled {
			    opacity: 0.4;
			    filter: alpha(opacity=40);
			    cursor: default;
			}

		&lt;/style&gt;
       &lt;script language="JavaScript"&gt;
        	var {{buildingblockId}} = Class.create(BuildingBlock,{
					init: function (){
					    
					    // Integer representing the current position of the list
					    this._currentPage = -1;
					    
					    this._list = null;				
					
					    var details = new Element('div', {
						    'class': 'detailsForm'
						});
					    var body = $('{{screenId}}_body');
						body.innerHTML = '';
						body.appendChild(details);
						
						// Left Column (Image)
						var leftColumn = new Element('div', {
						    'class': 'leftColumn'
						});
						this._image = new Element('div', {
						    'class': 'image container'
						});
						leftColumn.appendChild(this._image);
						details.appendChild(leftColumn);
						
						// Right Column (Details)
						var rightColumn = new Element('div', {
						    'class': 'rightColumn container'
						});					
						details.appendChild(rightColumn);

						this._loadingImg = new Element('img', {
						    'src': "http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif",
						    'class': 'loadingImg'
						});

						rightColumn.appendChild(this._loadingImg);
						
						this._title = new Element('div', {
						    'class': 'itemTitle'
						});
						rightColumn.appendChild(this._title);
						var infoArea = new Element('div', {
					        'class': 'infoArea'
						});
                        rightColumn.appendChild(infoArea);
                        
                        this._titleInfo = new Element('div', {
                            'class': 'titleInfo'
                        });
                        infoArea.appendChild(this._titleInfo);
                        this._valueInfo = new Element('div', {
                            'class': 'valueInfo'
                        });
                        infoArea.appendChild(this._valueInfo);
                        var moreInfo = new Element('div', {
                            'class': 'moreInfo'
                        });
                        this._moreInfoTitle = new Element('div', {
                            'class': 'title'
                        });
                        this._moreInfoText = new Element('div');
                        moreInfo.appendChild(this._moreInfoTitle);
                        moreInfo.appendChild(this._moreInfoText);
                        infoArea.appendChild(moreInfo);
                        
                        
                        // Previous, next button
                        var buttonArea = new Element('div', {
                            'class': 'buttonArea container'
                        });
                        
                        this._previousButton = new Element('input', {
                            'class': 'button',
                            'value': '&lt;',
                            'type': 'button'
                        }).update("&lt;");
                        buttonArea.appendChild(this._previousButton);
                        
                        this._previousButton.observe('click', this._showPreviousPage.bind(this));
                        
                        var elements = new Element('span', {
                            'class': 'elements'
                        });
                        this._currentElement = new Element('span').update('-');
                        elements.appendChild(this._currentElement);
                        elements.appendChild(document.createTextNode('/'));
                        this._totalElements = new Element('span').update('-');
                        elements.appendChild(this._totalElements);
                        buttonArea.appendChild(elements);
                        
                        this._nextButton = new Element('input', {
                            'class': 'button',
                            'value': '&gt;',
                            'type': 'button'
                        }).update("&gt;");
                        buttonArea.appendChild(this._nextButton);
                        
                        this._nextButton.observe('click', this._showNextPage.bind(this));
                        
                        details.appendChild(buttonArea);
					},

					showListElements: function (_list) {
					    if (_list.data) {
					        this._list = _list.data;
					        this._totalElements.update(this._list.size()); 
					    }
					    this._showNextPage();
					},
					
					showMessage: function (message){
						// TODO
					},
					
					_showNextPage: function() {	    
					    if (this._list[this._currentPage+1]) {
					        this._currentPage++;
					        this._currentElement.update(this._currentPage + 1);
					        this._showProductInfo(this._list[this._currentPage]);
					        this._updateButtons();
				        }	    
					},
					
					_showPreviousPage: function() {	    
					    if (this._list[this._currentPage-1]) {
					        this._currentPage--;
					        this._currentElement.update(this._currentPage + 1);
					        this._showProductInfo(this._list[this._currentPage]);
					        this._updateButtons();
				        }		    
					},
					
					_updateButtons: function() {
					    if(this._list[this._currentPage+1]) {
					        this._nextButton.disabled = false;
					        this._nextButton.removeClassName('disabled');
			            } else {
			                this._nextButton.disabled = true;
			                this._nextButton.addClassName('disabled');
			            }
			            if(this._list[this._currentPage-1]) {
			                this._previousButton.disabled = false;
			                this._previousButton.removeClassName('disabled');
				        } else {
			                this._previousButton.disabled = true;
			                this._previousButton.addClassName('disabled');
				        }
					},

					_showProductInfo: function (_product) {
					    this._loadingImg.hide();
						if (_product.title) {
							//Reset styles
							this._reset();
							this._title.update(_product.title);
							if (this._title.clientHeight &gt; 28) {//Big title
								//Big title, adapt styles
								this._title.setStyle ({"fontSize":"16px"});
								if (this._title.clientHeight &gt; 23) {//More than one line
									if (this._title.clientHeight &gt; 46) {//More than two lines
										if (this._title.clientHeight &gt; 69) {//More than three lines
											this._title.setStyle ({"fontSize":"13px"});
											if (this._title.clientHeight &gt; 49) {//Still more than three lines
												this._moreInfoText.setStyle({"height": "90px"});
											} else {
												this._moreInfoText.setStyle({"height": "110px"});
											}
										} else {//Three lines
											this._moreInfoText.setStyle({"height": "110px"});
											this._title.setStyle ({"fontSize":"14px"});	
										}
									} else {//Two lines
										this._moreInfoText.setStyle({"height": "115px"});
									}	
								}
							}
							
						}
						
						this._insertElement("Website", _product.url);
						if (_product.image) {
							var img = new Element ('img',{src: _product.image});
							this._image.update(img);
						}
						if (_product.price) {
						    this._insertElement("Price", _product.price);
						}
						if (this.parameter &amp;&amp; this.parameter.elements) {
						    this.parameter.elements.each(function(element) {
						        this._insertElement(this._capitalize(element), _product.details[element]);
						    }.bind(this));
						}
						this._showAdvancedDetails(_product);
					},
					
					_showAdvancedDetails: function(_product) {
					    
				        var details = $H(_product.details);
				        if (details &amp;&amp; details.keys().size() &gt; 0) {
				            this._moreInfoText.addClassName("moreInfoText");
				            if (this.parameter &amp;&amp; this.parameter.itemTitle) {
				                this._moreInfoTitle.update(this.parameter.itemTitle + " Details");
				            } else {
				                this._moreInfoTitle.update("Details");
				            }
                
                            var list = new Element('ul');
				            details.each(function(pair){
				                var appendElement = true;
				                if (this.parameter &amp;&amp; this.parameter.elements) {
				                    if (this.parameter.elements.lastIndexOf(pair.key) != -1) {
				                        appendElement = false;
				                    }
				                }
				                if (appendElement) {
				                    var node = this._createDetailNode(pair.key, pair.value);
				                    if (node) {
				                       list.appendChild(node);
				                    }
				                }
				            }.bind(this));
				            this._moreInfoText.appendChild(list);
				        }
					},

					_createDetailNode: function(key, value) {
					    var title = this._capitalize(key);
					    var li = new Element('li').update(title + ": ");
                        if (typeof value == "string") {
					        li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(this._sanitize(value)));
					        return li;
                        } else if (value instanceof Array) {
                            var finalValue = value.join(", ");
                            li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(finalValue));
					        return li; 
                        } else {
                            return null;
                        }
					},
					
					_insertElement: function(title, value) {
					    if(value) {
				            this._titleInfo.appendChild(new Element('div', {
						        'class': 'title'
						    }).update(title + ': '));
							this._valueInfo.appendChild(new Element('div', {
							    'class': 'info'
							}).update(this._sanitize(value)));
						}
					},
					
					_reset: function() {
				        this._title.setStyle({"fontSize":"20px"});
				        
				        this._titleInfo.update("");
				        this._valueInfo.update("");
				        
				        this._moreInfoTitle.update("");
					    this._moreInfoText.setStyle({"height": "133px"});
					    this._moreInfoText.removeClassName("moreInfoText");
					    this._moreInfoText.update("");
					},
					
					_sanitize: function(value) {
					    var validChars = "[\\w\\!\\#\\$\\%\\&amp;\\\'\\*\\+\\-\\/\\=\\?\\^\\`\\{\\|\\}\\~]+";
                        var mail = new RegExp("("+validChars+"(?:\\."+validChars+")*@"+validChars+"(?:\\."+validChars+")+)", "g");
                        var url = new RegExp("(\\w+\\:\\/\\/\\w+(?:\\.\\w+)*(?:\\:\\d+)?(?:\\/\\w+)*(?:[\\w\\.\\?\\=\\/\\#\\%\\&amp;\\+\\-]*))", "g");
					    var finalValue = value.replace(mail, '&lt;a href="mailto:$1"&gt;$1&lt;/a&gt;');
                        finalValue = finalValue.replace(url, '&lt;a href="$1" target="_blank"&gt;$1&lt;/a&gt;');
                        return finalValue;
					},
					
					_capitalize: function(text) {
					    return text.split(" ").collect(function(e){return e.capitalize()}).join(" ");
					}
            });
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="{{screenId}}_body"&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
		    .detailsForm {
		        max-width:550px;
				text-align:center;
				margin: 8px auto 20px auto;
				height:270px;
		    }
		    .container {
		        -moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
		    }
			.image{
				height: 170px;
				margin:0px auto 13px;
				text-align:center;
				width:88%;
				padding-bottom:5px;
				padding-top:10px;
			}
            .image img {
                max-width: 99%;
                max-height: 99%;
            }
			.leftColumn{
				position: relative;
				float:left;
				width: 35%;
			}
			.rightColumn{
				position: relative;
				float:right;
				height: 268px;
				width: 60%;

				padding-top:5px;
				padding-right:0px;
				padding-left:5px;
				padding-bottom: 5px;
				position:relative;
			}
			.loadingImg {
			    position: relative;
			    top: 118px;
			    
			}
			.itemTitle {
			    font-size: 20px;
			    padding: 2px;
			    color:#F8A704;
			    font-weight: bold;
			    font-style: italic;
			    font-family: Arial, Helvetica, sans-serif;
			    overflow: hidden;
			}
			.infoArea{
				text-align: left;
			}
			.titleInfo{
				float:left;
				margin: 5px;
				width:25%;
				overflow: hidden;
			}
			.valueInfo{
				float:left;
				margin: 5px;
				width: 65%;
			}
			.moreInfo{
				float:left;
				margin-left: 5px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
			.info{
				padding: 2px;
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-weight: bold;
				text-align: justify;
				white-space: nowrap;
				overflow: hidden;
			}
			.moreInfoText {
				color: #888888;
				font-family: Arial, Helvetica, sans-serif;
				font-size: 13px;
				height: 133px;
				margin: 0;
				overflow: auto;
				padding: 2px 15px 2px 2px;
				text-align: left;
				width: 300px;
				max-width: 300px;
				border-top:1px dotted #AAAAAA;
			}
			.detailsElement {
				color:#888888;
				font-weight:bold;
			}
			
			.elements {
			    color: #FEBF43;
			    font-weight: bold;
			    padding: 10px;
			}
			.buttonArea {
                float:left;
                margin:15px 10px;
                padding:18px 3px;
                width:30%;
			}
			.button {
			    cursor: hand;
			    cursor: pointer;
			    color: white;
			    font-weight: bold;
			}
			.disabled {
			    opacity: 0.4;
			    filter: alpha(opacity=40);
			    cursor: default;
			}

		&lt;/style&gt;
       &lt;script language="JavaScript"&gt;
        	var {{buildingblockId}} = Class.create(BuildingBlock,{
					init: function (){
					    
					    // Integer representing the current position of the list
					    this._currentPage = -1;
					    
					    this._list = null;				
					
					    var details = new Element('div', {
						    'class': 'detailsForm'
						});
					    var body = $('{{screenId}}_body');
						body.innerHTML = '';
						body.appendChild(details);
						
						// Left Column (Image)
						var leftColumn = new Element('div', {
						    'class': 'leftColumn'
						});
						this._image = new Element('div', {
						    'class': 'image container'
						});
						leftColumn.appendChild(this._image);
						details.appendChild(leftColumn);
						
						// Right Column (Details)
						var rightColumn = new Element('div', {
						    'class': 'rightColumn container'
						});					
						details.appendChild(rightColumn);

						this._loadingImg = new Element('img', {
						    'src': "http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif",
						    'class': 'loadingImg'
						});

						rightColumn.appendChild(this._loadingImg);
						
						this._title = new Element('div', {
						    'class': 'itemTitle'
						});
						rightColumn.appendChild(this._title);
						var infoArea = new Element('div', {
					        'class': 'infoArea'
						});
                        rightColumn.appendChild(infoArea);
                        
                        this._titleInfo = new Element('div', {
                            'class': 'titleInfo'
                        });
                        infoArea.appendChild(this._titleInfo);
                        this._valueInfo = new Element('div', {
                            'class': 'valueInfo'
                        });
                        infoArea.appendChild(this._valueInfo);
                        var moreInfo = new Element('div', {
                            'class': 'moreInfo'
                        });
                        this._moreInfoTitle = new Element('div', {
                            'class': 'title'
                        });
                        this._moreInfoText = new Element('div');
                        moreInfo.appendChild(this._moreInfoTitle);
                        moreInfo.appendChild(this._moreInfoText);
                        infoArea.appendChild(moreInfo);
                        
                        
                        // Previous, next button
                        var buttonArea = new Element('div', {
                            'class': 'buttonArea container'
                        });
                        
                        this._previousButton = new Element('input', {
                            'class': 'button',
                            'value': '&lt;',
                            'type': 'button'
                        }).update("&lt;");
                        buttonArea.appendChild(this._previousButton);
                        
                        this._previousButton.observe('click', this._showPreviousPage.bind(this));
                        
                        var elements = new Element('span', {
                            'class': 'elements'
                        });
                        this._currentElement = new Element('span').update('-');
                        elements.appendChild(this._currentElement);
                        elements.appendChild(document.createTextNode('/'));
                        this._totalElements = new Element('span').update('-');
                        elements.appendChild(this._totalElements);
                        buttonArea.appendChild(elements);
                        
                        this._nextButton = new Element('input', {
                            'class': 'button',
                            'value': '&gt;',
                            'type': 'button'
                        }).update("&gt;");
                        buttonArea.appendChild(this._nextButton);
                        
                        this._nextButton.observe('click', this._showNextPage.bind(this));
                        
                        details.appendChild(buttonArea);
					},

					showListElements: function (_list) {
					    if (_list.data) {
					        this._list = _list.data;
					        this._totalElements.update(this._list.size()); 
					    }
					    this._showNextPage();
					},
					
					showMessage: function (message){
						// TODO
					},
					
					_showNextPage: function() {	    
					    if (this._list[this._currentPage+1]) {
					        this._currentPage++;
					        this._currentElement.update(this._currentPage + 1);
					        this._showProductInfo(this._list[this._currentPage]);
					        this._updateButtons();
				        }	    
					},
					
					_showPreviousPage: function() {	    
					    if (this._list[this._currentPage-1]) {
					        this._currentPage--;
					        this._currentElement.update(this._currentPage + 1);
					        this._showProductInfo(this._list[this._currentPage]);
					        this._updateButtons();
				        }		    
					},
					
					_updateButtons: function() {
					    if(this._list[this._currentPage+1]) {
					        this._nextButton.disabled = false;
					        this._nextButton.removeClassName('disabled');
			            } else {
			                this._nextButton.disabled = true;
			                this._nextButton.addClassName('disabled');
			            }
			            if(this._list[this._currentPage-1]) {
			                this._previousButton.disabled = false;
			                this._previousButton.removeClassName('disabled');
				        } else {
			                this._previousButton.disabled = true;
			                this._previousButton.addClassName('disabled');
				        }
					},

					_showProductInfo: function (_product) {
					    this._loadingImg.hide();
						if (_product.title) {
							//Reset styles
							this._reset();
							this._title.update(_product.title);
							if (this._title.clientHeight &gt; 28) {//Big title
								//Big title, adapt styles
								this._title.setStyle ({"fontSize":"16px"});
								if (this._title.clientHeight &gt; 23) {//More than one line
									if (this._title.clientHeight &gt; 46) {//More than two lines
										if (this._title.clientHeight &gt; 69) {//More than three lines
											this._title.setStyle ({"fontSize":"13px"});
											if (this._title.clientHeight &gt; 49) {//Still more than three lines
												this._moreInfoText.setStyle({"height": "90px"});
											} else {
												this._moreInfoText.setStyle({"height": "110px"});
											}
										} else {//Three lines
											this._moreInfoText.setStyle({"height": "110px"});
											this._title.setStyle ({"fontSize":"14px"});	
										}
									} else {//Two lines
										this._moreInfoText.setStyle({"height": "115px"});
									}	
								}
							}
							
						}
						
						this._insertElement("Website", _product.url);
						if (_product.image) {
							var img = new Element ('img',{src: _product.image});
							this._image.update(img);
						}
						if (_product.price) {
						    this._insertElement("Price", _product.price);
						}
						if (this.parameter &amp;&amp; this.parameter.elements) {
						    this.parameter.elements.each(function(element) {
						        this._insertElement(this._capitalize(element), _product.details[element]);
						    }.bind(this));
						}
						this._showAdvancedDetails(_product);
					},
					
					_showAdvancedDetails: function(_product) {
					    
				        var details = $H(_product.details);
				        if (details &amp;&amp; details.keys().size() &gt; 0) {
				            this._moreInfoText.addClassName("moreInfoText");
				            if (this.parameter &amp;&amp; this.parameter.itemTitle) {
				                this._moreInfoTitle.update(this.parameter.itemTitle + " Details");
				            } else {
				                this._moreInfoTitle.update("Details");
				            }
                
                            var list = new Element('ul');
				            details.each(function(pair){
				                var appendElement = true;
				                if (this.parameter &amp;&amp; this.parameter.elements) {
				                    if (this.parameter.elements.lastIndexOf(pair.key) != -1) {
				                        appendElement = false;
				                    }
				                }
				                if (appendElement) {
				                    var node = this._createDetailNode(pair.key, pair.value);
				                    if (node) {
				                       list.appendChild(node);
				                    }
				                }
				            }.bind(this));
				            this._moreInfoText.appendChild(list);
				        }
					},

					_createDetailNode: function(key, value) {
					    var title = this._capitalize(key);
					    var li = new Element('li').update(title + ": ");
                        if (typeof value == "string") {
					        li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(this._sanitize(value)));
					        return li;
                        } else if (value instanceof Array) {
                            var finalValue = value.join(", ");
                            li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(finalValue));
					        return li; 
                        } else {
                            return null;
                        }
					},
					
					_insertElement: function(title, value) {
					    if(value) {
				            this._titleInfo.appendChild(new Element('div', {
						        'class': 'title'
						    }).update(title + ': '));
							this._valueInfo.appendChild(new Element('div', {
							    'class': 'info'
							}).update(this._sanitize(value)));
						}
					},
					
					_reset: function() {
				        this._title.setStyle({"fontSize":"20px"});
				        
				        this._titleInfo.update("");
				        this._valueInfo.update("");
				        
				        this._moreInfoTitle.update("");
					    this._moreInfoText.setStyle({"height": "133px"});
					    this._moreInfoText.removeClassName("moreInfoText");
					    this._moreInfoText.update("");
					},
					
					_sanitize: function(value) {
					    var validChars = "[\\w\\!\\#\\$\\%\\&amp;\\\'\\*\\+\\-\\/\\=\\?\\^\\`\\{\\|\\}\\~]+";
                        var mail = new RegExp("("+validChars+"(?:\\."+validChars+")*@"+validChars+"(?:\\."+validChars+")+)", "g");
                        var url = new RegExp("(\\w+\\:\\/\\/\\w+(?:\\.\\w+)*(?:\\:\\d+)?(?:\\/\\w+)*(?:[\\w\\.\\?\\=\\/\\#\\%\\&amp;\\+\\-]*))", "g");
					    var finalValue = value.replace(mail, '&lt;a href="mailto:$1"&gt;$1&lt;/a&gt;');
                        finalValue = finalValue.replace(url, '&lt;a href="$1" target="_blank"&gt;$1&lt;/a&gt;');
                        return finalValue;
					},
					
					_capitalize: function(text) {
					    return text.split(" ").collect(function(e){return e.capitalize()}).join(" ");
					}
            });
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="{{screenId}}_body"&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="280" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">280</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#bodyDiv{
				max-width: 550px;
			}
			#searchArea {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:50px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:98%;
			}
			#contents{
				padding:12px;
			}
			#send{
				margin-left: 15px;
			}
			#amazonImage{
				position:absolute;
				right:2px;
				top:3px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
		&lt;/style&gt;
		
        &lt;script language="JavaScript"&gt;
			var {{buildingblockId}} = Class.create(BuildingBlock,{
			    /** @constructs */
			    initialize: function($super, screenId, buildingBlockId, context){
					$super(screenId, buildingBlockId, context);
			    },
			    
			    init: function (){
			    	//List of possible searches
					var searchIndices = ["All","Apparel","Automotive","Baby","Beauty","Blended",
										 "Books","Classical", "DigitalMusic","DVD","Electronics",
										 "GourmetFood","HealthPersonalCare","HomeGarden","Industrial",
										 "Jewelry","KindleStore","Kitchen","Magazines","Merchants",
										 "Miscellaneous","MP3Downloads","Music","MusicalInstruments",
										 "MusicTracks","OfficeProducts","OutdoorLiving","PCHardware",
										 "PetSupplies","Photo","SilverMerchants","Software","SportingGoods",
										 "Tools","Toys","UnboxVideo","VHS","Video","VideoGames","Watches",
										 "Wireless","WirelessAccessories"];

					$("send").onclick = this.send.bind(this);
					$("send").onmouseover = function(event){
							var e = Event.element(event);
							e.setStyle({cursor:"pointer"});
						};

					//Populate the product type select element
					this.populateOptions(searchIndices);
				},
				
				populateOptions: function (_list){
					var templateString = "&lt;option value ='#{element}'&gt;#{caption}&lt;/option&gt;";
					var template = new Template(templateString);
					var optionHTML = "";
					for(var i=0; i &lt; _list.length; i++){
						optionHTML += template.evaluate({"element":_list[i],"caption":_list[i]});
					}
					$("productType").update(optionHTML);
				},

				//This function returns a human readable element, 
				//separating words by white-spaces
				separate: function (element){
					//Workaround for special cases
					//TODO: Create a generic solution, maybe another regexp?
					if (element=="DVD" || element=="VHS" || element=="MP3Downloads" || element=="PCHardware"){
						if (element=="MP3Downloads"){
							return "MP3 Downloads";
						}
						if (element=="PCHardware"){
							return "PC Hardware";
						}
						return element;
					}else{
						var result = element.replace(/([A-Z])/g, " $1");
						//Remove first white-space when necessary
						result = (result[0]==" "?result.substring(1,result.length):result);
						return result;
					}
				},
				
				send: function (){
					if ($F("searchText").length==0){ //Empty keywords are forbidden
						alert ("You must introduce at least one keyword");
						return;
					}
					var filter = {id: "filter", data: {productType: $F("productType"), searchText: $F("searchText")}};
					this.manageData(["newFilter"], [filter],[]);
				}
			    
			});
   		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
        	&lt;h1 id="title"&gt;Product Search&lt;/h1&gt;
			&lt;div id="searchArea"&gt;
				&lt;div id="contents"&gt;
					&lt;span class="title"&gt;Keywords: &lt;/span&gt; &lt;input type="text" id="searchText" /&gt;
					&lt;select id="productType"&gt;			
					&lt;/select&gt;
					&lt;input type="button" id="send" value="Search" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;       
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#bodyDiv{
				max-width: 550px;
			}
			#searchArea {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:50px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:98%;
			}
			#contents{
				padding:12px;
			}
			#send{
				margin-left: 15px;
			}
			#amazonImage{
				position:absolute;
				right:2px;
				top:3px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
		&lt;/style&gt;
		
        &lt;script language="JavaScript"&gt;
			var {{buildingblockId}} = Class.create(BuildingBlock,{
			    /** @constructs */
			    initialize: function($super, screenId, buildingBlockId, context){
					$super(screenId, buildingBlockId, context);
			    },
			    
			    init: function (){
			    	//List of possible searches
					var searchIndices = ["All","Apparel","Automotive","Baby","Beauty","Blended",
										 "Books","Classical", "DigitalMusic","DVD","Electronics",
										 "GourmetFood","HealthPersonalCare","HomeGarden","Industrial",
										 "Jewelry","KindleStore","Kitchen","Magazines","Merchants",
										 "Miscellaneous","MP3Downloads","Music","MusicalInstruments",
										 "MusicTracks","OfficeProducts","OutdoorLiving","PCHardware",
										 "PetSupplies","Photo","SilverMerchants","Software","SportingGoods",
										 "Tools","Toys","UnboxVideo","VHS","Video","VideoGames","Watches",
										 "Wireless","WirelessAccessories"];

					$("send").onclick = this.send.bind(this);
					$("send").onmouseover = function(event){
							var e = Event.element(event);
							e.setStyle({cursor:"pointer"});
						};

					//Populate the product type select element
					this.populateOptions(searchIndices);
				},
				
				populateOptions: function (_list){
					var templateString = "&lt;option value ='#{element}'&gt;#{caption}&lt;/option&gt;";
					var template = new Template(templateString);
					var optionHTML = "";
					for(var i=0; i &lt; _list.length; i++){
						optionHTML += template.evaluate({"element":_list[i],"caption":_list[i]});
					}
					$("productType").update(optionHTML);
				},

				//This function returns a human readable element, 
				//separating words by white-spaces
				separate: function (element){
					//Workaround for special cases
					//TODO: Create a generic solution, maybe another regexp?
					if (element=="DVD" || element=="VHS" || element=="MP3Downloads" || element=="PCHardware"){
						if (element=="MP3Downloads"){
							return "MP3 Downloads";
						}
						if (element=="PCHardware"){
							return "PC Hardware";
						}
						return element;
					}else{
						var result = element.replace(/([A-Z])/g, " $1");
						//Remove first white-space when necessary
						result = (result[0]==" "?result.substring(1,result.length):result);
						return result;
					}
				},
				
				send: function (){
					if ($F("searchText").length==0){ //Empty keywords are forbidden
						alert ("You must introduce at least one keyword");
						return;
					}
					var filter = {id: "filter", data: {productType: $F("productType"), searchText: $F("searchText")}};
					this.manageData(["newFilter"], [filter],[]);
				}
			    
			});
   		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
        	&lt;h1 id="title"&gt;Product Search&lt;/h1&gt;
			&lt;div id="searchArea"&gt;
				&lt;div id="contents"&gt;
					&lt;span class="title"&gt;Keywords: &lt;/span&gt; &lt;input type="text" id="searchText" /&gt;
					&lt;select id="productType"&gt;			
					&lt;/select&gt;
					&lt;input type="button" id="send" value="Search" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;       
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
    </object>
    <object pk="281" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">281</field>
        <field type="TextField" name="code">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesEBayList{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonEBayList, #nextButtonEBayList {
				visibility:hidden;
			}
			#loadingImgEBayList{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#eBayImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        var {{buildingblockId}} = Class.create(BuildingBlock,{
				init: function (){
	            	$("nextButtonEbayList").onclick = this.nextPage.bind(this);
	                $("previousButtonEbayList").onclick = this.previousPage.bind(this);
	                $$('input[type="button"]').each(function(element){
						element.onmouseover = function(event){
							var e = Event.element(event);
							e.setStyle({cursor:"pointer"});
						};
					
					});
					var tableBody = $("listBodyEBayList");
	                tableBody.update("");
	                this.showProgress();
	            },
	
				showProgress: function (){
	                $("loadingImgEBayList").show();
	            },
	            
				showTable: function (l){
	            	if ($("loadingImgEBayList")) {
	                	$("loadingImgEBayList").hide();
	                }
	                var templateString = '&lt;tr&gt;';
	                templateString += '&lt;td&gt;&lt;img src="#{image}"/&gt;&lt;/td&gt;';
	                templateString += '&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{category}&lt;/td&gt;&lt;td&gt;#{currentPrice}&lt;/td&gt;&lt;td&gt;#{shippingServiceCost}&lt;/td&gt;';
	                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(this,\'#{itemID}\',\'#{title}\');"';
					templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
	                var rowTemplate = new Template(templateString);
	                
	                var tableBody = $("listBodyEBayList");
	                for (var i = 0; i &lt; l.data.productList.length; i++) { //print the appropriate elements
	                    if (l.data.productList[i]) { //only if the product table is fetched
	                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
	                    }
	                }
	
	              //Update Interface
			        if (parseInt(l.data.currentPage) &lt; parseInt(l.data.totalPages)) {
			            $("nextButtonEbayList").setStyle({visibility: "visible"});
			        } else {
			            $("nextButtonEbayList").setStyle({visibility: "hidden"});
			        }
			        if (l.data.currentPage &gt; 1) {
			            $("previousButtonEbayList").setStyle({visibility: "visible"});
			        } else {
			            $("previousButtonEbayList").setStyle({visibility: "hidden"});
			        }
	
			        if (l.data.totalPages&gt;0) {
			        	$("curPageEBayList").update(l.data.currentPage);
			        	$("totalPagesEBayList").update(l.data.totalPages);
			        } else {
			        	$("curPageEBayList").update("-");
			        	$("totalPagesEBayList").update("-");
				    }
	
			        $("CPebayList").value = l.data.currentPage;
			        $("MEebayList").value = l.data.maxEntries;
			        $("KebayList").value = l.data.keywords;
	            },
	
				productDetail: function (nodeElement, itemID, title){
					this.clearSelected ();
					//select the element
					nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
					var ebayItem = {id: 'ebayItem', data:{itemID: itemID, title: title}};
					this.manageData(["ebayItem"], [ebayItem], []);
				},
				
				clearSelected: function (){
					$$("tbody tr").each(function (element){
						element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
					});
				},
	
				nextPage: function (){
			    	var tableBody = $("listBodyEBayList");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: 'filterEbay', data:{keywords: $F("KebayList"), maxEntries: $F("MEebayList"), currentPage: parseInt($F("CPebayList")) + 1}};
			        this.manageData(["newFilter"], [filter], []);
			    },
			    
				previousPage: function (){
			    	var tableBody = $("listBodyEBayList");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: 'filterEbay', data:{keywords: $F("KebayList"), maxEntries: $F("MEebayList"), currentPage: parseInt($F("CPebayList")) - 1}};
			        this.manageData(["newFilter"], [filter], []);
			    }
        }); 
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;input type="hidden" id="CPebayList" /&gt;
        	&lt;input type="hidden" id="MEebayList" /&gt;
        	&lt;input type="hidden" id="KebayList" /&gt;
        	&lt;span id="eBayImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/logo-ebay.gif" /&gt;&lt;/span&gt;
		    &lt;h1 id="title"&gt;eBay Item list&lt;/h1&gt;
		    &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                        	&lt;th style="width: 10%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;&amp;nbsp;&lt;/th&gt;
                            &lt;th style="width: 60%;" nowrap="nowrap"&gt;Title&lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;Category&lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;Current Price&lt;/th&gt;
                            &lt;th style="width: 20%;" nowrap="nowrap"&gt;Shipping Cost&lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;&amp;nbsp;&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyEBayList"&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
		    		&lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgEBayList" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonEbayList" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesEBayList"&gt;
					Page &lt;span id="curPageEBayList"&gt;-&lt;/span&gt;/&lt;span id="totalPagesEBayList"&gt;-&lt;/span&gt;
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonEbayList" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
   	&lt;/body&gt;
  	&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesEBayList{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonEBayList, #nextButtonEBayList {
				visibility:hidden;
			}
			#loadingImgEBayList{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#eBayImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        var {{buildingblockId}} = Class.create(BuildingBlock,{
				init: function (){
	            	$("nextButtonEbayList").onclick = this.nextPage.bind(this);
	                $("previousButtonEbayList").onclick = this.previousPage.bind(this);
	                $$('input[type="button"]').each(function(element){
						element.onmouseover = function(event){
							var e = Event.element(event);
							e.setStyle({cursor:"pointer"});
						};
					
					});
					var tableBody = $("listBodyEBayList");
	                tableBody.update("");
	                this.showProgress();
	            },
	
				showProgress: function (){
	                $("loadingImgEBayList").show();
	            },
	            
				showTable: function (l){
	            	if ($("loadingImgEBayList")) {
	                	$("loadingImgEBayList").hide();
	                }
	                var templateString = '&lt;tr&gt;';
	                templateString += '&lt;td&gt;&lt;img src="#{image}"/&gt;&lt;/td&gt;';
	                templateString += '&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{category}&lt;/td&gt;&lt;td&gt;#{currentPrice}&lt;/td&gt;&lt;td&gt;#{shippingServiceCost}&lt;/td&gt;';
	                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(this,\'#{itemID}\',\'#{title}\');"';
					templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
	                var rowTemplate = new Template(templateString);
	                
	                var tableBody = $("listBodyEBayList");
	                for (var i = 0; i &lt; l.data.productList.length; i++) { //print the appropriate elements
	                    if (l.data.productList[i]) { //only if the product table is fetched
	                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
	                    }
	                }
	
	              //Update Interface
			        if (parseInt(l.data.currentPage) &lt; parseInt(l.data.totalPages)) {
			            $("nextButtonEbayList").setStyle({visibility: "visible"});
			        } else {
			            $("nextButtonEbayList").setStyle({visibility: "hidden"});
			        }
			        if (l.data.currentPage &gt; 1) {
			            $("previousButtonEbayList").setStyle({visibility: "visible"});
			        } else {
			            $("previousButtonEbayList").setStyle({visibility: "hidden"});
			        }
	
			        if (l.data.totalPages&gt;0) {
			        	$("curPageEBayList").update(l.data.currentPage);
			        	$("totalPagesEBayList").update(l.data.totalPages);
			        } else {
			        	$("curPageEBayList").update("-");
			        	$("totalPagesEBayList").update("-");
				    }
	
			        $("CPebayList").value = l.data.currentPage;
			        $("MEebayList").value = l.data.maxEntries;
			        $("KebayList").value = l.data.keywords;
	            },
	
				productDetail: function (nodeElement, itemID, title){
					this.clearSelected ();
					//select the element
					nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
					var ebayItem = {id: 'ebayItem', data:{itemID: itemID, title: title}};
					this.manageData(["ebayItem"], [ebayItem], []);
				},
				
				clearSelected: function (){
					$$("tbody tr").each(function (element){
						element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
					});
				},
	
				nextPage: function (){
			    	var tableBody = $("listBodyEBayList");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: 'filterEbay', data:{keywords: $F("KebayList"), maxEntries: $F("MEebayList"), currentPage: parseInt($F("CPebayList")) + 1}};
			        this.manageData(["newFilter"], [filter], []);
			    },
			    
				previousPage: function (){
			    	var tableBody = $("listBodyEBayList");
			        tableBody.update("");
			        this.showProgress();
			        var filter = {id: 'filterEbay', data:{keywords: $F("KebayList"), maxEntries: $F("MEebayList"), currentPage: parseInt($F("CPebayList")) - 1}};
			        this.manageData(["newFilter"], [filter], []);
			    }
        }); 
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;input type="hidden" id="CPebayList" /&gt;
        	&lt;input type="hidden" id="MEebayList" /&gt;
        	&lt;input type="hidden" id="KebayList" /&gt;
        	&lt;span id="eBayImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/logo-ebay.gif" /&gt;&lt;/span&gt;
		    &lt;h1 id="title"&gt;eBay Item list&lt;/h1&gt;
		    &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                        	&lt;th style="width: 10%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;&amp;nbsp;&lt;/th&gt;
                            &lt;th style="width: 60%;" nowrap="nowrap"&gt;Title&lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;Category&lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;Current Price&lt;/th&gt;
                            &lt;th style="width: 20%;" nowrap="nowrap"&gt;Shipping Cost&lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;&amp;nbsp;&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyEBayList"&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
		    		&lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgEBayList" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonEbayList" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesEBayList"&gt;
					Page &lt;span id="curPageEBayList"&gt;-&lt;/span&gt;/&lt;span id="totalPagesEBayList"&gt;-&lt;/span&gt;
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonEbayList" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
   	&lt;/body&gt;
  	&lt;/html&gt;</field>
    </object>
    <object pk="282" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">282</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#loadingImgCart{
				margin:auto;	
			}
			#info{
				margin:auto;
				font-family:Arial,Helvetica,sans-serif;
				font-style:italic;
				padding-top: 10px;
				color: #AAA;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#buttonContainerDivCart{
				margin-top: 5px;
				display:none;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        var {{buildingblockId}} = Class.create(BuildingBlock,{	
			init: function (){
                $("clearButton").onclick = this.clearCart.bind(this);
                $("checkoutButton").onclick = this.checkout.bind(this);
				$("updateButton").onclick = this.updateCart.bind(this);
				$$('input[type="button"]').each(function(element){
					element.onmouseover  = function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					};
				
				});
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if (!$("loadingImgCart")) {
					$("info").update('&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;');
				}
				$("loadingImgCart").show();
				$("buttonContainerDivCart").hide();
            },

			clearCart: function (){
            	this.manageData(["clearCart"], [],[]);	
			},

			showProgress: function (){
                $("loadingImgCart").show();
            },

			showTable: function (l){
            	
                if ($("loadingImgCart")) {
                	$("loadingImgCart").hide();
				}
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if (l.data.productList.length == 0) {//Empty shopping cart
					$("info").update("Your Shopping Cart is empty");
					$("buttonContainerDivCart").hide();
					return;
				} else {
					$("info").update("");
				}
				$("buttonContainerDivCart").setStyle({display:"inline"});
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;a onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(\'#{ASIN}\',\'#{title}\');"&gt;#{title}&lt;/a&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{price}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input type="hidden" id="id"';
				templateString += 'value="#{id}"/&gt;&lt;input type="text" maxlength="3" size="2" id="itemQuantity"';
				templateString += 'value="#{quantity}"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);

                for (var i = 0; i &lt; l.data.productList.length; i++) {
                    if (l.data.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
                    }
                }

				//Last row, including subtotal
				var lastRow = "&lt;tr&gt;&lt;th style='text-align:right'&gt;Subtotal&lt;/th&gt;&lt;th&gt;";
				lastRow += l.data.subTotal;
				lastRow += "&lt;/th&gt;&lt;th&gt;";
				lastRow += l.data.itemTotal;
				lastRow += "&lt;/th&gt;&lt;/tr&gt;";
				lastRow += '&lt;input type="hidden" id="purchaseURL" value="'+l.data.purchaseURL+'"/&gt;';
				tableBody.innerHTML += lastRow;
            },
            
			showMessage: function (message){
				alert(message.data.message);
			},

			checkout: function (){
				var purchase = {id:'purchase', data:{url: $F("purchaseURL")}};
				this.manageData(["purchase"], [purchase], []);
			},
            
            //Change the current Item Fact
			productDetail: function (_ASIN,_title){
				var item = {id: 'item', data:{ASIN: _ASIN, title: _title}};
				this.manageData(["newItem"], [item], []);
			},
			
			updateCart: function (){
				var cartUpdate = {id: "cartUpdate", data:{list: new Array()}};
				var ids = $("id");
				var quantities = $("itemQuantity");
				if(!ids.length){
				  ids = [ids];
				  quantities = [quantities];
				}
				for (var i=0; i &lt; ids.length; i++){
					cartUpdate.data.list.push({id: $F(ids[i]), quantity: $F(quantities[i])});
				}
            	this.manageData(["updateCart"], [cartUpdate], []);		
			}
        });
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Shopping Cart&lt;/h1&gt;
            &lt;div id="listDivCart"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width:70%;-moz-border-radius: 13px 0px 0px 0px;"&gt;Shopping Cart Items&lt;/th&gt;
                            &lt;th style="width:10%"&gt;Price&lt;/th&gt;
                            &lt;th style="width:10%;-moz-border-radius: 0px 13px 0px 0px;"&gt;Quantity&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyCart"&gt;
                    	&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
						&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
						&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
						&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
               &lt;div id="info"&gt;&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;&lt;/div&gt;		
               &lt;div id="buttonContainerDivCart"&gt;
                    &lt;input type="button" id="clearButton" class="button" value="Clear Cart"/&gt;
					&lt;input type="button" id="updateButton" class="button" value="Update Cart"/&gt;
					&lt;input type="button" id="checkoutButton" class="button" value="Proceed to Checkout"/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#loadingImgCart{
				margin:auto;	
			}
			#info{
				margin:auto;
				font-family:Arial,Helvetica,sans-serif;
				font-style:italic;
				padding-top: 10px;
				color: #AAA;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#buttonContainerDivCart{
				margin-top: 5px;
				display:none;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        var {{buildingblockId}} = Class.create(BuildingBlock,{	
			init: function (){
                $("clearButton").onclick = this.clearCart.bind(this);
                $("checkoutButton").onclick = this.checkout.bind(this);
				$("updateButton").onclick = this.updateCart.bind(this);
				$$('input[type="button"]').each(function(element){
					element.onmouseover  = function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					};
				
				});
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if (!$("loadingImgCart")) {
					$("info").update('&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;');
				}
				$("loadingImgCart").show();
				$("buttonContainerDivCart").hide();
            },

			clearCart: function (){
            	this.manageData(["clearCart"], [],[]);	
			},

			showProgress: function (){
                $("loadingImgCart").show();
            },

			showTable: function (l){
            	
                if ($("loadingImgCart")) {
                	$("loadingImgCart").hide();
				}
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if (l.data.productList.length == 0) {//Empty shopping cart
					$("info").update("Your Shopping Cart is empty");
					$("buttonContainerDivCart").hide();
					return;
				} else {
					$("info").update("");
				}
				$("buttonContainerDivCart").setStyle({display:"inline"});
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;a onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(\'#{ASIN}\',\'#{title}\');"&gt;#{title}&lt;/a&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{price}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input type="hidden" id="id"';
				templateString += 'value="#{id}"/&gt;&lt;input type="text" maxlength="3" size="2" id="itemQuantity"';
				templateString += 'value="#{quantity}"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);

                for (var i = 0; i &lt; l.data.productList.length; i++) {
                    if (l.data.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
                    }
                }

				//Last row, including subtotal
				var lastRow = "&lt;tr&gt;&lt;th style='text-align:right'&gt;Subtotal&lt;/th&gt;&lt;th&gt;";
				lastRow += l.data.subTotal;
				lastRow += "&lt;/th&gt;&lt;th&gt;";
				lastRow += l.data.itemTotal;
				lastRow += "&lt;/th&gt;&lt;/tr&gt;";
				lastRow += '&lt;input type="hidden" id="purchaseURL" value="'+l.data.purchaseURL+'"/&gt;';
				tableBody.innerHTML += lastRow;
            },
            
			showMessage: function (message){
				alert(message.data.message);
			},

			checkout: function (){
				var purchase = {id:'purchase', data:{url: $F("purchaseURL")}};
				this.manageData(["purchase"], [purchase], []);
			},
            
            //Change the current Item Fact
			productDetail: function (_ASIN,_title){
				var item = {id: 'item', data:{ASIN: _ASIN, title: _title}};
				this.manageData(["newItem"], [item], []);
			},
			
			updateCart: function (){
				var cartUpdate = {id: "cartUpdate", data:{list: new Array()}};
				var ids = $("id");
				var quantities = $("itemQuantity");
				if(!ids.length){
				  ids = [ids];
				  quantities = [quantities];
				}
				for (var i=0; i &lt; ids.length; i++){
					cartUpdate.data.list.push({id: $F(ids[i]), quantity: $F(quantities[i])});
				}
            	this.manageData(["updateCart"], [cartUpdate], []);		
			}
        });
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Shopping Cart&lt;/h1&gt;
            &lt;div id="listDivCart"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width:70%;-moz-border-radius: 13px 0px 0px 0px;"&gt;Shopping Cart Items&lt;/th&gt;
                            &lt;th style="width:10%"&gt;Price&lt;/th&gt;
                            &lt;th style="width:10%;-moz-border-radius: 0px 13px 0px 0px;"&gt;Quantity&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyCart"&gt;
                    	&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
						&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
						&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
						&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
               &lt;div id="info"&gt;&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;&lt;/div&gt;		
               &lt;div id="buttonContainerDivCart"&gt;
                    &lt;input type="button" id="clearButton" class="button" value="Clear Cart"/&gt;
					&lt;input type="button" id="updateButton" class="button" value="Update Cart"/&gt;
					&lt;input type="button" id="checkoutButton" class="button" value="Proceed to Checkout"/&gt;
               &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
    </object>
    <object pk="283" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">283</field>
        <field type="TextField" name="code">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesComparative{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonComparative, #nextButtonComparative {
				visibility:hidden;
			}
			#loadingImgComparative{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#listDiv tbody td {
				text-align: justify;
			}
			.tiny{
				font-size:10px;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;

        var {{buildingblockId}} = Class.create(BuildingBlock,{

			init: function (item){
	        	$("nextButtonComparative").onclick = this.nextPage.bind(this);
	            $("previousButtonComparative").onclick = this.previousPage.bind(this);
				$$('input[type="button"]').each(function(element){
					element.onmouseover =  function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					};
				});
				var tableBody = $("listBodyComparative");
	            tableBody.update("");
	            $$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
	            this.showProgress();
            },

			showProgress: function (){
                $("loadingImgComparative").show();
            },
            
			showTable: function (l){
            	this.list = l;
				
            	if ($("loadingImgComparative")) {
                	$("loadingImgComparative").hide();
                }

                var tableBody = $("listBodyComparative");
                tableBody.update("");
                
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;span class="info"&gt;#{price}&lt;/span&gt; &lt;br /&gt;&lt;span class="tiny"&gt;You save #{amountSaved} (#{percentageSaved}%)&lt;/span&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{condition} #{conditionNote} &lt;/td&gt;'; 
			    templateString += '&lt;td&gt;&lt;a target="_blank" href="http://www.amazon.com/gp/help/seller/at-a-glance.html?seller=#{sellerId}"&gt;';
				templateString += '#{sellerName}&lt;/a&gt;&lt;br /&gt;&lt;span class="info"&gt;Rating:&lt;/span&gt; #{averageRating} of #{totalFeedback} user reviews';
				templateString += '&lt;br /&gt;&lt;span class="info"&gt;Availability:&lt;/span&gt; #{availability}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input width="112" type="image" height="21" border="0" align="absmiddle"';
				templateString += 'alt="Add to cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart-small.gif"';
				templateString += 'onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').add(\'#{offerId}\'); /&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodyComparative");
                for (var i = 5 * l.data.currentPage; i &lt; 5 * (l.data.currentPage + 1); i++) { //print the appropriate elements
                    if (l.data.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
                    }
                }
                //Update Interface
                if (l.data.currentPage &lt; 1 &amp;&amp; (5*(l.data.currentPage + 1)&lt; l.data.productList.length)) {
                    $("nextButtonComparative").setStyle({
                        visibility: "visible"
                    });
                } else {
                    $("nextButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }
                if (l.data.currentPage &gt; 0) {
                    $("previousButtonComparative").setStyle({
                        visibility: "visible"
                    });
                } else {
                    $("previousButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }

                if(l.data.productList.length&gt;0) {
                	$("curPageComparative").update(l.data.currentPage+1);
                	$("totalPagesComparative").update(Math.ceil(l.data.productList.length/5));
                } else {
                	$("curPageComparative").update("-");
                	$("totalPagesComparative").update("-");
                }
            },
            
			nextPage: function (){
            	var tableBody = $("listBodyComparative");
                tableBody.update("");
	            this.showProgress();
            	this.list.data.currentPage++;
            	this.showTable(this.list);
            },
            
			previousPage: function (){
				var tableBody = $("listBodyComparative");
				tableBody.update("");
	            this.showProgress();
	            this.list.data.currentPage--;
            	this.showTable(this.list);
            },

			showMessage: function (message){
				alert(message.data.message);
			},

			add: function (offerId){
            	var offer = {id: 'offer',
            			data:{offerId: offerId}};
				this.manageData(["offer"], [offer],[]);
			}
        });
		&lt;/script&gt;
	&lt;/head&gt;
	&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Price Comparative&lt;/h1&gt;
			&lt;div id="like"&gt;Offers for &lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 20%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;Price&lt;/th&gt;
                            &lt;th style="width: 30%;"&gt;Condition&lt;/th&gt;
                            &lt;th style="width: 40%;"&gt;Seller Information&lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;Ready to Buy?&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyComparative"&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
		    		&lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgComparative" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonComparative" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesComparative"&gt;
					Page &lt;span id="curPageComparative"&gt;-&lt;/span&gt;/&lt;span id="totalPagesComparative"&gt;-&lt;/span&gt;
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonComparative" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesComparative{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonComparative, #nextButtonComparative {
				visibility:hidden;
			}
			#loadingImgComparative{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#listDiv tbody td {
				text-align: justify;
			}
			.tiny{
				font-size:10px;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;

        var {{buildingblockId}} = Class.create(BuildingBlock,{

			init: function (item){
	        	$("nextButtonComparative").onclick = this.nextPage.bind(this);
	            $("previousButtonComparative").onclick = this.previousPage.bind(this);
				$$('input[type="button"]').each(function(element){
					element.onmouseover =  function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					};
				});
				var tableBody = $("listBodyComparative");
	            tableBody.update("");
	            $$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
	            this.showProgress();
            },

			showProgress: function (){
                $("loadingImgComparative").show();
            },
            
			showTable: function (l){
            	this.list = l;
				
            	if ($("loadingImgComparative")) {
                	$("loadingImgComparative").hide();
                }

                var tableBody = $("listBodyComparative");
                tableBody.update("");
                
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;span class="info"&gt;#{price}&lt;/span&gt; &lt;br /&gt;&lt;span class="tiny"&gt;You save #{amountSaved} (#{percentageSaved}%)&lt;/span&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{condition} #{conditionNote} &lt;/td&gt;'; 
			    templateString += '&lt;td&gt;&lt;a target="_blank" href="http://www.amazon.com/gp/help/seller/at-a-glance.html?seller=#{sellerId}"&gt;';
				templateString += '#{sellerName}&lt;/a&gt;&lt;br /&gt;&lt;span class="info"&gt;Rating:&lt;/span&gt; #{averageRating} of #{totalFeedback} user reviews';
				templateString += '&lt;br /&gt;&lt;span class="info"&gt;Availability:&lt;/span&gt; #{availability}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input width="112" type="image" height="21" border="0" align="absmiddle"';
				templateString += 'alt="Add to cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart-small.gif"';
				templateString += 'onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').add(\'#{offerId}\'); /&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodyComparative");
                for (var i = 5 * l.data.currentPage; i &lt; 5 * (l.data.currentPage + 1); i++) { //print the appropriate elements
                    if (l.data.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
                    }
                }
                //Update Interface
                if (l.data.currentPage &lt; 1 &amp;&amp; (5*(l.data.currentPage + 1)&lt; l.data.productList.length)) {
                    $("nextButtonComparative").setStyle({
                        visibility: "visible"
                    });
                } else {
                    $("nextButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }
                if (l.data.currentPage &gt; 0) {
                    $("previousButtonComparative").setStyle({
                        visibility: "visible"
                    });
                } else {
                    $("previousButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }

                if(l.data.productList.length&gt;0) {
                	$("curPageComparative").update(l.data.currentPage+1);
                	$("totalPagesComparative").update(Math.ceil(l.data.productList.length/5));
                } else {
                	$("curPageComparative").update("-");
                	$("totalPagesComparative").update("-");
                }
            },
            
			nextPage: function (){
            	var tableBody = $("listBodyComparative");
                tableBody.update("");
	            this.showProgress();
            	this.list.data.currentPage++;
            	this.showTable(this.list);
            },
            
			previousPage: function (){
				var tableBody = $("listBodyComparative");
				tableBody.update("");
	            this.showProgress();
	            this.list.data.currentPage--;
            	this.showTable(this.list);
            },

			showMessage: function (message){
				alert(message.data.message);
			},

			add: function (offerId){
            	var offer = {id: 'offer',
            			data:{offerId: offerId}};
				this.manageData(["offer"], [offer],[]);
			}
        });
		&lt;/script&gt;
	&lt;/head&gt;
	&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Price Comparative&lt;/h1&gt;
			&lt;div id="like"&gt;Offers for &lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 20%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;Price&lt;/th&gt;
                            &lt;th style="width: 30%;"&gt;Condition&lt;/th&gt;
                            &lt;th style="width: 40%;"&gt;Seller Information&lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;Ready to Buy?&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyComparative"&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
		    		&lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgComparative" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonComparative" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesComparative"&gt;
					Page &lt;span id="curPageComparative"&gt;-&lt;/span&gt;/&lt;span id="totalPagesComparative"&gt;-&lt;/span&gt;
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonComparative" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
    </object>
    <object pk="284" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">284</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;script language="JavaScript"&gt;
        var {{buildingblockId}} = Class.create(BuildingBlock,{
        	init: function (purchase){
        		var obj = new Element ('object',{type: "text/html", data: purchase.data.url, standby: "Loading...", width: "100%",  height: "100%"});
				$("bodyDivOrder").update(obj);
			}
        });
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDivOrder"&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;script language="JavaScript"&gt;
        var {{buildingblockId}} = Class.create(BuildingBlock,{
        	init: function (purchase){
        		var obj = new Element ('object',{type: "text/html", data: purchase.data.url, standby: "Loading...", width: "100%",  height: "100%"});
				$("bodyDivOrder").update(obj);
			}
        });
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDivOrder"&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
    </object>
    <object pk="285" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">285</field>
        <field type="TextField" name="code">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesSuggestion{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonSuggestion, #nextButtonSuggestion {
				visibility:hidden;
			}
			#loadingImgSuggestion{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;

        var {{buildingblockId}} = Class.create(BuildingBlock,{
        	
			init: function (item){
                $("nextButtonSuggestion").onclick = this.nextPage.bind(this);
                $("previousButtonSuggestion").onclick = this.previousPage.bind(this);
				$$('input[type="button"]').each(function(element){
					element.onmouseover = function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					};
				
				});
				$$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
				var tableBody = $("listBodySuggestion");
                tableBody.update("");
	            this.showProgress();
            },
            
			showTable: function (l){
            	this.list = l;
            	var tableBody = $("listBodySuggestion");
                tableBody.update("");
                
            	if ($("loadingImgSuggestion")) {
                	$("loadingImgSuggestion").hide();
                }
                var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(this,\'#{ASIN}\');"';
				templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodySuggestion");
                for (var i = 5 * l.data.currentPage; i &lt; 5 * (l.data.currentPage + 1); i++) { //print the appropriate elements
                    if (l.data.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
                    }
                }
                //Update Interface
                if (l.data.currentPage &lt; 1 &amp;&amp; (5*(l.data.currentPage + 1)&lt; l.data.productList.length)) {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
                if (l.data.currentPage &gt; 0) {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                } else {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
                //update the current page in the interface
                if (l.data.productList.length&gt;0) {
                	$("curPageSuggestion").update(l.data.currentPage+1);
                	$("totalPagesSuggestion").update(Math.ceil(l.data.productList.length/5));
                } else {
                	$("curPageSuggestion").update("-");
                	$("totalPagesSuggestion").update("-");
                }
            },

			nextPage: function (){
            	var tableBody = $("listBodySuggestion");
                tableBody.update("");
                this.showProgress();
                this.list.data.currentPage++;
            	this.showTable(this.list);
            },
            
			previousPage: function (){
            	var tableBody = $("listBodySuggestion");
                tableBody.update("");
	            this.showProgress();
                this.list.data.currentPage--;
            	this.showTable(this.list);
            },

			showMessage: function (message){
				alert(message.data.message);
			},
			
			productDetail: function (nodeElement,_ASIN){
				this.clearSelected ();
				//select the element
				nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
				var item = {id: 'item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
				this.manageData(["item"], [item], []);
			},
			
			clearSelected: function (){
				$$("tbody tr").each(function (element){
					element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
				});
			},

			showProgress: function (){
                $("loadingImgSuggestion").show();
            }

        });
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Related products to&lt;/h1&gt;
			&lt;h1 id="title"&gt;&lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/h1&gt;
			&lt;div id="like"&gt;Customers who bought &lt;span class="productTitle"&gt;&lt;/span&gt;, also bought ...&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 60%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;Title&lt;/th&gt;
                            &lt;th style="width: 10%;"&gt;Price&lt;/th&gt;
                            &lt;th style="width: 20%;"&gt;Product Group&lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;&amp;nbsp;&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodySuggestion"&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
		    		&lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgSuggestion" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonSuggestion" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesSuggestion"&gt;
					Page &lt;span id="curPageSuggestion"&gt;-&lt;/span&gt;/&lt;span id="totalPagesSuggestion"&gt;-&lt;/span&gt;
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonSuggestion" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesSuggestion{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonSuggestion, #nextButtonSuggestion {
				visibility:hidden;
			}
			#loadingImgSuggestion{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;

        var {{buildingblockId}} = Class.create(BuildingBlock,{
        	
			init: function (item){
                $("nextButtonSuggestion").onclick = this.nextPage.bind(this);
                $("previousButtonSuggestion").onclick = this.previousPage.bind(this);
				$$('input[type="button"]').each(function(element){
					element.onmouseover = function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					};
				
				});
				$$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
				var tableBody = $("listBodySuggestion");
                tableBody.update("");
	            this.showProgress();
            },
            
			showTable: function (l){
            	this.list = l;
            	var tableBody = $("listBodySuggestion");
                tableBody.update("");
                
            	if ($("loadingImgSuggestion")) {
                	$("loadingImgSuggestion").hide();
                }
                var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="ScreenEngineFactory.getInstance(\'{{screenId}}\').getBuildingBlock(\'{{buildingblockInstance}}\').productDetail(this,\'#{ASIN}\');"';
				templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodySuggestion");
                for (var i = 5 * l.data.currentPage; i &lt; 5 * (l.data.currentPage + 1); i++) { //print the appropriate elements
                    if (l.data.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(l.data.productList[i]);
                    }
                }
                //Update Interface
                if (l.data.currentPage &lt; 1 &amp;&amp; (5*(l.data.currentPage + 1)&lt; l.data.productList.length)) {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
                if (l.data.currentPage &gt; 0) {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                } else {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
                //update the current page in the interface
                if (l.data.productList.length&gt;0) {
                	$("curPageSuggestion").update(l.data.currentPage+1);
                	$("totalPagesSuggestion").update(Math.ceil(l.data.productList.length/5));
                } else {
                	$("curPageSuggestion").update("-");
                	$("totalPagesSuggestion").update("-");
                }
            },

			nextPage: function (){
            	var tableBody = $("listBodySuggestion");
                tableBody.update("");
                this.showProgress();
                this.list.data.currentPage++;
            	this.showTable(this.list);
            },
            
			previousPage: function (){
            	var tableBody = $("listBodySuggestion");
                tableBody.update("");
	            this.showProgress();
                this.list.data.currentPage--;
            	this.showTable(this.list);
            },

			showMessage: function (message){
				alert(message.data.message);
			},
			
			productDetail: function (nodeElement,_ASIN){
				this.clearSelected ();
				//select the element
				nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
				var item = {id: 'item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
				this.manageData(["item"], [item], []);
			},
			
			clearSelected: function (){
				$$("tbody tr").each(function (element){
					element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
				});
			},

			showProgress: function (){
                $("loadingImgSuggestion").show();
            }

        });
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Related products to&lt;/h1&gt;
			&lt;h1 id="title"&gt;&lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/h1&gt;
			&lt;div id="like"&gt;Customers who bought &lt;span class="productTitle"&gt;&lt;/span&gt;, also bought ...&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 60%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;Title&lt;/th&gt;
                            &lt;th style="width: 10%;"&gt;Price&lt;/th&gt;
                            &lt;th style="width: 20%;"&gt;Product Group&lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;&amp;nbsp;&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodySuggestion"&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
                           &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
		    		&lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgSuggestion" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonSuggestion" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesSuggestion"&gt;
					Page &lt;span id="curPageSuggestion"&gt;-&lt;/span&gt;/&lt;span id="totalPagesSuggestion"&gt;-&lt;/span&gt;
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonSuggestion" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
    </object>
    <object pk="286" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">286</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#productImage{
				height: 170px;
				-moz-border-radius: 13px 13px;
				background: #FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				margin:0px auto 13px;
				text-align:center;
				width:88%;
				padding-bottom:5px;
				padding-top:10px;
			}
			#leftColumn{
				position: relative;
				float:left;
				height: 100%;
				width: 35%;
			}
			#rightColumn{
				position: relative;
				float:right;
				height: 268px;
				width: 60%;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				padding-top:5px;
				padding-right:0px;
				padding-left:5px;
				padding-bottom: 5px;
				position:relative;
			}
			#infoArea{
				text-align: left;
			}
			#titleInfo{
				float:left;
				margin: 5px;
				width:35%;
				overflow: hidden;
			}
			#valueInfo{
				float:left;
				margin: 5px 15px 5px 5px;
				width: 50%;
			}
			#moreInfo{
				float:left;
				margin-left: 5px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
			.info{
				padding: 2px;
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-weight: bold;
				text-align: justify;
				white-space: nowrap;
				overflow: hidden;
			}
			#quantity {
				margin: 5px;
				color:#777777;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;
			}
			#cart {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:78px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:88%;
			}
			#moreInfoText {
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-size:13px;
				height:133px;
				margin:0;
				overflow:auto;
				padding:2px 15px 2px 2px;
				text-align:left;
				width:300px;
				max-width:300px;
			}
			.detailsElement {
				color:#888888;
				font-weight:bold;
			}
			#bodyDivDetails {
				max-width:550px;
				text-align:center;
				margin: 8px auto 20px auto;
				height:270px;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        	var {{buildingblockId}} = Class.create(BuildingBlock,{
					init: function (){
		        		$("addToCart").onclick = this.addToCart.bind(this);
					},

					showProductInfo: function (_product){
						$("quantitySelect").value=1;
						if (_product.data.title) {
							//Reset styles
							$("productTitle").setStyle ({"fontSize":"20px"});
							$("moreInfoText").setStyle({"height": "133px"});
							$("productTitle").update(_product.data.title);
							if ($("productTitle").clientHeight &gt; 28) {//Big title
								//Big title, adapt styles
								$("productTitle").setStyle ({"fontSize":"16px"});
								if ($("productTitle").clientHeight &gt; 23) {//More than one line
									if ($("productTitle").clientHeight &gt; 46) {//More than two lines
										if ($("productTitle").clientHeight &gt; 69) {//More than three lines
											$("productTitle").setStyle ({"fontSize":"13px"});
											if ($("productTitle").clientHeight &gt; 49) {//Still more than three lines
												$("moreInfoText").setStyle({"height": "90px"});
											} else {
												$("moreInfoText").setStyle({"height": "110px"});
											}
										} 
										else{//Three lines
											$("moreInfoText").setStyle({"height": "110px"});
											$("productTitle").setStyle ({"fontSize":"14px"});	
										}
									} else {//Two lines
										$("moreInfoText").setStyle({"height": "115px"});
									}	
								}
							}
							
						}
						if (_product.data.price) {
							$("price").update(_product.data.price);
						} else {
							$("price").update("");
						}
						if (_product.data.pGroup) {
							$("pGroup").update(_product.data.pGroup);
						} else {
							$("pGroup").update("");
						}
						if (_product.data.url) {
							var a = new Element('a',{href:_product.data.url,target:"_blank"}).update ("Amazon");
							$("url").update (a);
						} else {
							$("url").update ("");
						}
						if (_product.data.image) {
							var img = new Element ('img',{src: _product.data.image});
							$("productImage").update(img);
						} else {
							var img = new Element ('img',{src: "http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.jpg"});
							$("productImage").update(img);	
						}
						this.showAdvancedDetails(_product);				 
					},
					
					showAdvancedDetails: function (_product){
						var element = _product.data.item;
						var pGroup = _product.data.pGroup;

						var itemAttributes = element.getElementsByTagName("ItemAttributes")[0];
						var attributesHTML = "&lt;ul&gt;";
						//List of elements to be shown
						var elementList = [];
						switch (pGroup){
							case "eBooks":
							case "Book":
								//Print all book authors
								attributesHTML += this.elementDetail("Author",itemAttributes,"Author(s)");
								//Print the remainder features
								elementList = [{nodeElement:"PublicationDate",caption:"Publication Date"},
											   "ISBN",
											   "Format",
											   {nodeElement:"Label", caption:"Publisher"},
											   {nodeElement:"NumberOfPages", caption:"Pages"}];	
							    attributesHTML += this.productDetailsList(elementList,itemAttributes);	
								break;
							case "Theatrical Release":
							case "Video":
							case "DVD":
								//Print all actors
								attributesHTML += this.elementDetail("Actor",itemAttributes,"Cast");
								//Print all directors
								attributesHTML += this.elementDetail("Director",itemAttributes);
								elementList = 	["Genre",
												{nodeElement:"RunningTime",caption: "Run Time"},
												{nodeElement:"AudienceRating", caption:"Audience Rating"},
												"Label",
												"Binding",
												"Region",
												{nodeElement:"AspectRatio", caption:"Aspect Ratio"},
												{nodeElement:"OriginalReleaseDate", caption:"Release Date"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.twoElements ("DVDLayers","DVDSides",itemAttributes,"DVD Layers / Sides");
								//Print technical details
								attributesHTML += this.elementDetail("Format",itemAttributes);
								break;
							case "Digital Music Track":
							case "Music":
								elementList = 	["Artist",
												"Genre",
												"Label",
												"Binding",
												"Format",
												{nodeElement:"NumberOfDiscs", caption:"Number of Discs"},
												{nodeElement:"ReleaseDate", caption:"Release Date"},
												{nodeElement:"OriginalReleaseDate", caption:"Original Release Date"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								break;
							case "Photography":
								//Print details 
								elementList = ["Brand","Model"];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);	
								//Print all camera features
								attributesHTML += this.elementDetail("Feature",itemAttributes,"Features",".");
								break;
							case "Personal Computer":
								elementList = 	["Model",
												"Label",
												"Binding"];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.twoElements ("CPUType","CPUSpeed",itemAttributes,"CPU", " ");
								elementList = 	[{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"HardDiskSize", caption:"Hard Disk Size"},
												{nodeElement:"DataLinkProtocol", caption:"Data Link Protocol"},
												{nodeElement:"FloppyDiskDriveDescription", caption:"Floppy Disk Drive"}];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.twoElements ("SystemMemorySize","SystemMemoryType",itemAttributes,"Memory", " ");								
								elementList = 	[{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												"Warranty",
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];	
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += this.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features
								attributesHTML += this.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							case "CE":
							case "Video Games":						
							case "Software":
							case "Wireless":
							case "Wireless Phone Accessory":
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"ESRBAgeRating", caption:"Age Rating"},
												{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += this.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features (only CE)
								attributesHTML += this.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							default:
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"ReleaseDate",caption:"Release Date"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.elementDetail("Feature",itemAttributes, "Features",".");
								break;				
						}
						attributesHTML += "&lt;/ul&gt;";
						if (attributesHTML.length&gt;9) {//There is something to show
							$("moreInfoText").update(attributesHTML);
							$("moreInfoText").setStyle({"borderTop":"1px dotted #AAAAAA"});
							$("moreInfoTitle").update("Product Details");
						} 
							
					},
					
					//This function returns a html with pre-formatted details list
					//Each element of attributesList can be an object with two elements (nodeElement and caption)
					//or simply a string representing both of them
					productDetailsList: function (attributesList,attributesNode){
						var result = "";
						$A(attributesList).each(function(attribute){
								var element = attributesNode.getElementsByTagName ((attribute.nodeElement?attribute.nodeElement:attribute));						
								if (element.length &gt; 0) {
									result += "&lt;li&gt;" + (attribute.caption?attribute.caption:attribute) + ": ";
									result += "&lt;span class='detailsElement'&gt;";
									result += element[0].firstChild.nodeValue;
									if (element[0].getAttribute("Units") &amp;&amp; element[0].getAttribute("Units")!= "unknown-units") {
										result += " " + element[0].getAttribute("Units");
									}
									result += "&lt;/span&gt;&lt;/li&gt;";
								}
						});
						return result;
					},
					
					//This function produces a single li with a list of elements (authors, features...)
					//caption parameter is optional
					//separationCharacter parameter is optional
					elementDetail: function (element,attributesNode,caption,separationCharacter){
							var list = attributesNode.getElementsByTagName(element);
							var result = "";
							if (list.length &gt; 0) {
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								$A(list).each (function (e){
									result += e.firstChild.nodeValue + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					},
					
					//This function produces a single li with a list of features. The original line has 
					//extrange separators
					//caption parameter is optional
					//separationCharacter parameter is optional
					specialElementDetail: function (element,attributesNode,beforeSeparationCharacter,caption,separationCharacter){
							var element = attributesNode.getElementsByTagName(element);
							var result = "";
							if (element.length &gt; 0) {
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								var list = element[0].firstChild.nodeValue.split(beforeSeparationCharacter);
								$A(list).each (function (e){
									result += e + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					},
					
					//This function produces a single li two elements separated by "/"
					//caption parameter is optional
					//separationCharacter is optional
					twoElements: function (element1,element2,attributesNode, caption, separationCharacter){
							var _element1 = attributesNode.getElementsByTagName(element1);
							var _element2 = attributesNode.getElementsByTagName(element2);
							var result = "";
							//At least one correct element
							if (_element1.length &gt; 0 || _element2.length &gt; 0) {
								result += "&lt;li&gt;" + (caption?caption:(element1 + " / " + element2))  + ": &lt;span class='detailsElement'&gt;";
								result += (_element1[0]?_element1[0].firstChild.nodeValue:"-");
								if (_element1[0].getAttribute("Units") &amp;&amp; _element1[0].getAttribute("Units")!= "unknown-units") {
									result += " " + _element1[0].getAttribute("Units");
								}
								result += (separationCharacter?separationCharacter:" / ");
								result += (_element2[0]?_element2[0].firstChild.nodeValue:"-");
								if (_element2[0].getAttribute("Units") &amp;&amp; _element2[0].getAttribute("Units")!= "unknown-units") {
									result += " " + _element2[0].getAttribute("Units");
								}
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;
					},

					showMessage: function (message){
						alert(message.data.message);
					},

					addToCart: function (){
						this.manageData(["addToCart"], [], []);	
					}
        	});
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDivDetails"&gt;
        	&lt;div id="leftColumn"&gt;
		     	&lt;div id="productImage"&gt;&lt;/div&gt;
				&lt;div id="cart"&gt;
					&lt;div id="quantity"&gt;Quantity:  	&lt;select id="quantitySelect"&gt;
								  	&lt;option value ="1"&gt;1&lt;/option&gt;
								  	&lt;option value ="2"&gt;2&lt;/option&gt;
								  	&lt;option value ="3"&gt;3&lt;/option&gt;
								  	&lt;option value ="4"&gt;4&lt;/option&gt;
								  	&lt;option value ="5"&gt;5&lt;/option&gt;	
								 	&lt;option value ="6"&gt;6&lt;/option&gt;
								  	&lt;option value ="7"&gt;7&lt;/option&gt;	
								  	&lt;option value ="8"&gt;8&lt;/option&gt;		
									&lt;option value ="9"&gt;9&lt;/option&gt;	
								  	&lt;option value ="10"&gt;10&lt;/option&gt;						
									&lt;/select&gt;
					&lt;/div&gt;
					&lt;input border="0" height="27" width="160" type="image" id="addToCart" alt="Add to Shopping Cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart.gif"/&gt;
				&lt;/div&gt;       	
			&lt;/div&gt;
			&lt;div id="rightColumn"&gt;
				&lt;div id="productTitle" style="font-size: 20px; padding: 2px; color:#F8A704; font-weight: bold; font-style: italic; font-family:Arial,Helvetica,sans-serif; overflow: hidden;"&gt;&lt;/div&gt;
				&lt;div id="infoArea"&gt;
					&lt;span id="titleInfo"&gt;
						&lt;div class="title"&gt;Product Type: &lt;/div&gt;
						&lt;div class="title"&gt;Price: &lt;/div&gt;
						&lt;div class="title"&gt;Product Site: &lt;/div&gt;
						&lt;div class="title" id="titleInfo1"&gt;&lt;/div&gt;
					&lt;/span&gt;
					&lt;span id="valueInfo"&gt;
						&lt;div id="pGroup" class="info"&gt;&lt;/div&gt;
						&lt;div id="price" class="info"&gt;&lt;/div&gt;
						&lt;div id="url" class="info"&gt;&lt;/div&gt;
						&lt;div id="info1" class="info"&gt;&lt;/div&gt;
					&lt;/span&gt;
					&lt;div id="moreInfo"&gt;
						&lt;div class="title" id="moreInfoTitle"&gt;&lt;/div&gt;
						&lt;div id="moreInfoText"&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#productImage{
				height: 170px;
				-moz-border-radius: 13px 13px;
				background: #FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				margin:0px auto 13px;
				text-align:center;
				width:88%;
				padding-bottom:5px;
				padding-top:10px;
			}
			#leftColumn{
				position: relative;
				float:left;
				height: 100%;
				width: 35%;
			}
			#rightColumn{
				position: relative;
				float:right;
				height: 268px;
				width: 60%;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				padding-top:5px;
				padding-right:0px;
				padding-left:5px;
				padding-bottom: 5px;
				position:relative;
			}
			#infoArea{
				text-align: left;
			}
			#titleInfo{
				float:left;
				margin: 5px;
				width:35%;
				overflow: hidden;
			}
			#valueInfo{
				float:left;
				margin: 5px 15px 5px 5px;
				width: 50%;
			}
			#moreInfo{
				float:left;
				margin-left: 5px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
			.info{
				padding: 2px;
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-weight: bold;
				text-align: justify;
				white-space: nowrap;
				overflow: hidden;
			}
			#quantity {
				margin: 5px;
				color:#777777;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;
			}
			#cart {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:78px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:88%;
			}
			#moreInfoText {
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-size:13px;
				height:133px;
				margin:0;
				overflow:auto;
				padding:2px 15px 2px 2px;
				text-align:left;
				width:300px;
				max-width:300px;
			}
			.detailsElement {
				color:#888888;
				font-weight:bold;
			}
			#bodyDivDetails {
				max-width:550px;
				text-align:center;
				margin: 8px auto 20px auto;
				height:270px;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        	var {{buildingblockId}} = Class.create(BuildingBlock,{
					init: function (){
		        		$("addToCart").onclick = this.addToCart.bind(this);
					},

					showProductInfo: function (_product){
						$("quantitySelect").value=1;
						if (_product.data.title) {
							//Reset styles
							$("productTitle").setStyle ({"fontSize":"20px"});
							$("moreInfoText").setStyle({"height": "133px"});
							$("productTitle").update(_product.data.title);
							if ($("productTitle").clientHeight &gt; 28) {//Big title
								//Big title, adapt styles
								$("productTitle").setStyle ({"fontSize":"16px"});
								if ($("productTitle").clientHeight &gt; 23) {//More than one line
									if ($("productTitle").clientHeight &gt; 46) {//More than two lines
										if ($("productTitle").clientHeight &gt; 69) {//More than three lines
											$("productTitle").setStyle ({"fontSize":"13px"});
											if ($("productTitle").clientHeight &gt; 49) {//Still more than three lines
												$("moreInfoText").setStyle({"height": "90px"});
											} else {
												$("moreInfoText").setStyle({"height": "110px"});
											}
										} 
										else{//Three lines
											$("moreInfoText").setStyle({"height": "110px"});
											$("productTitle").setStyle ({"fontSize":"14px"});	
										}
									} else {//Two lines
										$("moreInfoText").setStyle({"height": "115px"});
									}	
								}
							}
							
						}
						if (_product.data.price) {
							$("price").update(_product.data.price);
						} else {
							$("price").update("");
						}
						if (_product.data.pGroup) {
							$("pGroup").update(_product.data.pGroup);
						} else {
							$("pGroup").update("");
						}
						if (_product.data.url) {
							var a = new Element('a',{href:_product.data.url,target:"_blank"}).update ("Amazon");
							$("url").update (a);
						} else {
							$("url").update ("");
						}
						if (_product.data.image) {
							var img = new Element ('img',{src: _product.data.image});
							$("productImage").update(img);
						} else {
							var img = new Element ('img',{src: "http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.jpg"});
							$("productImage").update(img);	
						}
						this.showAdvancedDetails(_product);				 
					},
					
					showAdvancedDetails: function (_product){
						var element = _product.data.item;
						var pGroup = _product.data.pGroup;

						var itemAttributes = element.getElementsByTagName("ItemAttributes")[0];
						var attributesHTML = "&lt;ul&gt;";
						//List of elements to be shown
						var elementList = [];
						switch (pGroup){
							case "eBooks":
							case "Book":
								//Print all book authors
								attributesHTML += this.elementDetail("Author",itemAttributes,"Author(s)");
								//Print the remainder features
								elementList = [{nodeElement:"PublicationDate",caption:"Publication Date"},
											   "ISBN",
											   "Format",
											   {nodeElement:"Label", caption:"Publisher"},
											   {nodeElement:"NumberOfPages", caption:"Pages"}];	
							    attributesHTML += this.productDetailsList(elementList,itemAttributes);	
								break;
							case "Theatrical Release":
							case "Video":
							case "DVD":
								//Print all actors
								attributesHTML += this.elementDetail("Actor",itemAttributes,"Cast");
								//Print all directors
								attributesHTML += this.elementDetail("Director",itemAttributes);
								elementList = 	["Genre",
												{nodeElement:"RunningTime",caption: "Run Time"},
												{nodeElement:"AudienceRating", caption:"Audience Rating"},
												"Label",
												"Binding",
												"Region",
												{nodeElement:"AspectRatio", caption:"Aspect Ratio"},
												{nodeElement:"OriginalReleaseDate", caption:"Release Date"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.twoElements ("DVDLayers","DVDSides",itemAttributes,"DVD Layers / Sides");
								//Print technical details
								attributesHTML += this.elementDetail("Format",itemAttributes);
								break;
							case "Digital Music Track":
							case "Music":
								elementList = 	["Artist",
												"Genre",
												"Label",
												"Binding",
												"Format",
												{nodeElement:"NumberOfDiscs", caption:"Number of Discs"},
												{nodeElement:"ReleaseDate", caption:"Release Date"},
												{nodeElement:"OriginalReleaseDate", caption:"Original Release Date"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								break;
							case "Photography":
								//Print details 
								elementList = ["Brand","Model"];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);	
								//Print all camera features
								attributesHTML += this.elementDetail("Feature",itemAttributes,"Features",".");
								break;
							case "Personal Computer":
								elementList = 	["Model",
												"Label",
												"Binding"];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.twoElements ("CPUType","CPUSpeed",itemAttributes,"CPU", " ");
								elementList = 	[{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"HardDiskSize", caption:"Hard Disk Size"},
												{nodeElement:"DataLinkProtocol", caption:"Data Link Protocol"},
												{nodeElement:"FloppyDiskDriveDescription", caption:"Floppy Disk Drive"}];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.twoElements ("SystemMemorySize","SystemMemoryType",itemAttributes,"Memory", " ");								
								elementList = 	[{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												"Warranty",
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];	
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += this.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features
								attributesHTML += this.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							case "CE":
							case "Video Games":						
							case "Software":
							case "Wireless":
							case "Wireless Phone Accessory":
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"ESRBAgeRating", caption:"Age Rating"},
												{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += this.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features (only CE)
								attributesHTML += this.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							default:
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"ReleaseDate",caption:"Release Date"}
												];
								attributesHTML += this.productDetailsList(elementList,itemAttributes);
								attributesHTML += this.elementDetail("Feature",itemAttributes, "Features",".");
								break;				
						}
						attributesHTML += "&lt;/ul&gt;";
						if (attributesHTML.length&gt;9) {//There is something to show
							$("moreInfoText").update(attributesHTML);
							$("moreInfoText").setStyle({"borderTop":"1px dotted #AAAAAA"});
							$("moreInfoTitle").update("Product Details");
						} 
							
					},
					
					//This function returns a html with pre-formatted details list
					//Each element of attributesList can be an object with two elements (nodeElement and caption)
					//or simply a string representing both of them
					productDetailsList: function (attributesList,attributesNode){
						var result = "";
						$A(attributesList).each(function(attribute){
								var element = attributesNode.getElementsByTagName ((attribute.nodeElement?attribute.nodeElement:attribute));						
								if (element.length &gt; 0) {
									result += "&lt;li&gt;" + (attribute.caption?attribute.caption:attribute) + ": ";
									result += "&lt;span class='detailsElement'&gt;";
									result += element[0].firstChild.nodeValue;
									if (element[0].getAttribute("Units") &amp;&amp; element[0].getAttribute("Units")!= "unknown-units") {
										result += " " + element[0].getAttribute("Units");
									}
									result += "&lt;/span&gt;&lt;/li&gt;";
								}
						});
						return result;
					},
					
					//This function produces a single li with a list of elements (authors, features...)
					//caption parameter is optional
					//separationCharacter parameter is optional
					elementDetail: function (element,attributesNode,caption,separationCharacter){
							var list = attributesNode.getElementsByTagName(element);
							var result = "";
							if (list.length &gt; 0) {
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								$A(list).each (function (e){
									result += e.firstChild.nodeValue + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					},
					
					//This function produces a single li with a list of features. The original line has 
					//extrange separators
					//caption parameter is optional
					//separationCharacter parameter is optional
					specialElementDetail: function (element,attributesNode,beforeSeparationCharacter,caption,separationCharacter){
							var element = attributesNode.getElementsByTagName(element);
							var result = "";
							if (element.length &gt; 0) {
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								var list = element[0].firstChild.nodeValue.split(beforeSeparationCharacter);
								$A(list).each (function (e){
									result += e + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					},
					
					//This function produces a single li two elements separated by "/"
					//caption parameter is optional
					//separationCharacter is optional
					twoElements: function (element1,element2,attributesNode, caption, separationCharacter){
							var _element1 = attributesNode.getElementsByTagName(element1);
							var _element2 = attributesNode.getElementsByTagName(element2);
							var result = "";
							//At least one correct element
							if (_element1.length &gt; 0 || _element2.length &gt; 0) {
								result += "&lt;li&gt;" + (caption?caption:(element1 + " / " + element2))  + ": &lt;span class='detailsElement'&gt;";
								result += (_element1[0]?_element1[0].firstChild.nodeValue:"-");
								if (_element1[0].getAttribute("Units") &amp;&amp; _element1[0].getAttribute("Units")!= "unknown-units") {
									result += " " + _element1[0].getAttribute("Units");
								}
								result += (separationCharacter?separationCharacter:" / ");
								result += (_element2[0]?_element2[0].firstChild.nodeValue:"-");
								if (_element2[0].getAttribute("Units") &amp;&amp; _element2[0].getAttribute("Units")!= "unknown-units") {
									result += " " + _element2[0].getAttribute("Units");
								}
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;
					},

					showMessage: function (message){
						alert(message.data.message);
					},

					addToCart: function (){
						this.manageData(["addToCart"], [], []);	
					}
        	});
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDivDetails"&gt;
        	&lt;div id="leftColumn"&gt;
		     	&lt;div id="productImage"&gt;&lt;/div&gt;
				&lt;div id="cart"&gt;
					&lt;div id="quantity"&gt;Quantity:  	&lt;select id="quantitySelect"&gt;
								  	&lt;option value ="1"&gt;1&lt;/option&gt;
								  	&lt;option value ="2"&gt;2&lt;/option&gt;
								  	&lt;option value ="3"&gt;3&lt;/option&gt;
								  	&lt;option value ="4"&gt;4&lt;/option&gt;
								  	&lt;option value ="5"&gt;5&lt;/option&gt;	
								 	&lt;option value ="6"&gt;6&lt;/option&gt;
								  	&lt;option value ="7"&gt;7&lt;/option&gt;	
								  	&lt;option value ="8"&gt;8&lt;/option&gt;		
									&lt;option value ="9"&gt;9&lt;/option&gt;	
								  	&lt;option value ="10"&gt;10&lt;/option&gt;						
									&lt;/select&gt;
					&lt;/div&gt;
					&lt;input border="0" height="27" width="160" type="image" id="addToCart" alt="Add to Shopping Cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart.gif"/&gt;
				&lt;/div&gt;       	
			&lt;/div&gt;
			&lt;div id="rightColumn"&gt;
				&lt;div id="productTitle" style="font-size: 20px; padding: 2px; color:#F8A704; font-weight: bold; font-style: italic; font-family:Arial,Helvetica,sans-serif; overflow: hidden;"&gt;&lt;/div&gt;
				&lt;div id="infoArea"&gt;
					&lt;span id="titleInfo"&gt;
						&lt;div class="title"&gt;Product Type: &lt;/div&gt;
						&lt;div class="title"&gt;Price: &lt;/div&gt;
						&lt;div class="title"&gt;Product Site: &lt;/div&gt;
						&lt;div class="title" id="titleInfo1"&gt;&lt;/div&gt;
					&lt;/span&gt;
					&lt;span id="valueInfo"&gt;
						&lt;div id="pGroup" class="info"&gt;&lt;/div&gt;
						&lt;div id="price" class="info"&gt;&lt;/div&gt;
						&lt;div id="url" class="info"&gt;&lt;/div&gt;
						&lt;div id="info1" class="info"&gt;&lt;/div&gt;
					&lt;/span&gt;
					&lt;div id="moreInfo"&gt;
						&lt;div class="title" id="moreInfoTitle"&gt;&lt;/div&gt;
						&lt;div id="moreInfoText"&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</field>
    </object>
    <object pk="287" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">287</field>
        <field type="TextField" name="code">var BB287 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    filter: (function(){

    var conditions = {
        "eq": function(left, right) { return left == right; },
        "ne": function(left, right) { return left != right; },
        "lt": function(left, right) { return left &lt; right; },
        "le": function(left, right) { return left &lt;= right; },
        "gt": function(left, right) { return left &gt; right; },
        "ge": function(left, right) { return left &gt;= right; },
        "match": function(left, right) {
            var regExp = new RegExp(right);
            return left.match(regExp);
        }
    };

    return function (item) {
        var it = item.data;
        var params = this.parameter;
        for (var j = 0, condition; condition = params[j]; j++) {
        	var filter = conditions[condition.searchCondition] || conditions.eq;
            if (!filter(it[condition.keyField], condition.searchValue)) {
            	return;
            }
        }
        this.manageData([], [{id: 'filteredItem', data: it}], []);
    };
})()

    
});
    </field>
        <field type="TextField" name="unboundCode">filter: (function(){

    var conditions = {
        "eq": function(left, right) { return left == right; },
        "ne": function(left, right) { return left != right; },
        "lt": function(left, right) { return left &lt; right; },
        "le": function(left, right) { return left &lt;= right; },
        "gt": function(left, right) { return left &gt; right; },
        "ge": function(left, right) { return left &gt;= right; },
        "match": function(left, right) {
            var regExp = new RegExp(right);
            return left.match(regExp);
        }
    };

    return function (item) {
        var it = item.data;
        var params = this.parameter;
        for (var j = 0, condition; condition = params[j]; j++) {
        	var filter = conditions[condition.searchCondition] || conditions.eq;
            if (!filter(it[condition.keyField], condition.searchValue)) {
            	return;
            }
        }
        this.manageData([], [{id: 'filteredItem', data: it}], []);
    };
})()
</field>
    </object>
    <object pk="288" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">288</field>
        <field type="TextField" name="code">var BB288 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    mix: function (list1, list2) {
    //var result = Object.clone(list1.data);
    var mixedList = [];

    if (this.params &amp;&amp; this.params.keyField) {
        var keyField = this.params.keyField;
        var mixedListHash = new Hash();
        //var mixedList = [];

        /*for (var i = 0; i &lt; list1.data.productList.length; i++) {
            var item = list1.data.productList[i];
            mixedListHash.set(item[keyField], item);
        }
        for (var i = 0; i &lt; list2.data.productListlength; i++) {
            var item = list2.data.productList[i];
            mixedListHash.set(item[keyField], item);
        }*/

        for (var i = 0; i &lt; list1.data.length; i++) {
            var item = list1.data[i];
            mixedListHash.set(item[keyField], item);
        }
        for (var i = 0; i &lt; list2.data.length; i++) {
            var item = list2.data[i];
            mixedListHash.set(item[keyField], item);
        }

        mixedListHash.each(function (element) {
            mixedList.push(element.value);
        });

        //result.productList = mixedList;

    } else {
        //result.productList = list1.data.productList.concat(list2.data.productList);
        mixedList = list1.data.concat(list2.data);
    }

    var facts = [{id: 'mixedList', data: mixedList}];

    this.manageData([], facts, []);
}

    
});
    </field>
        <field type="TextField" name="unboundCode">mix: function (list1, list2) {
    //var result = Object.clone(list1.data);
    var mixedList = [];

    if (this.params &amp;&amp; this.params.keyField) {
        var keyField = this.params.keyField;
        var mixedListHash = new Hash();
        //var mixedList = [];

        /*for (var i = 0; i &lt; list1.data.productList.length; i++) {
            var item = list1.data.productList[i];
            mixedListHash.set(item[keyField], item);
        }
        for (var i = 0; i &lt; list2.data.productListlength; i++) {
            var item = list2.data.productList[i];
            mixedListHash.set(item[keyField], item);
        }*/

        for (var i = 0; i &lt; list1.data.length; i++) {
            var item = list1.data[i];
            mixedListHash.set(item[keyField], item);
        }
        for (var i = 0; i &lt; list2.data.length; i++) {
            var item = list2.data[i];
            mixedListHash.set(item[keyField], item);
        }

        mixedListHash.each(function (element) {
            mixedList.push(element.value);
        });

        //result.productList = mixedList;

    } else {
        //result.productList = list1.data.productList.concat(list2.data.productList);
        mixedList = list1.data.concat(list2.data);
    }

    var facts = [{id: 'mixedList', data: mixedList}];

    this.manageData([], facts, []);
}
</field>
    </object>
    <object pk="289" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">289</field>
        <field type="TextField" name="code">var BB289 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    filter: (function(){

    var conditions = {
        "eq": function(left, right) { return left == right; },
        "ne": function(left, right) { return left != right; },
        "lt": function(left, right) { return left &lt; right; },
        "le": function(left, right) { return left &lt;= right; },
        "gt": function(left, right) { return left &gt; right; },
        "ge": function(left, right) { return left &gt;= right; },
        "match": function(left, right) {
            var regExp = new RegExp(right);
            return left.match(regExp);
        }
    };

    return function (list) {
    	var filteredList = new Array();
        var items = list.data;
        for (var i = 0, item; item = items[i]; i++) {
            var found = true;
            var params = this.parameter;
            for (var j = 0, condition; condition = params[j]; j++) {
            	found = true;
            	var filter = conditions[condition.searchCondition] || conditions.eq;
                if (!filter(item[condition.keyField], condition.searchValue)) {
                    found = false;
                    break;
                }
            }
            if (found){
            	filteredList.push(item);
            }
        }
        this.manageData([], [{id: 'filteredGroup', data: filteredList}], []);
    };
})()

    
});
    </field>
        <field type="TextField" name="unboundCode">filter: (function(){

    var conditions = {
        "eq": function(left, right) { return left == right; },
        "ne": function(left, right) { return left != right; },
        "lt": function(left, right) { return left &lt; right; },
        "le": function(left, right) { return left &lt;= right; },
        "gt": function(left, right) { return left &gt; right; },
        "ge": function(left, right) { return left &gt;= right; },
        "match": function(left, right) {
            var regExp = new RegExp(right);
            return left.match(regExp);
        }
    };

    return function (list) {
    	var filteredList = new Array();
        var items = list.data;
        for (var i = 0, item; item = items[i]; i++) {
            var found = true;
            var params = this.parameter;
            for (var j = 0, condition; condition = params[j]; j++) {
            	found = true;
            	var filter = conditions[condition.searchCondition] || conditions.eq;
                if (!filter(item[condition.keyField], condition.searchValue)) {
                    found = false;
                    break;
                }
            }
            if (found){
            	filteredList.push(item);
            }
        }
        this.manageData([], [{id: 'filteredGroup', data: filteredList}], []);
    };
})()
</field>
    </object>
    <object pk="290" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">290</field>
        <field type="TextField" name="code">var BB290 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    filter: (function(){

    var conditions = {
        "eq": function(left, right) { return left == right; },
        "ne": function(left, right) { return left != right; },
        "lt": function(left, right) { return left &lt; right; },
        "le": function(left, right) { return left &lt;= right; },
        "gt": function(left, right) { return left &gt; right; },
        "ge": function(left, right) { return left &gt;= right; },
        "match": function(left, right) {
            var regExp = new RegExp(right);
            return left.match(regExp);
        }
    };

    return function (list) {
        var items = list.data;
        for (var i = 0, item; item = items[i]; i++) {
            var found = true;
            var params = this.parameter;
            for (var j = 0, condition; condition = params[j]; j++) {
            	var filter = conditions[condition.searchCondition] || conditions.eq;
                if (!filter(item[condition.keyField], condition.searchValue)) {
                    found = false;
                    break;
                }
            }
            if (found){
            	this.manageData([], [{id: 'filteredItem', data: item}], []);
            	return;
            }
        }
    };
})()

    
});
    </field>
        <field type="TextField" name="unboundCode">filter: (function(){

    var conditions = {
        "eq": function(left, right) { return left == right; },
        "ne": function(left, right) { return left != right; },
        "lt": function(left, right) { return left &lt; right; },
        "le": function(left, right) { return left &lt;= right; },
        "gt": function(left, right) { return left &gt; right; },
        "ge": function(left, right) { return left &gt;= right; },
        "match": function(left, right) {
            var regExp = new RegExp(right);
            return left.match(regExp);
        }
    };

    return function (list) {
        var items = list.data;
        for (var i = 0, item; item = items[i]; i++) {
            var found = true;
            var params = this.parameter;
            for (var j = 0, condition; condition = params[j]; j++) {
            	var filter = conditions[condition.searchCondition] || conditions.eq;
                if (!filter(item[condition.keyField], condition.searchValue)) {
                    found = false;
                    break;
                }
            }
            if (found){
            	this.manageData([], [{id: 'filteredItem', data: item}], []);
            	return;
            }
        }
    };
})()
</field>
    </object>
    <object pk="291" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">291</field>
        <field type="TextField" name="code">var BB291 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    createFilter: function (item){
	var filter = {id: 'filterEbay', data:{keywords: item.data.title, maxEntries: 5, currentPage: 1}};
	this.manageData(["filterEbay"], [filter], []);
}
    
});
    </field>
        <field type="TextField" name="unboundCode">createFilter: function (item){
	var filter = {id: 'filterEbay', data:{keywords: item.data.title, maxEntries: 5, currentPage: 1}};
	this.manageData(["filterEbay"], [filter], []);
}</field>
    </object>
    <object pk="292" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">292</field>
        <field type="TextField" name="code">var BB292 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    fetch: function (filter){
	//URL of the Service
	var url = "http://open.api.ebay.com/shopping?";
	url += "&amp;callname=FindItemsAdvanced";
	url += "&amp;ItemSort=BestMatch";
	url += "&amp;version=515";
	url += "&amp;responseencoding=XML";
	url += "&amp;appid=eBayAPID-73f4-45f2-b9a3-c8f6388b38d8";
	url += "&amp;callback=true";
	url += "&amp;MaxEntries=" + filter.data.maxEntries;
	url += "&amp;PageNumber=" + filter.data.currentPage;
	url += "&amp;QueryKeywords=" + escape(filter.data.keywords.replace(/ /g,"+"));

	//Invoke the service
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    function (transport){this.addToList(transport, filter)}.bind(this)
    });
},

addToList: function (transport, filter){
	var eBayList = {id: 'list', data:{productList: new Array()}};
	var xml = transport;
    var items = xml.getElementsByTagName("Item");
    //Fill the table, 1 row per item
    $A(items).each(function(item){
         if (item.getElementsByTagName("ItemID").length &gt; 0) {
         	var itemID = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
         } else {
			var itemID = "&amp;nbsp;";
         }
         if (item.getElementsByTagName("Title").length &gt; 0) {
         	var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
		 } else {
			var title = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) {
         	var category = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
		 } else {
			var category = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("ConvertedCurrentPrice ").length &gt; 0) {
         	var currentPrice = '$' + item.getElementsByTagName("ConvertedCurrentPrice")[0].firstChild.nodeValue;
		 } else {
			var currentPrice = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) {
			var price = item.getElementsByTagName("ConvertedCurrentPrice")[0];
			var currency = price.getAttribute("currencyID");
			currentPrice = price.firstChild.nodeValue + " " + currency;
		 } else {
			var currentPrice = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("ShippingServiceCost").length &gt; 0) {
         	var shippingServiceCost = '$' + item.getElementsByTagName("ShippingServiceCost")[0].firstChild.nodeValue;
		 } else {
			var shippingServiceCost = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("GalleryURL").length &gt; 0) {
             var image = item.getElementsByTagName("GalleryURL")[0].firstChild.nodeValue;
		 } else {
         	var image = "";
		 }
		 var row = {
         	 itemID: itemID,
             title:  title.replace(/\x27/g,"`"),
             category: category,
             currentPrice: currentPrice,
             shippingServiceCost: shippingServiceCost,
             image: image
         };
         eBayList.data.productList.push(row);
     });
     if (xml.getElementsByTagName("TotalPages").length &gt; 0) {
        eBayList.data.totalPages = xml.getElementsByTagName("TotalPages")[0].firstChild.nodeValue;
     } else {
		eBayList.data.totalPages = 0;
     }
     if (xml.getElementsByTagName("PageNumber").length &gt; 0) {
         eBayList.data.currentPage = xml.getElementsByTagName("PageNumber")[0].firstChild.nodeValue;
     } else {
		eBayList.data.currentPage = 0;
     }
     eBayList.data.keywords = filter.data.keywords;
     eBayList.data.maxEntries = filter.data.maxEntries;
     this.manageData(["productList"], [eBayList], []);
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">fetch: function (filter){
	//URL of the Service
	var url = "http://open.api.ebay.com/shopping?";
	url += "&amp;callname=FindItemsAdvanced";
	url += "&amp;ItemSort=BestMatch";
	url += "&amp;version=515";
	url += "&amp;responseencoding=XML";
	url += "&amp;appid=eBayAPID-73f4-45f2-b9a3-c8f6388b38d8";
	url += "&amp;callback=true";
	url += "&amp;MaxEntries=" + filter.data.maxEntries;
	url += "&amp;PageNumber=" + filter.data.currentPage;
	url += "&amp;QueryKeywords=" + escape(filter.data.keywords.replace(/ /g,"+"));

	//Invoke the service
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    function (transport){this.addToList(transport, filter)}.bind(this)
    });
},

addToList: function (transport, filter){
	var eBayList = {id: 'list', data:{productList: new Array()}};
	var xml = transport;
    var items = xml.getElementsByTagName("Item");
    //Fill the table, 1 row per item
    $A(items).each(function(item){
         if (item.getElementsByTagName("ItemID").length &gt; 0) {
         	var itemID = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
         } else {
			var itemID = "&amp;nbsp;";
         }
         if (item.getElementsByTagName("Title").length &gt; 0) {
         	var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
		 } else {
			var title = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) {
         	var category = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
		 } else {
			var category = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("ConvertedCurrentPrice ").length &gt; 0) {
         	var currentPrice = '$' + item.getElementsByTagName("ConvertedCurrentPrice")[0].firstChild.nodeValue;
		 } else {
			var currentPrice = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) {
			var price = item.getElementsByTagName("ConvertedCurrentPrice")[0];
			var currency = price.getAttribute("currencyID");
			currentPrice = price.firstChild.nodeValue + " " + currency;
		 } else {
			var currentPrice = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("ShippingServiceCost").length &gt; 0) {
         	var shippingServiceCost = '$' + item.getElementsByTagName("ShippingServiceCost")[0].firstChild.nodeValue;
		 } else {
			var shippingServiceCost = "&amp;nbsp;";
		 }
		 if (item.getElementsByTagName("GalleryURL").length &gt; 0) {
             var image = item.getElementsByTagName("GalleryURL")[0].firstChild.nodeValue;
		 } else {
         	var image = "";
		 }
		 var row = {
         	 itemID: itemID,
             title:  title.replace(/\x27/g,"`"),
             category: category,
             currentPrice: currentPrice,
             shippingServiceCost: shippingServiceCost,
             image: image
         };
         eBayList.data.productList.push(row);
     });
     if (xml.getElementsByTagName("TotalPages").length &gt; 0) {
        eBayList.data.totalPages = xml.getElementsByTagName("TotalPages")[0].firstChild.nodeValue;
     } else {
		eBayList.data.totalPages = 0;
     }
     if (xml.getElementsByTagName("PageNumber").length &gt; 0) {
         eBayList.data.currentPage = xml.getElementsByTagName("PageNumber")[0].firstChild.nodeValue;
     } else {
		eBayList.data.currentPage = 0;
     }
     eBayList.data.keywords = filter.data.keywords;
     eBayList.data.maxEntries = filter.data.maxEntries;
     this.manageData(["productList"], [eBayList], []);
},

onError: function (transport){}</field>
    </object>
    <object pk="293" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">293</field>
        <field type="TextField" name="code">var BB293 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    addToCart: function (offer, cart){
	if (cart) {//If the cart is already created, it will have an ID in the User Fact
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartAdd";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		url += "&amp;Item.1.OfferListingId=" + offer.data.offerId;
		url += "&amp;Item.1.Quantity=" + 1;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.productAdded.bind(this)
        });
	} else { //Cart doesn't exist: Create a new cart with the product
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartCreate";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;Item.1.OfferListingId=" + offer.data.offerId;
		url += "&amp;Item.1.Quantity=" + 1;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.cartCreated.bind(this)
        });
	}
},

cartCreated: function (transport){
	var xml = transport;
	//The product is added to the cart,
	//tell it to the user
	if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
		//Check if the product is eligible for shopping
		if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
			xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
			//The product is not elegible
			var message = {id: "message", data:{message: "The product is not eligible to be added to the cart"}};
			this.manageData(["message"], [message], []);
			return;
		}
		//Add the Cart ID to the KB
		var message = {id: "message", data:{message: "Product added to the shopping Cart"}};
		var cart = {id: 'cart',
					data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
					HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
		this.manageData(["message"], [cart, message], []);
	} else {
		var message = {id: "message", data:{message: "Error adding the product to the cart"}};
		this.manageData(["message"], [message], []);
    }
},

productAdded: function (transport){
	var xml = transport;
	var message = {id: "message", data:{message: ""}};
	
	//Check if the product is eligible for shopping
	if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
		xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
		//The product is not elegible
		message.data.message = "The product is not eligible to be added to the cart";
	} else {
		//If the product is added to the cart,
		//tell it to the user
		if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
			message.data.message = "Product added to the shopping Cart";
		} else {
			message.data.message = "Error adding the product to the cart";
		}
	}
	this.manageData(["message"], [message], []);
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">addToCart: function (offer, cart){
	if (cart) {//If the cart is already created, it will have an ID in the User Fact
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartAdd";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		url += "&amp;Item.1.OfferListingId=" + offer.data.offerId;
		url += "&amp;Item.1.Quantity=" + 1;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.productAdded.bind(this)
        });
	} else { //Cart doesn't exist: Create a new cart with the product
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartCreate";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;Item.1.OfferListingId=" + offer.data.offerId;
		url += "&amp;Item.1.Quantity=" + 1;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.cartCreated.bind(this)
        });
	}
},

cartCreated: function (transport){
	var xml = transport;
	//The product is added to the cart,
	//tell it to the user
	if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
		//Check if the product is eligible for shopping
		if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
			xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
			//The product is not elegible
			var message = {id: "message", data:{message: "The product is not eligible to be added to the cart"}};
			this.manageData(["message"], [message], []);
			return;
		}
		//Add the Cart ID to the KB
		var message = {id: "message", data:{message: "Product added to the shopping Cart"}};
		var cart = {id: 'cart',
					data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
					HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
		this.manageData(["message"], [cart, message], []);
	} else {
		var message = {id: "message", data:{message: "Error adding the product to the cart"}};
		this.manageData(["message"], [message], []);
    }
},

productAdded: function (transport){
	var xml = transport;
	var message = {id: "message", data:{message: ""}};
	
	//Check if the product is eligible for shopping
	if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
		xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
		//The product is not elegible
		message.data.message = "The product is not eligible to be added to the cart";
	} else {
		//If the product is added to the cart,
		//tell it to the user
		if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
			message.data.message = "Product added to the shopping Cart";
		} else {
			message.data.message = "Error adding the product to the cart";
		}
	}
	this.manageData(["message"], [message], []);
},

onError: function (transport){}</field>
    </object>
    <object pk="294" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">294</field>
        <field type="TextField" name="code">var BB294 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    clearService: function (cart){
	//Ask the user to confirm the operation
	if (confirm("Are you sure you want to empty your Shopping Cart?")) {
		//Create the call
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the AccessKeyId (get from the user fact)
		//Add the operation Type
		url +="&amp;Operation=CartClear";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service 	
       	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.clear.bind(this)
        });
	}	
},

clear: function (){
	this.manageData(["cartCleared"], [],["purchase"]);	
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">clearService: function (cart){
	//Ask the user to confirm the operation
	if (confirm("Are you sure you want to empty your Shopping Cart?")) {
		//Create the call
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the AccessKeyId (get from the user fact)
		//Add the operation Type
		url +="&amp;Operation=CartClear";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service 	
       	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.clear.bind(this)
        });
	}	
},

clear: function (){
	this.manageData(["cartCleared"], [],["purchase"]);	
},

onError: function (transport){}</field>
    </object>
    <object pk="295" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">295</field>
        <field type="TextField" name="code">var BB295 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    add: function (item, cart){
	if (cart) {//If the cart is already created, it will have an ID in the User Fact
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartGet";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    function(transport){this.isProductOnCart(transport, item, cart);}.bind(this)
        });
	} else { //Cart doesn't exist: Create a new cart with the product
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartCreate";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;Item.1.ASIN=" + item.data.ASIN;
		url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    function(transport){this.cartCreated(transport, item);}.bind(this)
        });
	}
},

cartCreated: function (transport, item){
	var xml = transport;

	var message = {id: 'message', data:{message: ""}};
	
	//The product is added to the cart,
	//tell it to the user	
	if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
		//Check if the product is eligible for shopping
		if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
			xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart") {
			//The product is not elegible
			message.data.message = "The product is not eligible to be added to the cartt";
			this.manageData(["message"], [message], []);
			return;
		}
		//Add the Cart ID to the KB
		var cart = {id: 'cart',
					data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
					HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
		message.data.message = "Product added to the shopping Cart";
		this.manageData(["message"], [cart, message], []);
	} else {
		message.data.message = "Error adding the product to the cart";
		this.manageData(["message"], [message], []);
	}
},

isProductOnCart: function (transport, item, cart){
	var xml = transport;
	//products node
	if (xml.getElementsByTagName ("CartItems").length&gt;0) { //There are products on the cart
			var products = xml.getElementsByTagName ("CartItems")[0];
			//Product list (ASINs) added to the cart
			var asins = $A(products.getElementsByTagName ("ASIN"));
			//Check if the product is already added to the cart
			var found = false;
			//product Node
			var _product; 
			asins.each (function(asin){
				if (asin.firstChild.nodeValue == item.ASIN) {
					found = true; //The product is in the list
					_product = asin.parentNode; //product = CartItem
				}
			});
	} else {//If there aren't elements, the product will not be on the list
		found = false;
	}
	if (found) { 
		//If the product is already added to the cart,
		//increase the number of items of that product (CartModify)			
		//Get the item quantity
		var prevQuantity = _product.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
		//Add the new quantity to the previously stored
		var quantity = parseInt($F("quantitySelect")) + parseInt (prevQuantity);
		
		//Get the product Id within the cart
		var productId = _product.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;	

		//Create the call
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartModify";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		url += "&amp;Item.1.CartItemId=" + productId;
		url += "&amp;Item.1.Quantity=" + quantity;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.productAdded.bind(this)
        });
	} else {
        //Create the call
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartAdd";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		url += "&amp;Item.1.ASIN=" + item.data.ASIN;
		url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.productAdded.bind(this)
        });
	}
},

productAdded: function (transport){
	var xml = transport;
	var message = {id: 'message', data:{message: ""}};
	//Check if the product is eligible for shopping
	if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
		xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart") {
		//The product is not elegible
		message.data.message = "The product is not eligible to be added to the cart";
	} else {
		//If the product is added to the cart,
		//tell it to the user	
		if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
			message.data.message = "Product added to the shopping Cart";
		} else { 
			message.data.message = "Error adding the product to the cart";
		}
	}
	this.manageData(["message"], [message], []);
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">add: function (item, cart){
	if (cart) {//If the cart is already created, it will have an ID in the User Fact
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartGet";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    function(transport){this.isProductOnCart(transport, item, cart);}.bind(this)
        });
	} else { //Cart doesn't exist: Create a new cart with the product
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartCreate";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;Item.1.ASIN=" + item.data.ASIN;
		url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    function(transport){this.cartCreated(transport, item);}.bind(this)
        });
	}
},

cartCreated: function (transport, item){
	var xml = transport;

	var message = {id: 'message', data:{message: ""}};
	
	//The product is added to the cart,
	//tell it to the user	
	if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
		//Check if the product is eligible for shopping
		if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
			xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart") {
			//The product is not elegible
			message.data.message = "The product is not eligible to be added to the cartt";
			this.manageData(["message"], [message], []);
			return;
		}
		//Add the Cart ID to the KB
		var cart = {id: 'cart',
					data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
					HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
		message.data.message = "Product added to the shopping Cart";
		this.manageData(["message"], [cart, message], []);
	} else {
		message.data.message = "Error adding the product to the cart";
		this.manageData(["message"], [message], []);
	}
},

isProductOnCart: function (transport, item, cart){
	var xml = transport;
	//products node
	if (xml.getElementsByTagName ("CartItems").length&gt;0) { //There are products on the cart
			var products = xml.getElementsByTagName ("CartItems")[0];
			//Product list (ASINs) added to the cart
			var asins = $A(products.getElementsByTagName ("ASIN"));
			//Check if the product is already added to the cart
			var found = false;
			//product Node
			var _product; 
			asins.each (function(asin){
				if (asin.firstChild.nodeValue == item.ASIN) {
					found = true; //The product is in the list
					_product = asin.parentNode; //product = CartItem
				}
			});
	} else {//If there aren't elements, the product will not be on the list
		found = false;
	}
	if (found) { 
		//If the product is already added to the cart,
		//increase the number of items of that product (CartModify)			
		//Get the item quantity
		var prevQuantity = _product.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
		//Add the new quantity to the previously stored
		var quantity = parseInt($F("quantitySelect")) + parseInt (prevQuantity);
		
		//Get the product Id within the cart
		var productId = _product.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;	

		//Create the call
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartModify";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		url += "&amp;Item.1.CartItemId=" + productId;
		url += "&amp;Item.1.Quantity=" + quantity;
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.productAdded.bind(this)
        });
	} else {
        //Create the call
		var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
		//Add the operation Type
		url +="&amp;Operation=CartAdd";
		//Add the current version of the API
		url += "&amp;Version=2008-06-26";
		//Add item ID
		url += "&amp;CartId=" + cart.data.id;
		url += "&amp;HMAC=" + cart.data.HMAC;
		url += "&amp;Item.1.ASIN=" + item.data.ASIN;
		url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
		
		var encoder = new URLAmazonEncoder();
		url = encoder.encode(url);
		
		//Invoke the service
    	new FastAPI.Request(url,{
            'method':       'get',
            'content':      'xml',
            'context':      this,
            'onSuccess':    this.productAdded.bind(this)
        });
	}
},

productAdded: function (transport){
	var xml = transport;
	var message = {id: 'message', data:{message: ""}};
	//Check if the product is eligible for shopping
	if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
		xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart") {
		//The product is not elegible
		message.data.message = "The product is not eligible to be added to the cart";
	} else {
		//If the product is added to the cart,
		//tell it to the user	
		if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True") {
			message.data.message = "Product added to the shopping Cart";
		} else { 
			message.data.message = "Error adding the product to the cart";
		}
	}
	this.manageData(["message"], [message], []);
},

onError: function (transport){}</field>
    </object>
    <object pk="296" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">296</field>
        <field type="TextField" name="code">var BB296 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    search: function (filter){
	//Add the ItemSearch parameters
    var productType = filter.data.productType;
    if (!productType) {
        productType = 'All'
    }
    if (!filter.data.currentPage) {
    	filter.data.currentPage = 1;
    }
    var parameters = "";
    parameters += "&amp;SearchIndex=" + productType;
    parameters += "&amp;Keywords=" + encodeURIComponent(filter.data.searchText);
    //Add the page number (if is set)
    parameters += "&amp;ItemPage=" + (filter.data.currentPage);
    //Base URL of the REST Service
    var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
    //Add the operation Type
    url +="&amp;Operation=ItemSearch";
    //Add the parameters
    url += parameters;
    //Add the responseGroup
    url +="&amp;ResponseGroup=Medium";
    //Add the current version of the API
    url += "&amp;Version=2008-06-26";
    
    var encoder = new URLAmazonEncoder();
    encodedUrl = encoder.encode(url);
    
    //Invoke the service
    new FastAPI.Request(encodedUrl,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: 'list', data: {productList: new Array(), currentPage: 1, totalResults: 0, totalPages: 0}};
	var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
        var message = {id: 'message', data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
        this.manageData(["message"], [message],[]);
    } else {
        //Correct response, create the result List
        var _list = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
        //Fill the table, 1 row per item
        $A(_list).each(function(item){
            if (item.getElementsByTagName("Title").length &gt; 0) {
                var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
            } else {
                var title = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
                var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
            } else {
                var price = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
                var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
            } else {
                var pGroup = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ASIN").length &gt; 0) {
                var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
            }
            var row = {
                title: title,
                price: price,
                pGroup: pGroup,
                ASIN: ASIN
            };
            l.data.productList.push(row);
        });
        
        l.data.totalPages = parseInt(xml.getElementsByTagName("TotalPages")[0].firstChild.nodeValue);
        l.data.totalResults = parseInt(xml.getElementsByTagName("TotalResults")[0].firstChild.nodeValue);
        if (l.data.totalPages &lt; 0) {
        	l.data.totalPages = 0;
        }
        l.data.currentPage = parseInt(xml.getElementsByTagName("ItemPage")[0].childNodes[0].nodeValue);
        l.data.searchText = xml.getElementsByTagName("Keywords")[0].childNodes[0].nodeValue;
        l.data.productType = xml.getElementsByTagName("SearchIndex")[0].childNodes[0].nodeValue;
        this.manageData(["itemList"], [l], []);
    }
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">search: function (filter){
	//Add the ItemSearch parameters
    var productType = filter.data.productType;
    if (!productType) {
        productType = 'All'
    }
    if (!filter.data.currentPage) {
    	filter.data.currentPage = 1;
    }
    var parameters = "";
    parameters += "&amp;SearchIndex=" + productType;
    parameters += "&amp;Keywords=" + encodeURIComponent(filter.data.searchText);
    //Add the page number (if is set)
    parameters += "&amp;ItemPage=" + (filter.data.currentPage);
    //Base URL of the REST Service
    var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
    //Add the operation Type
    url +="&amp;Operation=ItemSearch";
    //Add the parameters
    url += parameters;
    //Add the responseGroup
    url +="&amp;ResponseGroup=Medium";
    //Add the current version of the API
    url += "&amp;Version=2008-06-26";
    
    var encoder = new URLAmazonEncoder();
    encodedUrl = encoder.encode(url);
    
    //Invoke the service
    new FastAPI.Request(encodedUrl,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: 'list', data: {productList: new Array(), currentPage: 1, totalResults: 0, totalPages: 0}};
	var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
        var message = {id: 'message', data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
        this.manageData(["message"], [message],[]);
    } else {
        //Correct response, create the result List
        var _list = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
        //Fill the table, 1 row per item
        $A(_list).each(function(item){
            if (item.getElementsByTagName("Title").length &gt; 0) {
                var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
            } else {
                var title = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
                var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
            } else {
                var price = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
                var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
            } else {
                var pGroup = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ASIN").length &gt; 0) {
                var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
            }
            var row = {
                title: title,
                price: price,
                pGroup: pGroup,
                ASIN: ASIN
            };
            l.data.productList.push(row);
        });
        
        l.data.totalPages = parseInt(xml.getElementsByTagName("TotalPages")[0].firstChild.nodeValue);
        l.data.totalResults = parseInt(xml.getElementsByTagName("TotalResults")[0].firstChild.nodeValue);
        if (l.data.totalPages &lt; 0) {
        	l.data.totalPages = 0;
        }
        l.data.currentPage = parseInt(xml.getElementsByTagName("ItemPage")[0].childNodes[0].nodeValue);
        l.data.searchText = xml.getElementsByTagName("Keywords")[0].childNodes[0].nodeValue;
        l.data.productType = xml.getElementsByTagName("SearchIndex")[0].childNodes[0].nodeValue;
        this.manageData(["itemList"], [l], []);
    }
},

onError: function (transport){}</field>
    </object>
    <object pk="297" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">297</field>
        <field type="TextField" name="code">var BB297 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    searchProduct: function (item){
	//Base URL of the REST Service
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=ItemLookup";
	//Add the responseGroup
	url +="&amp;ResponseGroup=Medium";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	//Add item ID
	url += "&amp;ItemId=" + item.data.ASIN;
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	//Invoke the service
	new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.fetchProductInfo.bind(this)
    });
},

fetchProductInfo: function (transport){
	var xml = transport;
	var item = xml.getElementsByTagName("Item")[0];
	if (item.getElementsByTagName("Title").length &gt; 0) {
		var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
        var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
        var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
	}
    if (item.getElementsByTagName("DetailPageURL").length &gt; 0) {
        var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
    }
    if (item.getElementsByTagName("MediumImage").length &gt; 0) {
        var image = item.getElementsByTagName("MediumImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
    }
    var _product = {
		id: "product",
		data:{title: title,
			price: price,
			item: item,
			pGroup: pGroup,
			url: url,
			image: image}
	};

    this.manageData(["newProduct"], [_product], []);	
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">searchProduct: function (item){
	//Base URL of the REST Service
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=ItemLookup";
	//Add the responseGroup
	url +="&amp;ResponseGroup=Medium";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	//Add item ID
	url += "&amp;ItemId=" + item.data.ASIN;
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	//Invoke the service
	new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.fetchProductInfo.bind(this)
    });
},

fetchProductInfo: function (transport){
	var xml = transport;
	var item = xml.getElementsByTagName("Item")[0];
	if (item.getElementsByTagName("Title").length &gt; 0) {
		var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
        var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
        var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
	}
    if (item.getElementsByTagName("DetailPageURL").length &gt; 0) {
        var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
    }
    if (item.getElementsByTagName("MediumImage").length &gt; 0) {
        var image = item.getElementsByTagName("MediumImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
    }
    var _product = {
		id: "product",
		data:{title: title,
			price: price,
			item: item,
			pGroup: pGroup,
			url: url,
			image: image}
	};

    this.manageData(["newProduct"], [_product], []);	
},

onError: function (transport){}</field>
    </object>
    <object pk="298" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">298</field>
        <field type="TextField" name="code">var BB298 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    fetch: function (cart){
    //Get the facts to invoke the service
    //TODO add error handling
    //Invoke the service CartGet to retrieve the product list
    var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=CartGet";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	//Add item ID
	url += "&amp;CartId=" + cart.data.id;
	url += "&amp;HMAC=" + cart.data.HMAC;
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);
	
	//Create the call
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: "list", data:{productList: new Array(), subTotal: 0, itemTotal: 0, purchaseURL: null}};
    var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
    	var message = {id: "message", data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
    	this.manageData(null, [message], []);
    } else { //Correct response, create the result List
    	if (xml.getElementsByTagName("CartItems").length &gt; 0) { //There are products in the cart
			var list = xml.getElementsByTagName("CartItems")[0].getElementsByTagName("CartItem");
			//Fill the table, 1 row per item
			$A(list).each(function(item){
				if (item.getElementsByTagName("Title").length &gt; 0) {
					var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("ASIN").length &gt; 0) {
					var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("CartItemId").length &gt; 0) {
					var ID = item.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("Price").length &gt; 0) {
					var price = item.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("Quantity").length &gt; 0) {
					var quantity = item.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
				}
				var row = {
					title: title,
					price: price,
					ASIN: ASIN,
					id: ID,
					quantity: quantity
				};
				l.data.itemTotal += parseInt (quantity);
				l.data.productList.push(row);
			});
		}
		if (xml.getElementsByTagName("SubTotal").length&gt;0) {
			l.data.subTotal = xml.getElementsByTagName("SubTotal")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
		} else {
			l.data.subTotal = "$0.0";
		}
		if (xml.getElementsByTagName("PurchaseURL").length&gt;0) {
			l.data.purchaseURL = xml.getElementsByTagName("PurchaseURL")[0].firstChild.nodeValue;
		}
		this.manageData(["list"], [l], []);
    }
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">fetch: function (cart){
    //Get the facts to invoke the service
    //TODO add error handling
    //Invoke the service CartGet to retrieve the product list
    var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=CartGet";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	//Add item ID
	url += "&amp;CartId=" + cart.data.id;
	url += "&amp;HMAC=" + cart.data.HMAC;
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);
	
	//Create the call
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: "list", data:{productList: new Array(), subTotal: 0, itemTotal: 0, purchaseURL: null}};
    var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
    	var message = {id: "message", data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
    	this.manageData(null, [message], []);
    } else { //Correct response, create the result List
    	if (xml.getElementsByTagName("CartItems").length &gt; 0) { //There are products in the cart
			var list = xml.getElementsByTagName("CartItems")[0].getElementsByTagName("CartItem");
			//Fill the table, 1 row per item
			$A(list).each(function(item){
				if (item.getElementsByTagName("Title").length &gt; 0) {
					var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("ASIN").length &gt; 0) {
					var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("CartItemId").length &gt; 0) {
					var ID = item.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("Price").length &gt; 0) {
					var price = item.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
				}
				if (item.getElementsByTagName("Quantity").length &gt; 0) {
					var quantity = item.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
				}
				var row = {
					title: title,
					price: price,
					ASIN: ASIN,
					id: ID,
					quantity: quantity
				};
				l.data.itemTotal += parseInt (quantity);
				l.data.productList.push(row);
			});
		}
		if (xml.getElementsByTagName("SubTotal").length&gt;0) {
			l.data.subTotal = xml.getElementsByTagName("SubTotal")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
		} else {
			l.data.subTotal = "$0.0";
		}
		if (xml.getElementsByTagName("PurchaseURL").length&gt;0) {
			l.data.purchaseURL = xml.getElementsByTagName("PurchaseURL")[0].firstChild.nodeValue;
		}
		this.manageData(["list"], [l], []);
    }
},

onError: function (transport){}</field>
    </object>
    <object pk="299" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">299</field>
        <field type="TextField" name="code">var BB299 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    updateService: function (cart, update){
	//Create the call
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=CartModify";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	//Add item ID
	url += "&amp;CartId=" + cart.data.id;
	url += "&amp;HMAC=" + cart.data.HMAC;
	//Build the parameter list
	for (var i=0; i &lt; update.data.list.length; i++){
		url += "&amp;Item." + (i+1) + ".CartItemId=" + update.data.list[i]["id"];
		url += "&amp;Item." + (i+1) + ".Quantity=" + update.data.list[i]["quantity"];
	}
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);
	
	//Create the call
   	new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.update.bind(this)
    });
},

update: function (){
	this.manageData(["cartUpdated"], [],["purchase"]);
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">updateService: function (cart, update){
	//Create the call
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=CartModify";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	//Add item ID
	url += "&amp;CartId=" + cart.data.id;
	url += "&amp;HMAC=" + cart.data.HMAC;
	//Build the parameter list
	for (var i=0; i &lt; update.data.list.length; i++){
		url += "&amp;Item." + (i+1) + ".CartItemId=" + update.data.list[i]["id"];
		url += "&amp;Item." + (i+1) + ".Quantity=" + update.data.list[i]["quantity"];
	}
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);
	
	//Create the call
   	new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.update.bind(this)
    });
},

update: function (){
	this.manageData(["cartUpdated"], [],["purchase"]);
},

onError: function (transport){}</field>
    </object>
    <object pk="300" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">300</field>
        <field type="TextField" name="code">var BB300 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    fetch: function (item){
	//Get the facts to invoke the service
    //Add the ItemSearch parameters
    var parameters = "";
	parameters += "&amp;ItemId=" + item.data.ASIN;
	parameters += "&amp;MerchantId=All&amp;Condition=All";
    
	//Base URL of the REST Service
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=ItemLookup";
	//Add the parameters
	url += parameters;
	//Add the responseGroup
	url +="&amp;ResponseGroup=OfferFull";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	//Invoke the service
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: 'list', data:{productList: new Array(), currentPage: 0}};
    var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
    	var message = {id: "message", data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
    	this.manageData(["message"], [message], []);
    } else { //Correct response, create the result List
        var comparativelist = xml.getElementsByTagName("Offers")[0].getElementsByTagName("Offer");
        //Fill the table, 1 row per item
        for(var i=0; i &lt; comparativelist.length; i++){
            var offer = comparativelist[i];
            if (offer.getElementsByTagName("Name").length &gt; 0) { 
                var sellerName = offer.getElementsByTagName("Name")[0].firstChild.nodeValue;
            } else {
				if (offer.getElementsByTagName("Nickname").length &gt; 0) {
			    	var sellerName = offer.getElementsByTagName("Nickname")[0].firstChild.nodeValue;
				} else {
					var sellerName = "&amp;nbsp;";
				}
            }
            if (offer.getElementsByTagName("SellerId").length &gt; 0) {
                var sellerId = offer.getElementsByTagName("SellerId")[0].firstChild.nodeValue;
            } else {
			    var sellerId = "none";
            }
            if (offer.getElementsByTagName("AverageFeedbackRating").length &gt; 0) { 
                var averageRating = offer.getElementsByTagName("AverageFeedbackRating")[0].firstChild.nodeValue;
            } else {
			    var averageRating = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("TotalFeedback").length &gt; 0) { 
                var totalFeedback = offer.getElementsByTagName("TotalFeedback")[0].firstChild.nodeValue;
            } else {
			    var totalFeedback = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("Condition").length &gt; 0) {
				var condition = offer.getElementsByTagName("Condition")[0].firstChild.nodeValue;             
            } else {
			    var condition = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("ConditionNote").length &gt; 0) {
				var conditionNote = "(" + offer.getElementsByTagName("ConditionNote")[0].firstChild.nodeValue + ")";             
            } else {
			    var conditionNote = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("OfferListingId").length &gt; 0) {
				var offerId = offer.getElementsByTagName("OfferListingId")[0].firstChild.nodeValue;             
            } else {
			    var offerId = "";
            }
            if (offer.getElementsByTagName("Price").length &gt; 0) {
				var price = offer.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
            } else {
			    var price = "";
            }
            if (offer.getElementsByTagName("AmountSaved").length &gt; 0) {
				var amountSaved = offer.getElementsByTagName("AmountSaved")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
            } else {
			    var amountSaved = "";
            }
            if (offer.getElementsByTagName("PercentageSaved").length &gt; 0) {
				var percentageSaved = offer.getElementsByTagName("PercentageSaved")[0].firstChild.nodeValue;             
            } else {
			    var percentageSaved = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("Availability").length &gt; 0) {
				var availability = offer.getElementsByTagName("Availability")[0].firstChild.nodeValue;
            } else {
			    var availability = "&amp;nbsp;";
            }
            var row = {
                sellerName: sellerName,
                sellerId: sellerId,
                location: location,
                averageRating: averageRating,
				totalFeedback: totalFeedback,
				condition: condition,
				conditionNote: conditionNote,
				offerId: offerId,
				price: price,
				amountSaved: amountSaved,
				percentageSaved: percentageSaved,
				availability: availability
            };
            l.data.productList.push(row);
	    }
        this.manageData(["productList"], [l], []);
    }
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">fetch: function (item){
	//Get the facts to invoke the service
    //Add the ItemSearch parameters
    var parameters = "";
	parameters += "&amp;ItemId=" + item.data.ASIN;
	parameters += "&amp;MerchantId=All&amp;Condition=All";
    
	//Base URL of the REST Service
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=ItemLookup";
	//Add the parameters
	url += parameters;
	//Add the responseGroup
	url +="&amp;ResponseGroup=OfferFull";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	//Invoke the service
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: 'list', data:{productList: new Array(), currentPage: 0}};
    var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
    	var message = {id: "message", data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
    	this.manageData(["message"], [message], []);
    } else { //Correct response, create the result List
        var comparativelist = xml.getElementsByTagName("Offers")[0].getElementsByTagName("Offer");
        //Fill the table, 1 row per item
        for(var i=0; i &lt; comparativelist.length; i++){
            var offer = comparativelist[i];
            if (offer.getElementsByTagName("Name").length &gt; 0) { 
                var sellerName = offer.getElementsByTagName("Name")[0].firstChild.nodeValue;
            } else {
				if (offer.getElementsByTagName("Nickname").length &gt; 0) {
			    	var sellerName = offer.getElementsByTagName("Nickname")[0].firstChild.nodeValue;
				} else {
					var sellerName = "&amp;nbsp;";
				}
            }
            if (offer.getElementsByTagName("SellerId").length &gt; 0) {
                var sellerId = offer.getElementsByTagName("SellerId")[0].firstChild.nodeValue;
            } else {
			    var sellerId = "none";
            }
            if (offer.getElementsByTagName("AverageFeedbackRating").length &gt; 0) { 
                var averageRating = offer.getElementsByTagName("AverageFeedbackRating")[0].firstChild.nodeValue;
            } else {
			    var averageRating = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("TotalFeedback").length &gt; 0) { 
                var totalFeedback = offer.getElementsByTagName("TotalFeedback")[0].firstChild.nodeValue;
            } else {
			    var totalFeedback = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("Condition").length &gt; 0) {
				var condition = offer.getElementsByTagName("Condition")[0].firstChild.nodeValue;             
            } else {
			    var condition = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("ConditionNote").length &gt; 0) {
				var conditionNote = "(" + offer.getElementsByTagName("ConditionNote")[0].firstChild.nodeValue + ")";             
            } else {
			    var conditionNote = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("OfferListingId").length &gt; 0) {
				var offerId = offer.getElementsByTagName("OfferListingId")[0].firstChild.nodeValue;             
            } else {
			    var offerId = "";
            }
            if (offer.getElementsByTagName("Price").length &gt; 0) {
				var price = offer.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
            } else {
			    var price = "";
            }
            if (offer.getElementsByTagName("AmountSaved").length &gt; 0) {
				var amountSaved = offer.getElementsByTagName("AmountSaved")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
            } else {
			    var amountSaved = "";
            }
            if (offer.getElementsByTagName("PercentageSaved").length &gt; 0) {
				var percentageSaved = offer.getElementsByTagName("PercentageSaved")[0].firstChild.nodeValue;             
            } else {
			    var percentageSaved = "&amp;nbsp;";
            }
            if (offer.getElementsByTagName("Availability").length &gt; 0) {
				var availability = offer.getElementsByTagName("Availability")[0].firstChild.nodeValue;
            } else {
			    var availability = "&amp;nbsp;";
            }
            var row = {
                sellerName: sellerName,
                sellerId: sellerId,
                location: location,
                averageRating: averageRating,
				totalFeedback: totalFeedback,
				condition: condition,
				conditionNote: conditionNote,
				offerId: offerId,
				price: price,
				amountSaved: amountSaved,
				percentageSaved: percentageSaved,
				availability: availability
            };
            l.data.productList.push(row);
	    }
        this.manageData(["productList"], [l], []);
    }
},

onError: function (transport){}</field>
    </object>
    <object pk="301" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">301</field>
        <field type="TextField" name="code">var BB301 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    fetch: function (item){
	//Add the ItemSearch parameters
    var parameters = "";
	parameters += "&amp;ItemId=" + item.data.ASIN;
    
    //Base URL of the REST Service
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=SimilarityLookup";
	//Add the parameters
	url += parameters;
	//Add the responseGroup
	url +="&amp;ResponseGroup=Medium";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	//Invoke the service
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var suggestionList = {id: 'list', data:{productList: new Array(), currentPage: 0}};
    var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
    	var message = {id: "message", data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
    	this.manageData(["message"], [message], []);
    }
    else { //Correct response, create the result List
        var suggestionlist = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
        //Fill the table, 1 row per item
        for(var i=0; i &lt; suggestionlist.length;i++){
            var item = suggestionlist[i];
            if (item.getElementsByTagName("Title").length &gt; 0) {
                var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
            } else {
			    var title = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
                var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
            } else {
			    var price = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
                var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
            } else {
			    var pGroup = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ASIN").length &gt; 0) { 
                var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
            }
            var row = {
                title: title,
                price: price,
                pGroup: pGroup,
                ASIN: ASIN
            };
            suggestionList.data.productList.push(row);
        }
        this.manageData(["suggestionList"], [suggestionList], []);
    }
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">fetch: function (item){
	//Add the ItemSearch parameters
    var parameters = "";
	parameters += "&amp;ItemId=" + item.data.ASIN;
    
    //Base URL of the REST Service
	var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
	//Add the operation Type
	url +="&amp;Operation=SimilarityLookup";
	//Add the parameters
	url += parameters;
	//Add the responseGroup
	url +="&amp;ResponseGroup=Medium";
	//Add the current version of the API
	url += "&amp;Version=2008-06-26";
	
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	//Invoke the service
    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var suggestionList = {id: 'list', data:{productList: new Array(), currentPage: 0}};
    var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
    	var message = {id: "message", data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
    	this.manageData(["message"], [message], []);
    }
    else { //Correct response, create the result List
        var suggestionlist = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
        //Fill the table, 1 row per item
        for(var i=0; i &lt; suggestionlist.length;i++){
            var item = suggestionlist[i];
            if (item.getElementsByTagName("Title").length &gt; 0) {
                var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
            } else {
			    var title = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
                var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
            } else {
			    var price = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
                var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
            } else {
			    var pGroup = "&amp;nbsp;";
            }
            if (item.getElementsByTagName("ASIN").length &gt; 0) { 
                var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
            }
            var row = {
                title: title,
                price: price,
                pGroup: pGroup,
                ASIN: ASIN
            };
            suggestionList.data.productList.push(row);
        }
        this.manageData(["suggestionList"], [suggestionList], []);
    }
},

onError: function (transport){}</field>
    </object>
    <object pk="302" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">302</field>
        <field type="TextField" name="code">var BB302 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    search: function (item){
	var parameters = {
			'callname': 'GetSingleItem',
			'version': '515',
			'responseencoding': 'XML',
			'appid': 'eBayAPID-73f4-45f2-b9a3-c8f6388b38d8',
			'callback': 'true',
			'ItemID': item.data.id
	};
	
	var url = 'http://open.api.ebay.com/shopping?' + Object.toQueryString(parameters);

    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.createItem.bind(this)
    });
},

createItem: function (transport){
	var it = {id: 'item', data: {'source': 'eBay', 'details':{}}};
	var item = transport.getElementsByTagName("Item")[0];
	if (item.getElementsByTagName("ItemID").length &gt; 0) {
		it.data.id = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Title").length &gt; 0) {
		it.data.title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) {
		it.data.type = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) {
		var price = item.getElementsByTagName("ConvertedCurrentPrice")[0];
		var currency = price.getAttribute("currencyID");
		it.data.currentPrice = price.firstChild.nodeValue + " " + currency;
	}
	if (item.getElementsByTagName("PictureURL").length &gt; 0) {
		it.data.image = item.getElementsByTagName("PictureURL")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ViewItemURLForNaturalSearch").length &gt; 0) {
		it.data.url = item.getElementsByTagName("ViewItemURLForNaturalSearch")[0].firstChild.nodeValue;
	}
	
	if (item.getElementsByTagName("ShippingServiceCost").length &gt; 0) {
		it.data.details.shipping = item.getElementsByTagName("ShippingServiceCost")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Location").length &gt; 0) {
		it.data.details.location = item.getElementsByTagName("Location")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("BidCount").length &gt; 0) {
		it.data.details.bidcount = item.getElementsByTagName("BidCount")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("FeedbackScore").length &gt; 0) {
		it.data.details.feedbackscore = item.getElementsByTagName("FeedbackScore")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Quantity").length &gt; 0) {
		it.data.details.quantity = item.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
	}
	this.manageData(["newItem"], [it], []);
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">search: function (item){
	var parameters = {
			'callname': 'GetSingleItem',
			'version': '515',
			'responseencoding': 'XML',
			'appid': 'eBayAPID-73f4-45f2-b9a3-c8f6388b38d8',
			'callback': 'true',
			'ItemID': item.data.id
	};
	
	var url = 'http://open.api.ebay.com/shopping?' + Object.toQueryString(parameters);

    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.createItem.bind(this)
    });
},

createItem: function (transport){
	var it = {id: 'item', data: {'source': 'eBay', 'details':{}}};
	var item = transport.getElementsByTagName("Item")[0];
	if (item.getElementsByTagName("ItemID").length &gt; 0) {
		it.data.id = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Title").length &gt; 0) {
		it.data.title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) {
		it.data.type = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) {
		var price = item.getElementsByTagName("ConvertedCurrentPrice")[0];
		var currency = price.getAttribute("currencyID");
		it.data.currentPrice = price.firstChild.nodeValue + " " + currency;
	}
	if (item.getElementsByTagName("PictureURL").length &gt; 0) {
		it.data.image = item.getElementsByTagName("PictureURL")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ViewItemURLForNaturalSearch").length &gt; 0) {
		it.data.url = item.getElementsByTagName("ViewItemURLForNaturalSearch")[0].firstChild.nodeValue;
	}
	
	if (item.getElementsByTagName("ShippingServiceCost").length &gt; 0) {
		it.data.details.shipping = item.getElementsByTagName("ShippingServiceCost")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Location").length &gt; 0) {
		it.data.details.location = item.getElementsByTagName("Location")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("BidCount").length &gt; 0) {
		it.data.details.bidcount = item.getElementsByTagName("BidCount")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("FeedbackScore").length &gt; 0) {
		it.data.details.feedbackscore = item.getElementsByTagName("FeedbackScore")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Quantity").length &gt; 0) {
		it.data.details.quantity = item.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
	}
	this.manageData(["newItem"], [it], []);
},

onError: function (transport){}</field>
    </object>
    <object pk="303" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">303</field>
        <field type="TextField" name="code">var BB303 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    search: function (filter){
	
	var pageNumber = (filter.data.pageNumber)? filter.data.pageNumber : 1;
	
	var parameters = {
			'callname': 'FindItemsAdvanced',
			'ItemSort': 'BestMatch',
			'version': '515',
			'responseencoding': 'XML',
			'appid': 'eBayAPID-73f4-45f2-b9a3-c8f6388b38d8',
			'callback': 'true',
			'MaxEntries': '10',
			'PageNumber': pageNumber,
			'QueryKeywords': filter.data.keywords
	};
	
	var url = 'http://open.api.ebay.com/shopping?' + Object.toQueryString(parameters);

    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var eBayList = {id: 'list', data:new Array()};
    var items = transport.getElementsByTagName("Item");
    $A(items).each(function(item){
    	var row = {source: 'eBay'};
    	
		if (item.getElementsByTagName("ItemID").length &gt; 0) {
			row.id = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("Title").length &gt; 0) {
			row.title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) {
			row.type = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) {
			var price = item.getElementsByTagName("ConvertedCurrentPrice")[0];
			var currency = price.getAttribute("currencyID");
			row.price = price.firstChild.nodeValue + " " + currency;
		}
		if (item.getElementsByTagName("GalleryURL").length &gt; 0) {
			row.image = item.getElementsByTagName("GalleryURL")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("ViewItemURLForNaturalSearch").length &gt; 0) {
			row.url = item.getElementsByTagName("ViewItemURLForNaturalSearch")[0].firstChild.nodeValue;
		}
		 
        eBayList.data.push(row);
     });
     this.manageData(["itemList"], [eBayList], []);
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">search: function (filter){
	
	var pageNumber = (filter.data.pageNumber)? filter.data.pageNumber : 1;
	
	var parameters = {
			'callname': 'FindItemsAdvanced',
			'ItemSort': 'BestMatch',
			'version': '515',
			'responseencoding': 'XML',
			'appid': 'eBayAPID-73f4-45f2-b9a3-c8f6388b38d8',
			'callback': 'true',
			'MaxEntries': '10',
			'PageNumber': pageNumber,
			'QueryKeywords': filter.data.keywords
	};
	
	var url = 'http://open.api.ebay.com/shopping?' + Object.toQueryString(parameters);

    new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var eBayList = {id: 'list', data:new Array()};
    var items = transport.getElementsByTagName("Item");
    $A(items).each(function(item){
    	var row = {source: 'eBay'};
    	
		if (item.getElementsByTagName("ItemID").length &gt; 0) {
			row.id = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("Title").length &gt; 0) {
			row.title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) {
			row.type = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) {
			var price = item.getElementsByTagName("ConvertedCurrentPrice")[0];
			var currency = price.getAttribute("currencyID");
			row.price = price.firstChild.nodeValue + " " + currency;
		}
		if (item.getElementsByTagName("GalleryURL").length &gt; 0) {
			row.image = item.getElementsByTagName("GalleryURL")[0].firstChild.nodeValue;
		}
		if (item.getElementsByTagName("ViewItemURLForNaturalSearch").length &gt; 0) {
			row.url = item.getElementsByTagName("ViewItemURLForNaturalSearch")[0].firstChild.nodeValue;
		}
		 
        eBayList.data.push(row);
     });
     this.manageData(["itemList"], [eBayList], []);
},

onError: function (transport){}</field>
    </object>
    <object pk="304" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">304</field>
        <field type="TextField" name="code">var BB304 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    //See http://www.nvivo.es/api

search: function (filter){

    	var parameters = {}
    	if(filter.data.user != undefined){
    		parameters['user'] = filter.data.user;
    		parameters['method'] = 'user.getEvents';
    	} else if(filter.data.venue_id != undefined){
    		parameters['venue_id'] = filter.data.venue_id;
    		parameters['method'] = 'venue.getEvents';
    	} else if(filter.data.city  != undefined){
    		parameters['city'] = filter.data.city;
    		parameters['method'] = 'city.getEvents';
    	}  else if(filter.data.artist != undefined){
    		parameters['artist'] = filter.data.artist;
    		parameters['method'] = 'artist.getEvents';
    	} else {
    		var l = {id: 'list', data: {}};
    		this.manageData(["eventList"], [l], []);
    	}
    	
    	parameters = this.buildParameter(this.getMandatoryParameters(), parameters);

        var url = 'http://www.nvivo.es/api/request.php?' + parameters.toQueryString() ;

        new FastAPI.Request(url ,{
            'method':       'get',
            'content':      'json',
            'context':      this,
            'onSuccess':    this.createList.bind(this)
        });
    },

    createList: function (transport){
    	var l = {id: 'list', data: {}};
    	l.data.eventList = transport['response']['gigs'];
        this.manageData(["eventList"], [l], []);
    },

    onError: function (transport){
    },

    buildParameter: function (parameter, defaultParameter){
    	var hash = new Hash(defaultParameter);
    	hash.update(parameter);
    	return hash;
    },

    getMandatoryParameters: function (){
    	return {
    		'format': 'json',
    		'api_key': 'f532a9d3d719ac58eda72ed750c8a0f4'
    	};
    }
    
});
    </field>
        <field type="TextField" name="unboundCode">//See http://www.nvivo.es/api

search: function (filter){

    	var parameters = {}
    	if(filter.data.user != undefined){
    		parameters['user'] = filter.data.user;
    		parameters['method'] = 'user.getEvents';
    	} else if(filter.data.venue_id != undefined){
    		parameters['venue_id'] = filter.data.venue_id;
    		parameters['method'] = 'venue.getEvents';
    	} else if(filter.data.city  != undefined){
    		parameters['city'] = filter.data.city;
    		parameters['method'] = 'city.getEvents';
    	}  else if(filter.data.artist != undefined){
    		parameters['artist'] = filter.data.artist;
    		parameters['method'] = 'artist.getEvents';
    	} else {
    		var l = {id: 'list', data: {}};
    		this.manageData(["eventList"], [l], []);
    	}
    	
    	parameters = this.buildParameter(this.getMandatoryParameters(), parameters);

        var url = 'http://www.nvivo.es/api/request.php?' + parameters.toQueryString() ;

        new FastAPI.Request(url ,{
            'method':       'get',
            'content':      'json',
            'context':      this,
            'onSuccess':    this.createList.bind(this)
        });
    },

    createList: function (transport){
    	var l = {id: 'list', data: {}};
    	l.data.eventList = transport['response']['gigs'];
        this.manageData(["eventList"], [l], []);
    },

    onError: function (transport){
    },

    buildParameter: function (parameter, defaultParameter){
    	var hash = new Hash(defaultParameter);
    	hash.update(parameter);
    	return hash;
    },

    getMandatoryParameters: function (){
    	return {
    		'format': 'json',
    		'api_key': 'f532a9d3d719ac58eda72ed750c8a0f4'
    	};
    }</field>
    </object>
    <object pk="305" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">305</field>
        <field type="TextField" name="code">var BB305 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    //See http://code.google.com/intl/es-ES/apis/base/docs/2.0/reference.html#OtherQueryParams

search: function (filter){
	var parameters = this.buildParameter(this.parameter, this.getDefaultParameters());
	parameters = this.buildParameter(filter.data, parameters);
	parameters = this.buildParameter(this.getMandatoryParameters(), parameters);

    var url = 'http://www.google.com/base/feeds/snippets?' + parameters.toQueryString() ;

    new FastAPI.Request(url ,{
        'method':       'get',
        'content':      'json',
        'context':      this,
        'onSuccess':    this.createList.bind(this)
    });
},

createList: function (transport){
	var l = {id: 'list', data: {}};
	l.data.title = transport['feed']['title']['$t'];
	l.data.totalResults = transport['feed']['openSearch$totalResults'];
	l.data.startIndex = transport['feed']['openSearch$startIndex'];
	l.data.itemsPerPage = transport['feed']['openSearch$itemsPerPage'];
	l.data.productList = transport['feed']['entry'];
    this.manageData(["itemList"], [l], []);
},

onError: function (transport){
},

buildParameter: function (parameter, defaultParameter){
	var hash = new Hash(defaultParameter);
	hash.update(parameter);
	return hash;
},

getMandatoryParameters: function (){
	return {
		'alt': 'json',
		'key': 'ABQIAAAAk3QWT6GNpsznFG2Za7JpZhT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQinpXz-Yj-vsiP5LxT3b4-WEkrfQ'
	};
},

getDefaultParameters: function (){
	return {
		'max-results': 10,
		'start-index': 1
	};
}
    
});
    </field>
        <field type="TextField" name="unboundCode">//See http://code.google.com/intl/es-ES/apis/base/docs/2.0/reference.html#OtherQueryParams

search: function (filter){
	var parameters = this.buildParameter(this.parameter, this.getDefaultParameters());
	parameters = this.buildParameter(filter.data, parameters);
	parameters = this.buildParameter(this.getMandatoryParameters(), parameters);

    var url = 'http://www.google.com/base/feeds/snippets?' + parameters.toQueryString() ;

    new FastAPI.Request(url ,{
        'method':       'get',
        'content':      'json',
        'context':      this,
        'onSuccess':    this.createList.bind(this)
    });
},

createList: function (transport){
	var l = {id: 'list', data: {}};
	l.data.title = transport['feed']['title']['$t'];
	l.data.totalResults = transport['feed']['openSearch$totalResults'];
	l.data.startIndex = transport['feed']['openSearch$startIndex'];
	l.data.itemsPerPage = transport['feed']['openSearch$itemsPerPage'];
	l.data.productList = transport['feed']['entry'];
    this.manageData(["itemList"], [l], []);
},

onError: function (transport){
},

buildParameter: function (parameter, defaultParameter){
	var hash = new Hash(defaultParameter);
	hash.update(parameter);
	return hash;
},

getMandatoryParameters: function (){
	return {
		'alt': 'json',
		'key': 'ABQIAAAAk3QWT6GNpsznFG2Za7JpZhT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQinpXz-Yj-vsiP5LxT3b4-WEkrfQ'
	};
},

getDefaultParameters: function (){
	return {
		'max-results': 10,
		'start-index': 1
	};
}</field>
    </object>
    <object pk="306" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">306</field>
        <field type="TextField" name="code">var BB306 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    //See http://code.google.com/intl/es-ES/apis/base/docs/2.0/reference.html#OtherQueryParams

search: function (filter){
	var parameters = this.buildParameter(this.parameter, this.getDefaultParameters());
	var start_index = (filter.data.pageNumber)? filter.data.pageNumber : 1;
	parameters = this.buildParameter({'q': filter.data.keywords, 'start-index':  start_index}, parameters);
	parameters = this.buildParameter(this.getMandatoryParameters(), parameters);

    var url = 'http://www.google.com/base/feeds/snippets?' + parameters.toQueryString() ;

    new FastAPI.Request(url ,{
        'method':       'get',
        'content':      'json',
        'context':      this,
        'onSuccess':    this.createList.bind(this)
    });
},

createList: function (transport){
	var l = {id: 'list', data: new Array()};
	var items = transport['feed']['entry'];
	
	for (var i=0; i&lt;items.length; i++){
		var entry = items[i];
		var item = {'source': 'Google Base'};
		if(entry['id'] != undefined) item['id'] = entry['id']['$t']; 
		if(entry['title'] != undefined) item['title'] = entry['title']['$t'];
		if(entry['g$product_type'] != undefined) item['type'] = entry['g$product_type'][0]['$t']; 
		if(entry['g$image_link'] != undefined) item['image'] = entry['g$image_link'][0]['$t']; 
		if(entry['link'] != undefined) item['url'] = entry['link'][0]['href']; 
		if(entry['g$price'] != undefined) item['price'] = entry['g$price'][0]['$t']; 
		l.data.push(item);
	}
    this.manageData(["itemList"], [l], []);
},

onError: function (transport){
},

buildParameter: function (parameter, defaultParameter){
	var hash = new Hash(defaultParameter);
	hash.update(parameter);
	return hash;
},

getMandatoryParameters: function (){
	return {
		'alt': 'json',
		'key': 'ABQIAAAAk3QWT6GNpsznFG2Za7JpZhT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQinpXz-Yj-vsiP5LxT3b4-WEkrfQ'
	};
},

getDefaultParameters: function (){
	return {
		'max-results': 10,
		'start-index': 1
	};
}
    
});
    </field>
        <field type="TextField" name="unboundCode">//See http://code.google.com/intl/es-ES/apis/base/docs/2.0/reference.html#OtherQueryParams

search: function (filter){
	var parameters = this.buildParameter(this.parameter, this.getDefaultParameters());
	var start_index = (filter.data.pageNumber)? filter.data.pageNumber : 1;
	parameters = this.buildParameter({'q': filter.data.keywords, 'start-index':  start_index}, parameters);
	parameters = this.buildParameter(this.getMandatoryParameters(), parameters);

    var url = 'http://www.google.com/base/feeds/snippets?' + parameters.toQueryString() ;

    new FastAPI.Request(url ,{
        'method':       'get',
        'content':      'json',
        'context':      this,
        'onSuccess':    this.createList.bind(this)
    });
},

createList: function (transport){
	var l = {id: 'list', data: new Array()};
	var items = transport['feed']['entry'];
	
	for (var i=0; i&lt;items.length; i++){
		var entry = items[i];
		var item = {'source': 'Google Base'};
		if(entry['id'] != undefined) item['id'] = entry['id']['$t']; 
		if(entry['title'] != undefined) item['title'] = entry['title']['$t'];
		if(entry['g$product_type'] != undefined) item['type'] = entry['g$product_type'][0]['$t']; 
		if(entry['g$image_link'] != undefined) item['image'] = entry['g$image_link'][0]['$t']; 
		if(entry['link'] != undefined) item['url'] = entry['link'][0]['href']; 
		if(entry['g$price'] != undefined) item['price'] = entry['g$price'][0]['$t']; 
		l.data.push(item);
	}
    this.manageData(["itemList"], [l], []);
},

onError: function (transport){
},

buildParameter: function (parameter, defaultParameter){
	var hash = new Hash(defaultParameter);
	hash.update(parameter);
	return hash;
},

getMandatoryParameters: function (){
	return {
		'alt': 'json',
		'key': 'ABQIAAAAk3QWT6GNpsznFG2Za7JpZhT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQinpXz-Yj-vsiP5LxT3b4-WEkrfQ'
	};
},

getDefaultParameters: function (){
	return {
		'max-results': 10,
		'start-index': 1
	};
}</field>
    </object>
    <object pk="307" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">307</field>
        <field type="TextField" name="code">var BB307 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    //See http://code.google.com/intl/es-ES/apis/base/docs/2.0/reference.html#OtherQueryParams

search: function (item){
    	parameters = this.getMandatoryParameters();

        var url = item.data.id + '?' + Object.toQueryString(parameters) ;

        new FastAPI.Request(url ,{
            'method':       'get',
            'content':      'json',
            'context':      this,
            'onSuccess':    this.createItem.bind(this)
        });
    },

    createItem: function (transport){
    	var item = {id: 'item', data: {'source': 'Google Base', 'details':{}}};
    	var entry = transport['entry'];
    	if(entry['id'] != undefined) item.data['id'] = entry['id']['$t']; 
    	if(entry['title'] != undefined) item.data['title'] = entry['title']['$t'];
    	if(entry['g$product_type'] != undefined) item.data['type'] = entry['g$product_type'][0]['$t']; 
		if(entry['g$image_link'] != undefined) item.data['image'] = entry['g$image_link'][0]['$t'];
    	if(entry['link'] != undefined) item.data['url'] = entry['link'][0]['href']; 
    	if(entry['g$price'] != undefined) item.data['price'] = entry['g$price'][0]['$t'];
    	
    	if(entry['brand'] != undefined) item.data.details['brand'] = entry['brand']['$t'];
    	if(entry['published'] != undefined) item.data.details['datePublished'] = entry['published']['$t'];
    	if(entry['content'] != undefined) item.data.details['description'] = entry['content']['$t'];
    	if(entry['g$condition'] != undefined) item.data.details['condition'] = entry['g$condition']['$t'];
    	if(entry['item_language'] != undefined) item.data.details['language'] = entry['item_language'][0]['$t']; 
    	if(entry['g$shipping'] != undefined) item.data.details['shipping'] = entry['g$shipping'][0]['g$price']['$t'];
    	if(entry['g$artist'] != undefined) item.data.details['creator'] = entry['g$artist']['$t'];
    	if(entry['g$rating'] != undefined) item.data.details['rating'] = entry['g$rating']['$t'];
    	
        this.manageData(["itemList"], [item], []);
    },

    onError: function (transport){
    },

    buildParameter: function (parameter, defaultParameter){
    	var hash = new Hash(defaultParameter);
    	hash.update(parameter);
    	return hash;
    },

    getMandatoryParameters: function (){
    	return {
    		'alt': 'json',
    		'key': 'ABQIAAAAk3QWT6GNpsznFG2Za7JpZhT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQinpXz-Yj-vsiP5LxT3b4-WEkrfQ'
    	};
    }
    
});
    </field>
        <field type="TextField" name="unboundCode">//See http://code.google.com/intl/es-ES/apis/base/docs/2.0/reference.html#OtherQueryParams

search: function (item){
    	parameters = this.getMandatoryParameters();

        var url = item.data.id + '?' + Object.toQueryString(parameters) ;

        new FastAPI.Request(url ,{
            'method':       'get',
            'content':      'json',
            'context':      this,
            'onSuccess':    this.createItem.bind(this)
        });
    },

    createItem: function (transport){
    	var item = {id: 'item', data: {'source': 'Google Base', 'details':{}}};
    	var entry = transport['entry'];
    	if(entry['id'] != undefined) item.data['id'] = entry['id']['$t']; 
    	if(entry['title'] != undefined) item.data['title'] = entry['title']['$t'];
    	if(entry['g$product_type'] != undefined) item.data['type'] = entry['g$product_type'][0]['$t']; 
		if(entry['g$image_link'] != undefined) item.data['image'] = entry['g$image_link'][0]['$t'];
    	if(entry['link'] != undefined) item.data['url'] = entry['link'][0]['href']; 
    	if(entry['g$price'] != undefined) item.data['price'] = entry['g$price'][0]['$t'];
    	
    	if(entry['brand'] != undefined) item.data.details['brand'] = entry['brand']['$t'];
    	if(entry['published'] != undefined) item.data.details['datePublished'] = entry['published']['$t'];
    	if(entry['content'] != undefined) item.data.details['description'] = entry['content']['$t'];
    	if(entry['g$condition'] != undefined) item.data.details['condition'] = entry['g$condition']['$t'];
    	if(entry['item_language'] != undefined) item.data.details['language'] = entry['item_language'][0]['$t']; 
    	if(entry['g$shipping'] != undefined) item.data.details['shipping'] = entry['g$shipping'][0]['g$price']['$t'];
    	if(entry['g$artist'] != undefined) item.data.details['creator'] = entry['g$artist']['$t'];
    	if(entry['g$rating'] != undefined) item.data.details['rating'] = entry['g$rating']['$t'];
    	
        this.manageData(["itemList"], [item], []);
    },

    onError: function (transport){
    },

    buildParameter: function (parameter, defaultParameter){
    	var hash = new Hash(defaultParameter);
    	hash.update(parameter);
    	return hash;
    },

    getMandatoryParameters: function (){
    	return {
    		'alt': 'json',
    		'key': 'ABQIAAAAk3QWT6GNpsznFG2Za7JpZhT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQinpXz-Yj-vsiP5LxT3b4-WEkrfQ'
    	};
    }</field>
    </object>
    <object pk="308" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">308</field>
        <field type="TextField" name="code">var BB308 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    search: function (filter){
   
    var pageNumber = (filter.data.pageNumber)? filter.data.pageNumber : 1;
    var productType = (filter.data.productType)? filter.data.productType : 'All';
    
    var parameters = {
			'SearchIndex': productType,
			'Keywords': filter.data.keywords,
			'ItemPage': pageNumber,
			'Operation': 'ItemSearch',
			'ResponseGroup': 'Medium',
			'Version': '2008-06-26'
	};
	
	var url = 'http://webservices.amazon.com/onca/xml?Service=AWSECommerceService&amp;' + Object.toQueryString(parameters);
    
    var encoder = new URLAmazonEncoder();
    encodedUrl = encoder.encode(url);

    //Invoke the service
    new FastAPI.Request(encodedUrl,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: 'list', data: new Array()};
	var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
        var message = {id: 'message', data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
        this.manageData(["message"], [message],[]);
    } else {
        //Correct response, create the result List
        var _list = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
        //Fill the table, 1 row per item
        $A(_list).each(function(item){
            if (item.getElementsByTagName("Title").length &gt; 0) {
                var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
            } else {
                var title = "";
            }
            if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
                var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
            } else {
                var price = "";
            }
            if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
                var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
            } else {
                var pGroup = "";
            }
            if (item.getElementsByTagName("DetailPageURL").length &gt; 0) {
                var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
            } else {
                var url = "";
            }
            if (item.getElementsByTagName("SmallImage").length &gt; 0) {
                var image = item.getElementsByTagName("SmallImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
            }else {
                var image = "";
            }
            if (item.getElementsByTagName("ASIN").length &gt; 0) {
                var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
            }

            var row = {
                source: "Amazon",
                title: title,
                price: price,
                type: pGroup,
                id: ASIN,
                url: url,
                image: image
            };
            l.data.push(row);
        });
        
        this.manageData(["itemList"], [l], []);
    }
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">search: function (filter){
   
    var pageNumber = (filter.data.pageNumber)? filter.data.pageNumber : 1;
    var productType = (filter.data.productType)? filter.data.productType : 'All';
    
    var parameters = {
			'SearchIndex': productType,
			'Keywords': filter.data.keywords,
			'ItemPage': pageNumber,
			'Operation': 'ItemSearch',
			'ResponseGroup': 'Medium',
			'Version': '2008-06-26'
	};
	
	var url = 'http://webservices.amazon.com/onca/xml?Service=AWSECommerceService&amp;' + Object.toQueryString(parameters);
    
    var encoder = new URLAmazonEncoder();
    encodedUrl = encoder.encode(url);

    //Invoke the service
    new FastAPI.Request(encodedUrl,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.addToList.bind(this)
    });
},

addToList: function (transport){
	var l = {id: 'list', data: new Array()};
	var xml = transport;
    //Check if the service returned an error
    if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
        var message = {id: 'message', data:{message: xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue}};
        this.manageData(["message"], [message],[]);
    } else {
        //Correct response, create the result List
        var _list = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
        //Fill the table, 1 row per item
        $A(_list).each(function(item){
            if (item.getElementsByTagName("Title").length &gt; 0) {
                var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
            } else {
                var title = "";
            }
            if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
                var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
            } else {
                var price = "";
            }
            if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
                var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
            } else {
                var pGroup = "";
            }
            if (item.getElementsByTagName("DetailPageURL").length &gt; 0) {
                var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
            } else {
                var url = "";
            }
            if (item.getElementsByTagName("SmallImage").length &gt; 0) {
                var image = item.getElementsByTagName("SmallImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
            }else {
                var image = "";
            }
            if (item.getElementsByTagName("ASIN").length &gt; 0) {
                var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
            }

            var row = {
                source: "Amazon",
                title: title,
                price: price,
                type: pGroup,
                id: ASIN,
                url: url,
                image: image
            };
            l.data.push(row);
        });
        
        this.manageData(["itemList"], [l], []);
    }
},

onError: function (transport){}</field>
    </object>
    <object pk="309" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">309</field>
        <field type="TextField" name="code">var BB309 = Class.create(BuildingBlock,{
    /** @constructs */
    initialize: function($super, screenId, buildingBlockId, parameter){
		$super(screenId, buildingBlockId, parameter);
    },
    
    manageData: function(triggers, addedFacts, deletedFacts){
    	ScreenEngineFactory.getInstance(this.screenId).manageData(triggers, addedFacts, deletedFacts, this.buildingBlockId);
    },
    
    search: function (item){
	var parameters = {
			'Operation': 'ItemLookup',
			'ResponseGroup': 'Large',
			'Version': '2008-06-26',
			'ItemId': item.data.id
	};
	
	var url = 'http://webservices.amazon.com/onca/xml?Service=AWSECommerceService&amp;' + Object.toQueryString(parameters);
    
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.fetchProductInfo.bind(this)
    });
},

fetchProductInfo: function (transport){
	var xml = transport;
	var item = xml.getElementsByTagName("Item")[0];
	if (item.getElementsByTagName("ASIN").length &gt; 0) {
		var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Title").length &gt; 0) {
		var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
        var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
        var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
	}
    if (item.getElementsByTagName("DetailPageURL").length &gt; 0) {
        var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
    }
    if (item.getElementsByTagName("LargeImage").length &gt; 0) {
        var image = item.getElementsByTagName("LargeImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
    }
    var _item = {
		id: "item",
		data:{
            source: "Amazon",
            title: title,
            price: price,
            type: pGroup,
            id: ASIN,
            url: url,
            image: image
        }
	};

    var elementList = ["Model",
						"Color",
						"Label",
						"Binding",
						"ReleaseDate",
						"Feature"];
    switch (pGroup){
		case "eBooks":
		case "Book":
			elementList = ["Author",
						   "PublicationDate",
						   "ISBN",
						   "Format",
						   "Label",
						   "NumberOfPages"];	
			break;
		case "Theatrical Release":
		case "Video":
		case "DVD":
			elementList = ["Actor",
						   "Director",
						   "Genre",
						   "RunningTime",
						   "AudienceRating",
						   "Label",
						   "Binding",
						   "Brand",
						   "Region",
						   "AspectRatio",
						   "OriginalReleaseDate",
						   "Format"];
			break;
		case "Digital Music Track":
		case "Music":
			elementList = 	["Artist",
							"Genre",
							"Label",
							"Brand",
							"Binding",
							"Format",
							"NumberOfDiscs",
							"ReleaseDate",
							"OriginalReleaseDate"];
			break;
		case "Photography":
			elementList = ["Brand","Model","Feature"];
			break;
		case "Personal Computer":
			elementList = 	["Model",
							"Label",
							"Binding",
							"CPUType",
							"CPUSpeed",
							"DisplaySize",
							"HardDiskSize",
							"DataLinkProtocol",
							"FloppyDiskDriveDescription",
							"SystemMemorySize",
							"SystemMemoryType",
							"HardwarePlatform",
							"OperatingSystem",
							"ReleaseDate",
							"Warranty",
							"LegalDisclaimer",
							"Feature",
							"SpecialFeatures"];
			break;
		case "CE":
		case "Video Games":						
		case "Software":
		case "Wireless":
		case "Wireless Phone Accessory":
			elementList = 	["Model",
							"Color",
							"Label",
							"Binding",
							"DisplaySize",
							"ESRBAgeRating", 
							"HardwarePlatform", 
							"OperatingSystem", 
							"ReleaseDate",
							"LegalDisclaimer",
							"Feature",
							"SpecialFeatures"];
			break;	
	}
    
	_item.data.details = this.getDetails(item, elementList);
    this.manageData(["newItem"], [_item], []);	
},

getDetails: function (item, atributeList){
	var details = {};
	for (var i=0; i &lt; atributeList.length; i++){
		var elements = item.getElementsByTagName(atributeList[i]);
		if (elements.length == 1) {
			details[atributeList[i]] = elements[0].firstChild.nodeValue;
    	} else if (elements.length &gt; 1){
    		details[atributeList[i]] = new Array();
    		for (var j=0; j &lt; elements.length; j++){
    			details[atributeList[i]].push(elements[j].firstChild.nodeValue);
	    	}
    	}
	}
	return details;
},

onError: function (transport){}
    
});
    </field>
        <field type="TextField" name="unboundCode">search: function (item){
	var parameters = {
			'Operation': 'ItemLookup',
			'ResponseGroup': 'Large',
			'Version': '2008-06-26',
			'ItemId': item.data.id
	};
	
	var url = 'http://webservices.amazon.com/onca/xml?Service=AWSECommerceService&amp;' + Object.toQueryString(parameters);
    
	var encoder = new URLAmazonEncoder();
	url = encoder.encode(url);

	new FastAPI.Request(url,{
        'method':       'get',
        'content':      'xml',
        'context':      this,
        'onSuccess':    this.fetchProductInfo.bind(this)
    });
},

fetchProductInfo: function (transport){
	var xml = transport;
	var item = xml.getElementsByTagName("Item")[0];
	if (item.getElementsByTagName("ASIN").length &gt; 0) {
		var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("Title").length &gt; 0) {
		var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("FormattedPrice").length &gt; 0) {
        var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
	}
	if (item.getElementsByTagName("ProductGroup").length &gt; 0) {
        var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
	}
    if (item.getElementsByTagName("DetailPageURL").length &gt; 0) {
        var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
    }
    if (item.getElementsByTagName("LargeImage").length &gt; 0) {
        var image = item.getElementsByTagName("LargeImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
    }
    var _item = {
		id: "item",
		data:{
            source: "Amazon",
            title: title,
            price: price,
            type: pGroup,
            id: ASIN,
            url: url,
            image: image
        }
	};

    var elementList = ["Model",
						"Color",
						"Label",
						"Binding",
						"ReleaseDate",
						"Feature"];
    switch (pGroup){
		case "eBooks":
		case "Book":
			elementList = ["Author",
						   "PublicationDate",
						   "ISBN",
						   "Format",
						   "Label",
						   "NumberOfPages"];	
			break;
		case "Theatrical Release":
		case "Video":
		case "DVD":
			elementList = ["Actor",
						   "Director",
						   "Genre",
						   "RunningTime",
						   "AudienceRating",
						   "Label",
						   "Binding",
						   "Brand",
						   "Region",
						   "AspectRatio",
						   "OriginalReleaseDate",
						   "Format"];
			break;
		case "Digital Music Track":
		case "Music":
			elementList = 	["Artist",
							"Genre",
							"Label",
							"Brand",
							"Binding",
							"Format",
							"NumberOfDiscs",
							"ReleaseDate",
							"OriginalReleaseDate"];
			break;
		case "Photography":
			elementList = ["Brand","Model","Feature"];
			break;
		case "Personal Computer":
			elementList = 	["Model",
							"Label",
							"Binding",
							"CPUType",
							"CPUSpeed",
							"DisplaySize",
							"HardDiskSize",
							"DataLinkProtocol",
							"FloppyDiskDriveDescription",
							"SystemMemorySize",
							"SystemMemoryType",
							"HardwarePlatform",
							"OperatingSystem",
							"ReleaseDate",
							"Warranty",
							"LegalDisclaimer",
							"Feature",
							"SpecialFeatures"];
			break;
		case "CE":
		case "Video Games":						
		case "Software":
		case "Wireless":
		case "Wireless Phone Accessory":
			elementList = 	["Model",
							"Color",
							"Label",
							"Binding",
							"DisplaySize",
							"ESRBAgeRating", 
							"HardwarePlatform", 
							"OperatingSystem", 
							"ReleaseDate",
							"LegalDisclaimer",
							"Feature",
							"SpecialFeatures"];
			break;	
	}
    
	_item.data.details = this.getDetails(item, elementList);
    this.manageData(["newItem"], [_item], []);	
},

getDetails: function (item, atributeList){
	var details = {};
	for (var i=0; i &lt; atributeList.length; i++){
		var elements = item.getElementsByTagName(atributeList[i]);
		if (elements.length == 1) {
			details[atributeList[i]] = elements[0].firstChild.nodeValue;
    	} else if (elements.length &gt; 1){
    		details[atributeList[i]] = new Array();
    		for (var j=0; j &lt; elements.length; j++){
    			details[atributeList[i]].push(elements[j].firstChild.nodeValue);
	    	}
    	}
	}
	return details;
},

onError: function (transport){}</field>
    </object>
    <object pk="310" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">310</field>
        <field type="TextField" name="code">&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type"
    content="application/xhtml+xml; charset=UTF-8" /&gt;
&lt;link type="text/css" rel="stylesheet"
    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
&lt;link type="text/css" rel="stylesheet"
    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
&lt;style type="text/css"&gt;
#pages {
    color: #FEBF43;
    font-weight: bold;
    padding: 10px;
}
#previousButton,#nextButton {
    visibility: hidden;
}
#loadingImg {
    margin: auto;
    padding-top: 10px;
}
#amazonImage {
    position: absolute;
    right: 0px;
    top: 3px;
}
&lt;/style&gt;
&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
&lt;script language="JavaScript"&gt;
    function List(){
        //Last page fetched from Amazon Service	
        this.lastPageFetched = 0;
        //Next set of products to print in the table (0-9)
        this.currentPage = 0;
        //Product list fetched from the Service
        this.productList = new Array();
        //Are we waiting for data?
        this.waiting = true;
        //Total number of pages
        this.numPages = 1;
    };
    List.prototype.init = function (){
        $("nextButton").observe("click", list.nextPage);
        $("previousButton").observe("click", list.previousPage);
        $$('input[type="button"]').each(function(element){
            element.observe("mouseover",function(event){
                var e = Event.element(event);
                e.setStyle({cursor:"pointer"});
            });		
        });
        var tableBody = $("listBody");
        tableBody.update("");
        list.lastPageFetched = 0;
        list.currentPage = 0;
        list.numPages = 1;
        list.productList = new Array();
        list.waiting = true;
        list.showProgress();
        list.fetch();
    }
    List.prototype.fetch = function (){
        if (list.lastPageFetched &lt; ((list.numPages)/2)) { //Only for the 5 pages provided by the service
            list.search();
        }else{
            list.showTable();
        }
    }
    List.prototype.search = function (){
        //Get the facts to invoke the service
        var filter = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#SearchRequest');
        var user = ScreenflowEngineFactory.getInstance().getFact('user');
        //Add the ItemSearch parameters
        if (filter.data instanceof Object) {
            var productType = filter.data.productType;
            if(!productType){
                productType = 'All'
            }
            var keywords = filter.data.searchText;
        } else {
            var productType = 'All';
            var keywords = filter.data;
        }
        var parameters = "";
        parameters += "&amp;SearchIndex=" + productType;

        parameters += "&amp;Keywords=" + encodeURIComponent(keywords);
        //Add the page number (if is set)
        parameters += "&amp;ItemPage=" + (list.lastPageFetched + 1);
        //Base URL of the REST Service
        var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
        //Add the AccessKeyId (get from the user fact)
        /*if (user)
            url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
        else // if the KB doesn't contain a user key Id, add one by default
            url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
        //Add the operation Type
        url +="&amp;Operation=ItemSearch";
        //Add the parameters
        url += parameters;
        //Add the responseGroup
        url +="&amp;ResponseGroup=Medium";
        //Add the current version of the API
        url += "&amp;Version=2008-06-26";

        var encoder = new URLAmazonEncoder();
        encodedUrl = encoder.encode(url);
 
        //Invoke the service
        new FastAPI.Request(encodedUrl,{
            'method':       'get',
            'content':      'xml',
            'context':      list,
            'onSuccess':    list.addToList
        });
    }
    List.prototype.addToList = function (transport){
        var xml = transport;
        //Check if the service returned an error
        if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
            //alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
        } else {
            //Correct response, create the result List
            var _list = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
            //Fill the table, 1 row per item
            $A(_list).each(function(item){
                if (item.getElementsByTagName("Title").length &gt; 0)
                    var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
                else
                    var title = "&amp;nbsp;";
                if (item.getElementsByTagName("FormattedPrice").length &gt; 0)
                    var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
                else
                    var price = "&amp;nbsp;";
                if (item.getElementsByTagName("ProductGroup").length &gt; 0)
                    var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
                else
                    var pGroup = "&amp;nbsp;";
                if (item.getElementsByTagName("ASIN").length &gt; 0)
                    var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
                var row = {
                    title: title,
                    price: price,
                    pGroup: pGroup,
                    ASIN: ASIN
                };
                list.productList.push(row);
            });
            if (xml.getElementsByTagName("TotalPages").length &gt; 0){
                var totalPages = parseInt(xml.getElementsByTagName("TotalPages")[0].firstChild.nodeValue);
                var totalResults = parseInt(xml.getElementsByTagName("TotalResults")[0].firstChild.nodeValue);
                //Recalculate the last page
                if (totalPages &gt; 0)
                    list.numPages = totalPages*2 - 1 + ((totalResults % 10) &gt; 5 ? 1:0);
                else
                    list.numPages = 0;
                if (list.numPages &gt; 10)
                    list.numPages = 10;
            }
            $("totalPages").update(list.numPages);
            list.lastPageFetched++;
            if (list.waiting) {
                list.waiting = false;
                list.showTable();
            }
        }
    }
    List.prototype.productDetail = function (nodeElement,_ASIN){
        list.clearSelected ();
        //select the element
        nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
        var item = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#Item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
        ScreenflowEngineFactory.getInstance().manageFacts([item],[]);
    }
    List.prototype.clearSelected = function (){
        $$("tbody tr").each(function (element){
            element.setStyle({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
        });
    }
    List.prototype.onError = function (transport){
    //alert(transport.responseText);
    }
    List.prototype.showProgress = function (){
        list.waiting = true;
        $("loadingImg").show();
    }
    List.prototype.showTable = function (){
        $("loadingImg").hide();
        //$("listBody").setStyle({visibility:"visible"});
        var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
        templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="list.productDetail(this,\'#{ASIN}\');"';
        templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
        var rowTemplate = new Template(templateString);
        var tableBody = $("listBody");
        for (var i = 5 * list.currentPage; i &lt; 5 * (list.currentPage + 1); i++) { //print the appropriate elements
            if (list.productList[i]) { //only if the product table is fetched
                tableBody.innerHTML += rowTemplate.evaluate(list.productList[i]);
            }
        }
        list.updateCurrentPage();
        //Update Interface
        if (list.currentPage &lt; (list.numPages - 1)) {
            $("nextButton").setStyle({visibility: "visible"});
        } else {
            $("nextButton").setStyle({visibility: "hidden"});
        }
        if (list.currentPage &gt; 0) {
            $("previousButton").setStyle({visibility: "visible"});
        } else {
            $("previousButton").setStyle({visibility: "hidden"});
        }
    }
    List.prototype.nextPage = function (){
        //Clear the table
        var tableBody = $("listBody");
        tableBody.update("");
        list.currentPage++;
        if (list.productList.length &gt;= (list.currentPage + 1) * 5) {
            list.showTable();
            // Lookahead
            if ((list.currentPage + 1) * 5 &gt;= list.productList.length) {
                list.fetch();
            }
        } else {
            list.showProgress();
            list.fetch();
        }
        list.updateCurrentPage();
    }
    List.prototype.previousPage = function (){
        //Clear the table
        var tableBody = $("listBody");
        tableBody.update("");
        list.currentPage--;
        list.showTable();
        list.updateCurrentPage();
    }
    //update the current page in the interface
    List.prototype.updateCurrentPage = function (){
        (list.currentPage&lt;9 &amp;&amp; list.numPages &gt; 9)?$("curPage").update("0"):$("curPage").update("");
        if (list.numPages &gt; 0)
            $("curPage").innerHTML +=list.currentPage+1;
        else
            $("curPage").innerHTML += "0";
    }
    var list = new List();
    ScreenflowEngineFactory.getInstance().addScreenLoader("310", list.init);
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="bodyDiv"&gt;
    &lt;span id="amazonImage"&gt;
        &lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;
    &lt;/span&gt;
&lt;h1 id="title"&gt;Item list&lt;/h1&gt;
&lt;div id="listDiv"&gt;
&lt;table&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th style="width: 60%; -moz-border-radius: 13px 0px 0px 0px;"&gt;Title&lt;/th&gt;
            &lt;th style="width: 10%"&gt;Price&lt;/th&gt;
            &lt;th style="width: 20%"&gt;Product Group&lt;/th&gt;
            &lt;th style="width: 10%; -moz-border-radius: 0px 13px 0px 0px;"&gt;&amp;nbsp;&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody id="listBody"&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;img id="loadingImg"
    src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;
&lt;div id="buttonContainerDiv"&gt;
    &lt;input type="button" id="previousButton" class="button" value="&lt;" /&gt;
    &lt;span id="pages"&gt; Page &lt;span id="curPage"&gt;-&lt;/span&gt;/&lt;span id="totalPages"&gt;-&lt;/span&gt;&lt;/span&gt;
    &lt;input type="button" id="nextButton" class="button" value="&gt;" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type"
    content="application/xhtml+xml; charset=UTF-8" /&gt;
&lt;link type="text/css" rel="stylesheet"
    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
&lt;link type="text/css" rel="stylesheet"
    href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
&lt;style type="text/css"&gt;
#pages {
    color: #FEBF43;
    font-weight: bold;
    padding: 10px;
}
#previousButton,#nextButton {
    visibility: hidden;
}
#loadingImg {
    margin: auto;
    padding-top: 10px;
}
#amazonImage {
    position: absolute;
    right: 0px;
    top: 3px;
}
&lt;/style&gt;
&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
&lt;script language="JavaScript"&gt;
    function List(){
        //Last page fetched from Amazon Service	
        this.lastPageFetched = 0;
        //Next set of products to print in the table (0-9)
        this.currentPage = 0;
        //Product list fetched from the Service
        this.productList = new Array();
        //Are we waiting for data?
        this.waiting = true;
        //Total number of pages
        this.numPages = 1;
    };
    List.prototype.init = function (){
        $("nextButton").observe("click", list.nextPage);
        $("previousButton").observe("click", list.previousPage);
        $$('input[type="button"]').each(function(element){
            element.observe("mouseover",function(event){
                var e = Event.element(event);
                e.setStyle({cursor:"pointer"});
            });		
        });
        var tableBody = $("listBody");
        tableBody.update("");
        list.lastPageFetched = 0;
        list.currentPage = 0;
        list.numPages = 1;
        list.productList = new Array();
        list.waiting = true;
        list.showProgress();
        list.fetch();
    }
    List.prototype.fetch = function (){
        if (list.lastPageFetched &lt; ((list.numPages)/2)) { //Only for the 5 pages provided by the service
            list.search();
        }else{
            list.showTable();
        }
    }
    List.prototype.search = function (){
        //Get the facts to invoke the service
        var filter = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#SearchRequest');
        var user = ScreenflowEngineFactory.getInstance().getFact('user');
        //Add the ItemSearch parameters
        if (filter.data instanceof Object) {
            var productType = filter.data.productType;
            if(!productType){
                productType = 'All'
            }
            var keywords = filter.data.searchText;
        } else {
            var productType = 'All';
            var keywords = filter.data;
        }
        var parameters = "";
        parameters += "&amp;SearchIndex=" + productType;

        parameters += "&amp;Keywords=" + encodeURIComponent(keywords);
        //Add the page number (if is set)
        parameters += "&amp;ItemPage=" + (list.lastPageFetched + 1);
        //Base URL of the REST Service
        var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
        //Add the AccessKeyId (get from the user fact)
        /*if (user)
            url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
        else // if the KB doesn't contain a user key Id, add one by default
            url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
        //Add the operation Type
        url +="&amp;Operation=ItemSearch";
        //Add the parameters
        url += parameters;
        //Add the responseGroup
        url +="&amp;ResponseGroup=Medium";
        //Add the current version of the API
        url += "&amp;Version=2008-06-26";

        var encoder = new URLAmazonEncoder();
        encodedUrl = encoder.encode(url);
 
        //Invoke the service
        new FastAPI.Request(encodedUrl,{
            'method':       'get',
            'content':      'xml',
            'context':      list,
            'onSuccess':    list.addToList
        });
    }
    List.prototype.addToList = function (transport){
        var xml = transport;
        //Check if the service returned an error
        if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
            //alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
        } else {
            //Correct response, create the result List
            var _list = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
            //Fill the table, 1 row per item
            $A(_list).each(function(item){
                if (item.getElementsByTagName("Title").length &gt; 0)
                    var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
                else
                    var title = "&amp;nbsp;";
                if (item.getElementsByTagName("FormattedPrice").length &gt; 0)
                    var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
                else
                    var price = "&amp;nbsp;";
                if (item.getElementsByTagName("ProductGroup").length &gt; 0)
                    var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
                else
                    var pGroup = "&amp;nbsp;";
                if (item.getElementsByTagName("ASIN").length &gt; 0)
                    var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
                var row = {
                    title: title,
                    price: price,
                    pGroup: pGroup,
                    ASIN: ASIN
                };
                list.productList.push(row);
            });
            if (xml.getElementsByTagName("TotalPages").length &gt; 0){
                var totalPages = parseInt(xml.getElementsByTagName("TotalPages")[0].firstChild.nodeValue);
                var totalResults = parseInt(xml.getElementsByTagName("TotalResults")[0].firstChild.nodeValue);
                //Recalculate the last page
                if (totalPages &gt; 0)
                    list.numPages = totalPages*2 - 1 + ((totalResults % 10) &gt; 5 ? 1:0);
                else
                    list.numPages = 0;
                if (list.numPages &gt; 10)
                    list.numPages = 10;
            }
            $("totalPages").update(list.numPages);
            list.lastPageFetched++;
            if (list.waiting) {
                list.waiting = false;
                list.showTable();
            }
        }
    }
    List.prototype.productDetail = function (nodeElement,_ASIN){
        list.clearSelected ();
        //select the element
        nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
        var item = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#Item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
        ScreenflowEngineFactory.getInstance().manageFacts([item],[]);
    }
    List.prototype.clearSelected = function (){
        $$("tbody tr").each(function (element){
            element.setStyle({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
        });
    }
    List.prototype.onError = function (transport){
    //alert(transport.responseText);
    }
    List.prototype.showProgress = function (){
        list.waiting = true;
        $("loadingImg").show();
    }
    List.prototype.showTable = function (){
        $("loadingImg").hide();
        //$("listBody").setStyle({visibility:"visible"});
        var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
        templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="list.productDetail(this,\'#{ASIN}\');"';
        templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
        var rowTemplate = new Template(templateString);
        var tableBody = $("listBody");
        for (var i = 5 * list.currentPage; i &lt; 5 * (list.currentPage + 1); i++) { //print the appropriate elements
            if (list.productList[i]) { //only if the product table is fetched
                tableBody.innerHTML += rowTemplate.evaluate(list.productList[i]);
            }
        }
        list.updateCurrentPage();
        //Update Interface
        if (list.currentPage &lt; (list.numPages - 1)) {
            $("nextButton").setStyle({visibility: "visible"});
        } else {
            $("nextButton").setStyle({visibility: "hidden"});
        }
        if (list.currentPage &gt; 0) {
            $("previousButton").setStyle({visibility: "visible"});
        } else {
            $("previousButton").setStyle({visibility: "hidden"});
        }
    }
    List.prototype.nextPage = function (){
        //Clear the table
        var tableBody = $("listBody");
        tableBody.update("");
        list.currentPage++;
        if (list.productList.length &gt;= (list.currentPage + 1) * 5) {
            list.showTable();
            // Lookahead
            if ((list.currentPage + 1) * 5 &gt;= list.productList.length) {
                list.fetch();
            }
        } else {
            list.showProgress();
            list.fetch();
        }
        list.updateCurrentPage();
    }
    List.prototype.previousPage = function (){
        //Clear the table
        var tableBody = $("listBody");
        tableBody.update("");
        list.currentPage--;
        list.showTable();
        list.updateCurrentPage();
    }
    //update the current page in the interface
    List.prototype.updateCurrentPage = function (){
        (list.currentPage&lt;9 &amp;&amp; list.numPages &gt; 9)?$("curPage").update("0"):$("curPage").update("");
        if (list.numPages &gt; 0)
            $("curPage").innerHTML +=list.currentPage+1;
        else
            $("curPage").innerHTML += "0";
    }
    var list = new List();
    ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", list.init);
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="bodyDiv"&gt;
    &lt;span id="amazonImage"&gt;
        &lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;
    &lt;/span&gt;
&lt;h1 id="title"&gt;Item list&lt;/h1&gt;
&lt;div id="listDiv"&gt;
&lt;table&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th style="width: 60%; -moz-border-radius: 13px 0px 0px 0px;"&gt;Title&lt;/th&gt;
            &lt;th style="width: 10%"&gt;Price&lt;/th&gt;
            &lt;th style="width: 20%"&gt;Product Group&lt;/th&gt;
            &lt;th style="width: 10%; -moz-border-radius: 0px 13px 0px 0px;"&gt;&amp;nbsp;&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody id="listBody"&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;img id="loadingImg"
    src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;
&lt;div id="buttonContainerDiv"&gt;
    &lt;input type="button" id="previousButton" class="button" value="&lt;" /&gt;
    &lt;span id="pages"&gt; Page &lt;span id="curPage"&gt;-&lt;/span&gt;/&lt;span id="totalPages"&gt;-&lt;/span&gt;&lt;/span&gt;
    &lt;input type="button" id="nextButton" class="button" value="&gt;" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="311" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">311</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#bodyDiv{
				max-width: 550px;
			}
			#searchArea {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:50px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:98%;
			}
			#contents{
				padding:12px;
			}
			#send{
				margin-left: 15px;
			}
			#amazonImage{
				position:absolute;
				right:2px;
				top:3px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}

		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        	function Search(){};
        	
        	Search.prototype.init = function (){
				//List of possible searches
				var searchIndices = ["All","Apparel","Automotive","Baby","Beauty","Blended",
									 "Books","Classical", "DigitalMusic","DVD","Electronics",
									 "GourmetFood","HealthPersonalCare","HomeGarden","Industrial",
									 "Jewelry","KindleStore","Kitchen","Magazines","Merchants",
									 "Miscellaneous","MP3Downloads","Music","MusicalInstruments",
									 "MusicTracks","OfficeProducts","OutdoorLiving","PCHardware",
									 "PetSupplies","Photo","SilverMerchants","Software","SportingGoods",
									 "Tools","Toys","UnboxVideo","VHS","Video","VideoGames","Watches",
									 "Wireless","WirelessAccessories"];
				$("send").observe("click", search.send);
				$("send").observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				//Populate the product type select element
				search.populateOptions(searchIndices);
			}
			
			Search.prototype.populateOptions = function (_list){
				var templateString = "&lt;option value ='#{element}'&gt;#{caption}&lt;/option&gt;";
				var template = new Template(templateString);
				var optionHTML = "";
				$A(_list).each (function (element){
					optionHTML += template.evaluate({"element":element,"caption":search.separate(element)});
				});
				$("productType").update(optionHTML);
			}
			
			//This function returns a human readable element, 
			//separating words by white-spaces
			Search.prototype.separate = function (element){
				//Workaround for special cases
				//TODO: Create a generic solution, maybe another regexp?
				if (element=="DVD" || element=="VHS" || element=="MP3Downloads" || element=="PCHardware"){
					if (element=="MP3Downloads")
						return "MP3 Downloads";
					if (element=="PCHardware")
						return "PC Hardware";
					return element;
				}
				else{
					var result = element.replace(/([A-Z])/g, " $1");
					//Remove first white-space when necessary
					result = (result[0]==" "?result.substring(1,result.length):result);
					return result;
				}
			}
			
			Search.prototype.send = function (){
				if ($F("searchText").length==0){ //Empty keywords are forbidden
					alert ("You must introduce at least one keyword");
					return;
				}
				var filter = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#SearchRequest', data:{productType: $F("productType"), searchText: $F("searchText")}};
				ScreenflowEngineFactory.getInstance().manageFacts([filter],[]);
			}
			
			var search = new Search();
			ScreenflowEngineFactory.getInstance().addScreenLoader("311", search.init);
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
        	&lt;h1 id="title"&gt;Product Search&lt;/h1&gt;
			&lt;div id="searchArea"&gt;
				&lt;div id="contents"&gt;
					&lt;span class="title"&gt;Keywords: &lt;/span&gt; &lt;input type="text" id="searchText" /&gt;
					&lt;select id="productType"&gt;			
					&lt;/select&gt;
					&lt;input type="button" id="send" value="Search" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;       
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#bodyDiv{
				max-width: 550px;
			}
			#searchArea {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:50px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:98%;
			}
			#contents{
				padding:12px;
			}
			#send{
				margin-left: 15px;
			}
			#amazonImage{
				position:absolute;
				right:2px;
				top:3px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}

		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        	function Search(){};
        	
        	Search.prototype.init = function (){
				//List of possible searches
				var searchIndices = ["All","Apparel","Automotive","Baby","Beauty","Blended",
									 "Books","Classical", "DigitalMusic","DVD","Electronics",
									 "GourmetFood","HealthPersonalCare","HomeGarden","Industrial",
									 "Jewelry","KindleStore","Kitchen","Magazines","Merchants",
									 "Miscellaneous","MP3Downloads","Music","MusicalInstruments",
									 "MusicTracks","OfficeProducts","OutdoorLiving","PCHardware",
									 "PetSupplies","Photo","SilverMerchants","Software","SportingGoods",
									 "Tools","Toys","UnboxVideo","VHS","Video","VideoGames","Watches",
									 "Wireless","WirelessAccessories"];
				$("send").observe("click", search.send);
				$("send").observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				//Populate the product type select element
				search.populateOptions(searchIndices);
			}
			
			Search.prototype.populateOptions = function (_list){
				var templateString = "&lt;option value ='#{element}'&gt;#{caption}&lt;/option&gt;";
				var template = new Template(templateString);
				var optionHTML = "";
				$A(_list).each (function (element){
					optionHTML += template.evaluate({"element":element,"caption":search.separate(element)});
				});
				$("productType").update(optionHTML);
			}
			
			//This function returns a human readable element, 
			//separating words by white-spaces
			Search.prototype.separate = function (element){
				//Workaround for special cases
				//TODO: Create a generic solution, maybe another regexp?
				if (element=="DVD" || element=="VHS" || element=="MP3Downloads" || element=="PCHardware"){
					if (element=="MP3Downloads")
						return "MP3 Downloads";
					if (element=="PCHardware")
						return "PC Hardware";
					return element;
				}
				else{
					var result = element.replace(/([A-Z])/g, " $1");
					//Remove first white-space when necessary
					result = (result[0]==" "?result.substring(1,result.length):result);
					return result;
				}
			}
			
			Search.prototype.send = function (){
				if ($F("searchText").length==0){ //Empty keywords are forbidden
					alert ("You must introduce at least one keyword");
					return;
				}
				var filter = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#SearchRequest', data:{productType: $F("productType"), searchText: $F("searchText")}};
				ScreenflowEngineFactory.getInstance().manageFacts([filter],[]);
			}
			
			var search = new Search();
			ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", search.init);
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
        	&lt;h1 id="title"&gt;Product Search&lt;/h1&gt;
			&lt;div id="searchArea"&gt;
				&lt;div id="contents"&gt;
					&lt;span class="title"&gt;Keywords: &lt;/span&gt; &lt;input type="text" id="searchText" /&gt;
					&lt;select id="productType"&gt;			
					&lt;/select&gt;
					&lt;input type="button" id="send" value="Search" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;       
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="312" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">312</field>
        <field type="TextField" name="code">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#loadingImgEBayList{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#eBayImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        
        	function EBayList(){
	            //Product list fetched from the Service
	            this.productList = new Array();
	            //Are we waiting for data?
	            this.waiting = true;
            };
            
            EBayList.prototype.init = function (){
                $$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var tableBody = $("listBodyEBayList");
                tableBody.update("");
	            eBayList.productList = new Array();
	            eBayList.waiting = true;
	            eBayList.showProgress();
                eBayList.fetch();
            }
            
            EBayList.prototype.fetch = function (){
            
            	//Get the facts to invoke the service
                var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
                
                //URL of the Service
				var url = "http://open.api.ebay.com/shopping?";
				url += "&amp;callname=FindItems";
				url += "&amp;ItemSort=BestMatch";
				url += "&amp;version=515";
				url += "&amp;responseencoding=XML";
				url += "&amp;appid=eBayAPID-73f4-45f2-b9a3-c8f6388b38d8";
				url += "&amp;callback=true";
				url += "&amp;QueryKeywords=" +  encodeURIComponent(item.data.title);

				//Invoke the service
                new FastAPI.Request(url,{
                    'method':       'get',
                    'content':      'xml',
                    'context':      eBayList,
                    'onSuccess':    eBayList.addToList
                });
            }
            
            EBayList.prototype.addToList = function (transport){
            	var xml = transport;
                var items = xml.getElementsByTagName("Item");
                //Fill the table, 1 row per item
                $A(items).each(function(item){
                     if (item.getElementsByTagName("ItemID").length &gt; 0) 
                         var itemID = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
					 else
    					var itemID = "&amp;nbsp;";
    				 if (item.getElementsByTagName("Title").length &gt; 0) 
                         var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
					 else
    					var title = "&amp;nbsp;";
    				 if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) 
                         var category = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
					 else
    					var category = "&amp;nbsp;";
    				 if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) 
                         var currentPrice = '$' + item.getElementsByTagName("ConvertedCurrentPrice")[0].firstChild.nodeValue;
					 else
    					var currentPrice = "&amp;nbsp;";
    				 if (item.getElementsByTagName("ShippingServiceCost").length &gt; 0) 
                         var shippingServiceCost = '$' + item.getElementsByTagName("ShippingServiceCost")[0].firstChild.nodeValue;
					 else
    					var shippingServiceCost = "&amp;nbsp;";
    				 if (item.getElementsByTagName("GalleryURL").length &gt; 0) 
                         var image = item.getElementsByTagName("GalleryURL")[0].firstChild.nodeValue;
                     else
                     	var image = "";
                     var row = {
                     	 itemID: itemID,
                         title:  title.replace(/\x27/g,"`"),
                         category: category,
                         currentPrice: currentPrice,
                         shippingServiceCost: shippingServiceCost,
                         image: image
                     };
                     eBayList.productList.push(row);
                 });
                 if (eBayList.waiting) {
                     eBayList.waiting = false;
                     eBayList.showTable();
                 }
            }
            
            
            EBayList.prototype.productDetail = function (nodeElement, itemID, title){
				eBayList.clearSelected ();
				//select the element
				nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
				var ebayItem = {uri: 'http://developer.ebay.com/DevZone/shopping/docs/CallRef/FindItemsAdvanced.html#Request', data:{itemID: itemID, title: title}};
				ScreenflowEngineFactory.getInstance().manageFacts([ebayItem],[]);
			}
			
			EBayList.prototype.clearSelected = function (){
				$$("tbody tr").each(function (element){
					element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
				});
			}
			
			EBayList.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            EBayList.prototype.showProgress = function (){
                eBayList.waiting = true;
                $("loadingImgEBayList").show();
            }
            
            EBayList.prototype.showTable = function (){
            	if($("loadingImgEBayList")){
                	$("loadingImgEBayList").hide();
                }
                var templateString = '&lt;tr&gt;';
                templateString += '&lt;td&gt;&lt;img src="#{image}"/&gt;&lt;/td&gt;';
                templateString += '&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{category}&lt;/td&gt;&lt;td&gt;#{currentPrice}&lt;/td&gt;&lt;td&gt;#{shippingServiceCost}&lt;/td&gt;';
                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="eBayList.productDetail(this,\'#{itemID}\',\'#{title}\');"';
				templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodyEBayList");
                for (var i = 0; i &lt; eBayList.productList.length; i++) { //print the appropriate elements
                    if (eBayList.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(eBayList.productList[i]);
                    }
                }
            }
            
            var eBayList = new EBayList();
			ScreenflowEngineFactory.getInstance().addScreenLoader("312", eBayList.init);
			
        &lt;/script&gt;&lt;/head&gt;&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="eBayImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/logo-ebay.gif" /&gt;&lt;/span&gt;
		    &lt;h1 id="title"&gt;eBay Item list&lt;/h1&gt;
		    &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                        	&lt;th style="width: 10%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                &amp;nbsp;
                            &lt;/th&gt;
                            &lt;th style="width: 60%;" nowrap="nowrap"&gt;
                                Title
                            &lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;
                                Category
                            &lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;
                                Current Price
                            &lt;/th&gt;
                            &lt;th style="width: 20%;" nowrap="nowrap"&gt;
                                Shipping Service Cost
                            &lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                &amp;nbsp;
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyEBayList"&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
		    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgEBayList" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#loadingImgEBayList{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#eBayImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        
        	function EBayList(){
	            //Product list fetched from the Service
	            this.productList = new Array();
	            //Are we waiting for data?
	            this.waiting = true;
            };
            
            EBayList.prototype.init = function (){
                $$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var tableBody = $("listBodyEBayList");
                tableBody.update("");
	            eBayList.productList = new Array();
	            eBayList.waiting = true;
	            eBayList.showProgress();
                eBayList.fetch();
            }
            
            EBayList.prototype.fetch = function (){
            
            	//Get the facts to invoke the service
                var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
                
                //URL of the Service
				var url = "http://open.api.ebay.com/shopping?";
				url += "&amp;callname=FindItems";
				url += "&amp;ItemSort=BestMatch";
				url += "&amp;version=515";
				url += "&amp;responseencoding=XML";
				url += "&amp;appid=eBayAPID-73f4-45f2-b9a3-c8f6388b38d8";
				url += "&amp;callback=true";
				url += "&amp;QueryKeywords=" +  encodeURIComponent(item.data.title);

				//Invoke the service
                new FastAPI.Request(url,{
                    'method':       'get',
                    'content':      'xml',
                    'context':      eBayList,
                    'onSuccess':    eBayList.addToList
                });
            }
            
            EBayList.prototype.addToList = function (transport){
            	var xml = transport;
                var items = xml.getElementsByTagName("Item");
                //Fill the table, 1 row per item
                $A(items).each(function(item){
                     if (item.getElementsByTagName("ItemID").length &gt; 0) 
                         var itemID = item.getElementsByTagName("ItemID")[0].firstChild.nodeValue;
					 else
    					var itemID = "&amp;nbsp;";
    				 if (item.getElementsByTagName("Title").length &gt; 0) 
                         var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
					 else
    					var title = "&amp;nbsp;";
    				 if (item.getElementsByTagName("PrimaryCategoryName").length &gt; 0) 
                         var category = item.getElementsByTagName("PrimaryCategoryName")[0].firstChild.nodeValue;
					 else
    					var category = "&amp;nbsp;";
    				 if (item.getElementsByTagName("ConvertedCurrentPrice").length &gt; 0) 
                         var currentPrice = '$' + item.getElementsByTagName("ConvertedCurrentPrice")[0].firstChild.nodeValue;
					 else
    					var currentPrice = "&amp;nbsp;";
    				 if (item.getElementsByTagName("ShippingServiceCost").length &gt; 0) 
                         var shippingServiceCost = '$' + item.getElementsByTagName("ShippingServiceCost")[0].firstChild.nodeValue;
					 else
    					var shippingServiceCost = "&amp;nbsp;";
    				 if (item.getElementsByTagName("GalleryURL").length &gt; 0) 
                         var image = item.getElementsByTagName("GalleryURL")[0].firstChild.nodeValue;
                     else
                     	var image = "";
                     var row = {
                     	 itemID: itemID,
                         title:  title.replace(/\x27/g,"`"),
                         category: category,
                         currentPrice: currentPrice,
                         shippingServiceCost: shippingServiceCost,
                         image: image
                     };
                     eBayList.productList.push(row);
                 });
                 if (eBayList.waiting) {
                     eBayList.waiting = false;
                     eBayList.showTable();
                 }
            }
            
            
            EBayList.prototype.productDetail = function (nodeElement, itemID, title){
				eBayList.clearSelected ();
				//select the element
				nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
				var ebayItem = {uri: 'http://developer.ebay.com/DevZone/shopping/docs/CallRef/FindItemsAdvanced.html#Request', data:{itemID: itemID, title: title}};
				ScreenflowEngineFactory.getInstance().manageFacts([ebayItem],[]);
			}
			
			EBayList.prototype.clearSelected = function (){
				$$("tbody tr").each(function (element){
					element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
				});
			}
			
			EBayList.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            EBayList.prototype.showProgress = function (){
                eBayList.waiting = true;
                $("loadingImgEBayList").show();
            }
            
            EBayList.prototype.showTable = function (){
            	if($("loadingImgEBayList")){
                	$("loadingImgEBayList").hide();
                }
                var templateString = '&lt;tr&gt;';
                templateString += '&lt;td&gt;&lt;img src="#{image}"/&gt;&lt;/td&gt;';
                templateString += '&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{category}&lt;/td&gt;&lt;td&gt;#{currentPrice}&lt;/td&gt;&lt;td&gt;#{shippingServiceCost}&lt;/td&gt;';
                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="eBayList.productDetail(this,\'#{itemID}\',\'#{title}\');"';
				templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodyEBayList");
                for (var i = 0; i &lt; eBayList.productList.length; i++) { //print the appropriate elements
                    if (eBayList.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(eBayList.productList[i]);
                    }
                }
            }
            
            var eBayList = new EBayList();
			ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", eBayList.init);
			
        &lt;/script&gt;&lt;/head&gt;&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="eBayImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/logo-ebay.gif" /&gt;&lt;/span&gt;
		    &lt;h1 id="title"&gt;eBay Item list&lt;/h1&gt;
		    &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                        	&lt;th style="width: 10%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                &amp;nbsp;
                            &lt;/th&gt;
                            &lt;th style="width: 60%;" nowrap="nowrap"&gt;
                                Title
                            &lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;
                                Category
                            &lt;/th&gt;
                            &lt;th style="width: 10%;" nowrap="nowrap"&gt;
                                Current Price
                            &lt;/th&gt;
                            &lt;th style="width: 20%;" nowrap="nowrap"&gt;
                                Shipping Service Cost
                            &lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                &amp;nbsp;
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyEBayList"&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
		    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgEBayList" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="313" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">313</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#loadingImgCart{
				margin:auto;	
			}
			#info{
				margin:auto;
				font-family:Arial,Helvetica,sans-serif;
				font-style:italic;
				padding-top: 10px;
				color: #AAA;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#buttonContainerDivCart{
				margin-top: 5px;
				display:none;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
        &lt;script language="JavaScript"&gt;
        		
        	function ShoppingCart(){
		    	//Product list fetched from the Service
		        this.productList = new Array();
				//Subtotal
				this.subTotal="";
				// number of items in the cart
				this.itemTotal = 0;
				//Purchase URL
				this.purchaseURL = "";
            	//Are we waiting for data?
            	this.waiting = true;
		    };
            
            ShoppingCart.prototype.init = function (){
                $("clearButton").observe("click", shoppingCart.clearCart);
                $("checkoutButton").observe("click", shoppingCart.checkout);
				$("updateButton").observe("click", shoppingCart.update);
				$$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if(!$("loadingImgCart")){
					$("info").update('&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;');

				}
				$("loadingImgCart").show();
				$("buttonContainerDivCart").hide();
				shoppingCart.waiting = true;
                shoppingCart.fetch();
            }
            
            ShoppingCart.prototype.clearCart = function (){
				//Ask the user to confirm the operation
				if (confirm("Are you sure you want to empty your Shopping Cart?")) {
					var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
					var user = ScreenflowEngineFactory.getInstance().getFact('user');
					
					//Create the call
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
					/*if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartClear";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;CartId=" + cart.data.id;
					url += "&amp;HMAC=" + cart.data.HMAC;
					
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Invoke the service
           	        new FastAPI.Request(url,{
                        'method':       'get',
                        'content':      'xml',
                        'context':      shoppingCart,
                        'onSuccess':    shoppingCart.clear_ok
                    });
				}	
			}

            ShoppingCart.prototype.clear_ok = function (){
				ScreenflowEngineFactory.getInstance().manageFacts([],['http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL']);
				shoppingCart.fetch();
			}
			
			ShoppingCart.prototype.checkout = function (){
				var purchase = {uri:'http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL', data:{url: shoppingCart.purchaseURL}};
				ScreenflowEngineFactory.getInstance().manageFacts([purchase],[]);
			}
			
			ShoppingCart.prototype.update = function (){
				if (shoppingCart.productList.length &gt; 0) { //Only if there is something to update
					var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
					var user = ScreenflowEngineFactory.getInstance().getFact('user');
					//Create the call
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
					/*if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartModify";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;CartId=" + cart.data.id;
					url += "&amp;HMAC=" + cart.data.HMAC;
					//Build the parameter list
					for (var i=0; i &lt; shoppingCart.productList.length; i++){
						url += "&amp;Item." + (i+1) + ".CartItemId=" + shoppingCart.productList[i]["id"];
						url += "&amp;Item." + (i+1) + ".Quantity=" + $F(shoppingCart.productList[i]["id"]);
					}

						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Create the call
                    new FastAPI.Request(url,{
                        'method':       'get',
                        'content':      'xml',
                        'context':      shoppingCart,
                        'onSuccess':    shoppingCart.update_ok
                    });
				}
			}

			ShoppingCart.prototype.update_ok = function (){
				ScreenflowEngineFactory.getInstance().manageFacts([],['http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL']);
				shoppingCart.fetch();
			}
			
			//Change the current Item Fact
			ShoppingCart.prototype.productDetail = function (_ASIN,_title){
				var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
				item.data.ASIN = _ASIN;
				item.data.title = _title;
				ScreenflowEngineFactory.getInstance().manageFacts([item],['product']);
			}
			
			ShoppingCart.prototype.fetch = function (){
				//empty current data
				shoppingCart.productList = new Array();
				shoppingCart.subTotal = 0;
				shoppingCart.itemTotal = 0;  
				
                //Get the facts to invoke the service
                //TODO add error handling
                var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
                var user = ScreenflowEngineFactory.getInstance().getFact('user');
				
                //Invoke the service CartGet to retrieve the product list
                var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
				//Add the AccessKeyId (get from the user fact)
				/*if (user)
					url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
				else // if the KB doesn't contain a user key Id, add one by default
					url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
				//Add the operation Type
				url +="&amp;Operation=CartGet";
				//Add the current version of the API
				url += "&amp;Version=2008-06-26";
				//Add item ID
				url += "&amp;CartId=" + cart.data.id;
				url += "&amp;HMAC=" + cart.data.HMAC;
				
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
				//Create the call
                new FastAPI.Request(url,{
                    'method':       'get',
                    'content':      'xml',
                    'context':      shoppingCart,
                    'onSuccess':    shoppingCart.addToList
                });
            }
            
            ShoppingCart.prototype.addToList = function (transport){
                var xml = transport;
                //Check if the service returned an error
                if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
                    alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
                }
                else { //Correct response, create the result List
                	if (xml.getElementsByTagName("CartItems").length &gt; 0) { //There are products in the cart
						var list = xml.getElementsByTagName("CartItems")[0].getElementsByTagName("CartItem");
						//Fill the table, 1 row per item
						$A(list).each(function(item){
							if (item.getElementsByTagName("Title").length &gt; 0) 
								var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("ASIN").length &gt; 0) 
								var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("CartItemId").length &gt; 0) 
								var ID = item.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("Price").length &gt; 0) 
								var price = item.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("Quantity").length &gt; 0) 
								var quantity = item.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
							var row = {
								title: title,
								price: price,
								ASIN: ASIN,
								id: ID,
								quantity: quantity
							};
							shoppingCart.itemTotal += parseInt (quantity);
							shoppingCart.productList.push(row);
						});
					}
					if (xml.getElementsByTagName("SubTotal").length&gt;0)
						shoppingCart.subTotal = xml.getElementsByTagName("SubTotal")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
					else
						shoppingCart.subTotal = "$0.0";
					if (xml.getElementsByTagName("PurchaseURL").length&gt;0)
						shoppingCart.purchaseURL = xml.getElementsByTagName("PurchaseURL")[0].firstChild.nodeValue;
                    if (shoppingCart.waiting) {
                        shoppingCart.waiting = false;
                    }
					shoppingCart.showTable();
                }
            }
            
            ShoppingCart.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            ShoppingCart.prototype.showProgress = function (){
                shoppingCart.waiting = true;
                $("loadingImgCart").show();
            }
            
            ShoppingCart.prototype.showTable = function (){
                if($("loadingImgCart")){
                	$("loadingImgCart").hide();
				}
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if (shoppingCart.productList.length == 0) {//Empty shopping cart
					$("info").update("Your Shopping Cart is empty");
					$("buttonContainerDivCart").hide();
					ScreenflowEngineFactory.getInstance().manageFacts([],['?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL']);	
					return;
				}else{
					$("info").update("");
				}
				$("buttonContainerDivCart").setStyle({display:"inline"});
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;a onclick="shoppingCart.productDetail(\'#{ASIN}\',\'#{title}\');"&gt;#{title}&lt;/a&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{price}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input type="text" maxlength="3" size="2" id="#{id}"';
				templateString += 'value="#{quantity}"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                
                for (var i = 0; i &lt; shoppingCart.productList.length; i++) {
                    if (shoppingCart.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(shoppingCart.productList[i]);
                    }
                }
				//Last row, including subtotal
				var lastRow = "&lt;tr&gt;&lt;th style='text-align:right'&gt;Subtotal&lt;/th&gt;&lt;th&gt;";
				lastRow += shoppingCart.subTotal;
				lastRow += "&lt;/th&gt;&lt;th&gt;";
				lastRow += shoppingCart.itemTotal;
				lastRow += "&lt;/th&gt;&lt;/tr&gt;";
				tableBody.innerHTML += lastRow;
            }
            
            var shoppingCart = new ShoppingCart();
			ScreenflowEngineFactory.getInstance().addScreenLoader("313", shoppingCart.init);
					
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Shopping Cart&lt;/h1&gt;
            &lt;div id="listDivCart"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width:70%;-moz-border-radius: 13px 0px 0px 0px;"&gt;
                                Shopping Cart Items
                            &lt;/th&gt;
                            &lt;th style="width:10%"&gt;
                                Price
                            &lt;/th&gt;
                            &lt;th style="width:10%;-moz-border-radius: 0px 13px 0px 0px;"&gt;
                                Quantity
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyCart"&gt;
                    	&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
						&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
						&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
						&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
               &lt;div id="info"&gt;&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;&lt;/div&gt;		
                &lt;div id="buttonContainerDivCart"&gt;
                    &lt;input type="button" id="clearButton" class="button" value="Clear Cart"/&gt;
					&lt;input type="button" id="updateButton" class="button" value="Update Cart"/&gt;
					&lt;input type="button" id="checkoutButton" class="button" value="Proceed to Checkout"/&gt;
                &lt;/div&gt;
				
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#loadingImgCart{
				margin:auto;	
			}
			#info{
				margin:auto;
				font-family:Arial,Helvetica,sans-serif;
				font-style:italic;
				padding-top: 10px;
				color: #AAA;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#buttonContainerDivCart{
				margin-top: 5px;
				display:none;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
        &lt;script language="JavaScript"&gt;
        		
        	function ShoppingCart(){
		    	//Product list fetched from the Service
		        this.productList = new Array();
				//Subtotal
				this.subTotal="";
				// number of items in the cart
				this.itemTotal = 0;
				//Purchase URL
				this.purchaseURL = "";
            	//Are we waiting for data?
            	this.waiting = true;
		    };
            
            ShoppingCart.prototype.init = function (){
                $("clearButton").observe("click", shoppingCart.clearCart);
                $("checkoutButton").observe("click", shoppingCart.checkout);
				$("updateButton").observe("click", shoppingCart.update);
				$$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if(!$("loadingImgCart")){
					$("info").update('&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;');

				}
				$("loadingImgCart").show();
				$("buttonContainerDivCart").hide();
				shoppingCart.waiting = true;
                shoppingCart.fetch();
            }
            
            ShoppingCart.prototype.clearCart = function (){
				//Ask the user to confirm the operation
				if (confirm("Are you sure you want to empty your Shopping Cart?")) {
					var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
					var user = ScreenflowEngineFactory.getInstance().getFact('user');
					
					//Create the call
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
					/*if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartClear";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;CartId=" + cart.data.id;
					url += "&amp;HMAC=" + cart.data.HMAC;
					
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Invoke the service
           	        new FastAPI.Request(url,{
                        'method':       'get',
                        'content':      'xml',
                        'context':      shoppingCart,
                        'onSuccess':    shoppingCart.clear_ok
                    });
				}	
			}

            ShoppingCart.prototype.clear_ok = function (){
				ScreenflowEngineFactory.getInstance().manageFacts([],['http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL']);
				shoppingCart.fetch();
			}
			
			ShoppingCart.prototype.checkout = function (){
				var purchase = {uri:'http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL', data:{url: shoppingCart.purchaseURL}};
				ScreenflowEngineFactory.getInstance().manageFacts([purchase],[]);
			}
			
			ShoppingCart.prototype.update = function (){
				if (shoppingCart.productList.length &gt; 0) { //Only if there is something to update
					var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
					var user = ScreenflowEngineFactory.getInstance().getFact('user');
					//Create the call
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
					/*if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartModify";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;CartId=" + cart.data.id;
					url += "&amp;HMAC=" + cart.data.HMAC;
					//Build the parameter list
					for (var i=0; i &lt; shoppingCart.productList.length; i++){
						url += "&amp;Item." + (i+1) + ".CartItemId=" + shoppingCart.productList[i]["id"];
						url += "&amp;Item." + (i+1) + ".Quantity=" + $F(shoppingCart.productList[i]["id"]);
					}

						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Create the call
                    new FastAPI.Request(url,{
                        'method':       'get',
                        'content':      'xml',
                        'context':      shoppingCart,
                        'onSuccess':    shoppingCart.update_ok
                    });
				}
			}

			ShoppingCart.prototype.update_ok = function (){
				ScreenflowEngineFactory.getInstance().manageFacts([],['http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL']);
				shoppingCart.fetch();
			}
			
			//Change the current Item Fact
			ShoppingCart.prototype.productDetail = function (_ASIN,_title){
				var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
				item.data.ASIN = _ASIN;
				item.data.title = _title;
				ScreenflowEngineFactory.getInstance().manageFacts([item],['product']);
			}
			
			ShoppingCart.prototype.fetch = function (){
				//empty current data
				shoppingCart.productList = new Array();
				shoppingCart.subTotal = 0;
				shoppingCart.itemTotal = 0;  
				
                //Get the facts to invoke the service
                //TODO add error handling
                var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
                var user = ScreenflowEngineFactory.getInstance().getFact('user');
				
                //Invoke the service CartGet to retrieve the product list
                var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
				//Add the AccessKeyId (get from the user fact)
				/*if (user)
					url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
				else // if the KB doesn't contain a user key Id, add one by default
					url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
				//Add the operation Type
				url +="&amp;Operation=CartGet";
				//Add the current version of the API
				url += "&amp;Version=2008-06-26";
				//Add item ID
				url += "&amp;CartId=" + cart.data.id;
				url += "&amp;HMAC=" + cart.data.HMAC;
				
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
				//Create the call
                new FastAPI.Request(url,{
                    'method':       'get',
                    'content':      'xml',
                    'context':      shoppingCart,
                    'onSuccess':    shoppingCart.addToList
                });
            }
            
            ShoppingCart.prototype.addToList = function (transport){
                var xml = transport;
                //Check if the service returned an error
                if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
                    alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
                }
                else { //Correct response, create the result List
                	if (xml.getElementsByTagName("CartItems").length &gt; 0) { //There are products in the cart
						var list = xml.getElementsByTagName("CartItems")[0].getElementsByTagName("CartItem");
						//Fill the table, 1 row per item
						$A(list).each(function(item){
							if (item.getElementsByTagName("Title").length &gt; 0) 
								var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("ASIN").length &gt; 0) 
								var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("CartItemId").length &gt; 0) 
								var ID = item.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("Price").length &gt; 0) 
								var price = item.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
							if (item.getElementsByTagName("Quantity").length &gt; 0) 
								var quantity = item.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
							var row = {
								title: title,
								price: price,
								ASIN: ASIN,
								id: ID,
								quantity: quantity
							};
							shoppingCart.itemTotal += parseInt (quantity);
							shoppingCart.productList.push(row);
						});
					}
					if (xml.getElementsByTagName("SubTotal").length&gt;0)
						shoppingCart.subTotal = xml.getElementsByTagName("SubTotal")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
					else
						shoppingCart.subTotal = "$0.0";
					if (xml.getElementsByTagName("PurchaseURL").length&gt;0)
						shoppingCart.purchaseURL = xml.getElementsByTagName("PurchaseURL")[0].firstChild.nodeValue;
                    if (shoppingCart.waiting) {
                        shoppingCart.waiting = false;
                    }
					shoppingCart.showTable();
                }
            }
            
            ShoppingCart.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            ShoppingCart.prototype.showProgress = function (){
                shoppingCart.waiting = true;
                $("loadingImgCart").show();
            }
            
            ShoppingCart.prototype.showTable = function (){
                if($("loadingImgCart")){
                	$("loadingImgCart").hide();
				}
				var tableBody = $("listBodyCart");
				tableBody.update("");
				if (shoppingCart.productList.length == 0) {//Empty shopping cart
					$("info").update("Your Shopping Cart is empty");
					$("buttonContainerDivCart").hide();
					ScreenflowEngineFactory.getInstance().manageFacts([],['?Purchase http://www.w3.org/1999/02/22-rdf-syntax-ns#type http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL']);	
					return;
				}else{
					$("info").update("");
				}
				$("buttonContainerDivCart").setStyle({display:"inline"});
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;a onclick="shoppingCart.productDetail(\'#{ASIN}\',\'#{title}\');"&gt;#{title}&lt;/a&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{price}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input type="text" maxlength="3" size="2" id="#{id}"';
				templateString += 'value="#{quantity}"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                
                for (var i = 0; i &lt; shoppingCart.productList.length; i++) {
                    if (shoppingCart.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(shoppingCart.productList[i]);
                    }
                }
				//Last row, including subtotal
				var lastRow = "&lt;tr&gt;&lt;th style='text-align:right'&gt;Subtotal&lt;/th&gt;&lt;th&gt;";
				lastRow += shoppingCart.subTotal;
				lastRow += "&lt;/th&gt;&lt;th&gt;";
				lastRow += shoppingCart.itemTotal;
				lastRow += "&lt;/th&gt;&lt;/tr&gt;";
				tableBody.innerHTML += lastRow;
            }
            
            var shoppingCart = new ShoppingCart();
			ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", shoppingCart.init);
					
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Shopping Cart&lt;/h1&gt;
            &lt;div id="listDivCart"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width:70%;-moz-border-radius: 13px 0px 0px 0px;"&gt;
                                Shopping Cart Items
                            &lt;/th&gt;
                            &lt;th style="width:10%"&gt;
                                Price
                            &lt;/th&gt;
                            &lt;th style="width:10%;-moz-border-radius: 0px 13px 0px 0px;"&gt;
                                Quantity
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyCart"&gt;
                    	&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
						&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
						&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
						&lt;tr&gt;
							&lt;td&gt;&amp;nbsp;&lt;/td&gt;
					    &lt;/tr&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
               &lt;div id="info"&gt;&lt;img id="loadingImgCart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif" /&gt;&lt;/div&gt;		
                &lt;div id="buttonContainerDivCart"&gt;
                    &lt;input type="button" id="clearButton" class="button" value="Clear Cart"/&gt;
					&lt;input type="button" id="updateButton" class="button" value="Update Cart"/&gt;
					&lt;input type="button" id="checkoutButton" class="button" value="Proceed to Checkout"/&gt;
                &lt;/div&gt;
				
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="314" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">314</field>
        <field type="TextField" name="code">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesComparative{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonComparative, #nextButtonComparative {
				visibility:hidden;
			}
			#loadingImgComparative{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#listDiv tbody td {
				text-align: justify;
			}
			.tiny{
				font-size:10px;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
        &lt;script language="JavaScript"&gt;
        
        	function PriceComparative(){
	            //Next set of products to print in the table
	            this.currentPage = 0;
	            //Product list fetched from the Service
	            this.productList = new Array();
	            //Are we waiting for data?
	            this.waiting = true;
            };
            
            PriceComparative.prototype.init = function (){
                $("nextButtonComparative").observe("click", priceComparative.nextPage);
                $("previousButtonComparative").observe("click", priceComparative.previousPage);
				$$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
				$$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
				var tableBody = $("listBodyComparative");
                tableBody.update("");
                priceComparative.currentPage = 0;
	            priceComparative.productList = new Array();
	            priceComparative.waiting = true;
	            priceComparative.showProgress();
                priceComparative.fetch();
            }
            
            PriceComparative.prototype.fetch = function (){
            
            	//Get the facts to invoke the service
                var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
                var user = ScreenflowEngineFactory.getInstance().getFact('user');
                //Add the ItemSearch parameters
                var parameters = "";
				parameters += "&amp;ItemId=" + item.data.ASIN;
				parameters += "&amp;MerchantId=All&amp;Condition=All";
                
                //Base URL of the REST Service
				var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
				//Add the AccessKeyId (get from the user fact)
				/*if (user)
					url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
				else // if the KB doesn't contain a user key Id, add one by default
					url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
				//Add the operation Type
				url +="&amp;Operation=ItemLookup";
				//Add the parameters
				url += parameters;
				//Add the responseGroup
				url +="&amp;ResponseGroup=OfferFull";
				//Add the current version of the API
				url += "&amp;Version=2008-06-26";
                               
	
			var encoder = new URLAmazonEncoder();
			url = encoder.encode(url);
	

				//Invoke the service
		        new FastAPI.Request(url,{
		            'method':       'get',
		            'content':      'xml',
		            'context':      priceComparative,
		            'onSuccess':    priceComparative.addToList
		        });
            }
            
            PriceComparative.prototype.addToList = function (transport){
                var xml = transport;
                //Check if the service returned an error
                if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
                    alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
                }
                else { //Correct response, create the result List
                    var comparativelist = xml.getElementsByTagName("Offers")[0].getElementsByTagName("Offer");
                    //Fill the table, 1 row per item
                    $A(comparativelist).each(function(offer){
                        if (offer.getElementsByTagName("Name").length &gt; 0) 
                            var sellerName = offer.getElementsByTagName("Name")[0].firstChild.nodeValue;
						else
							if  (offer.getElementsByTagName("Nickname").length &gt; 0)
						    	var sellerName = offer.getElementsByTagName("Nickname")[0].firstChild.nodeValue;
							else
								var sellerName = "&amp;nbsp;";
                        if (offer.getElementsByTagName("SellerId").length &gt; 0) 
                            var sellerId = offer.getElementsByTagName("SellerId")[0].firstChild.nodeValue;
						else
						    var sellerId = "none";
                        if (offer.getElementsByTagName("AverageFeedbackRating").length &gt; 0) 
                            var averageRating = offer.getElementsByTagName("AverageFeedbackRating")[0].firstChild.nodeValue;
						else
						    var averageRating = "&amp;nbsp;";
                        if (offer.getElementsByTagName("TotalFeedback").length &gt; 0) 
                            var totalFeedback = offer.getElementsByTagName("TotalFeedback")[0].firstChild.nodeValue;
						else
						    var totalFeedback = "&amp;nbsp;";
                        if (offer.getElementsByTagName("Condition").length &gt; 0)
							var condition = offer.getElementsByTagName("Condition")[0].firstChild.nodeValue;             
						else
						    var condition = "&amp;nbsp;";
                        if (offer.getElementsByTagName("ConditionNote").length &gt; 0)
							var conditionNote = "(" + offer.getElementsByTagName("ConditionNote")[0].firstChild.nodeValue + ")";             
						else
						    var conditionNote = "&amp;nbsp;";
                        if (offer.getElementsByTagName("OfferListingId").length &gt; 0)
							var offerId = offer.getElementsByTagName("OfferListingId")[0].firstChild.nodeValue;             
						else
						    var offerId = "";
                        if (offer.getElementsByTagName("Price").length &gt; 0)
							var price = offer.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
						else
						    var price = "";
                        if (offer.getElementsByTagName("AmountSaved").length &gt; 0)
							var amountSaved = offer.getElementsByTagName("AmountSaved")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
						else
						    var amountSaved = "";
                        if (offer.getElementsByTagName("PercentageSaved").length &gt; 0)
							var percentageSaved = offer.getElementsByTagName("PercentageSaved")[0].firstChild.nodeValue;             
						else
						    var percentageSaved = "&amp;nbsp;";
                        if (offer.getElementsByTagName("Availability").length &gt; 0)
							var availability = offer.getElementsByTagName("Availability")[0].firstChild.nodeValue;             
						else
						    var availability = "&amp;nbsp;";
                        var row = {
                            sellerName: sellerName,
                            sellerId: sellerId,
                            location: location,
                            averageRating: averageRating,
							totalFeedback: totalFeedback,
							condition: condition,
							conditionNote: conditionNote,
							offerId: offerId,
							price: price,
							amountSaved: amountSaved,
							percentageSaved: percentageSaved,
							availability: availability
                        };
                        priceComparative.productList.push(row);
				    });
                    if (priceComparative.waiting) {
                        priceComparative.waiting = false;
                        priceComparative.showTable();
                    }
                }
            }
            
			PriceComparative.prototype.addToCart = function (offerId){
				var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
				var user = ScreenflowEngineFactory.getInstance().getFact('user');
				if (cart){//If the cart is already created, it will have an ID in the User Fact
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
					/*if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartAdd";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;CartId=" + cart.data.id;
					url += "&amp;HMAC=" + cart.data.HMAC;
					url += "&amp;Item.1.OfferListingId=" + offerId;
					url += "&amp;Item.1.Quantity=" + 1;
					
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Invoke the service
					new FastAPI.Request(url,{
	                    'method':       'get',
	                    'content':      'xml',
	                    'context':      priceComparative,
	                    'onSuccess':    priceComparative.productAdded
	                });
				}
				else { //Cart doesn't exist: Create a new cart with the product
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
				/*	if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartCreate";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;Item.1.OfferListingId=" + offerId;
					url += "&amp;Item.1.Quantity=" + 1;
					
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Invoke the service
	                new FastAPI.Request(url,{
	                    'method':       'get',
	                    'content':      'xml',
	                    'context':      priceComparative,
	                    'onSuccess':    priceComparative.cartCreated
	                });
				}
			}
			
			PriceComparative.prototype.cartCreated = function (transport){
				var xml = transport;
				
				//The product is added to the cart,
				//tell it to the user
				if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True"){
					
					//Check if the product is eligible for shopping
					if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
						xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
						//The product is not elegible
						alert ("The product is not eligible to be added to the cart");
						return;
					}
					//Add the Cart ID to the KB
					var cart = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart',
								data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
									HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
					ScreenflowEngineFactory.getInstance().manageFacts([cart],[]);
					alert ("Product added to the shopping Cart");
				}
				else {
					alert ("Error adding the product to the cart");
			    }
			}
			
			PriceComparative.prototype.productAdded = function (transport){
				var xml = transport;
				//Check if the product is eligible for shopping
				if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
					xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
					//The product is not elegible
					alert ("The product is not eligible to be added to the cart");
					return;
				}
				//If the product is added to the cart,
				//tell it to the user
				if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True")
					alert ("Product added to the shopping Cart");
				else
					alert ("Error adding the product to the cart");
			}
			PriceComparative.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            PriceComparative.prototype.showProgress = function (){
                priceComparative.waiting = true;
                $("loadingImgComparative").show();
            }
            
            PriceComparative.prototype.showTable = function (){
            	if($("loadingImgComparative")){
                	$("loadingImgComparative").hide();
                }
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;span class="info"&gt;#{price}&lt;/span&gt; &lt;br /&gt;&lt;span class="tiny"&gt;You save #{amountSaved} (#{percentageSaved}%)&lt;/span&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{condition} #{conditionNote} &lt;/td&gt;'; 
			    templateString += '&lt;td&gt;&lt;a target="_blank" href="http://www.amazon.com/gp/help/seller/at-a-glance.html?seller=#{sellerId}"&gt;';
				templateString += '#{sellerName}&lt;/a&gt;&lt;br /&gt;&lt;span class="info"&gt;Rating:&lt;/span&gt; #{averageRating} of #{totalFeedback} user reviews';
				templateString += '&lt;br /&gt;&lt;span class="info"&gt;Availability:&lt;/span&gt; #{availability}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input width="112" type="image" height="21" border="0" align="absmiddle"';
				templateString += 'alt="Add to cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart-small.gif"';
				templateString += 'onclick="priceComparative.addToCart(\'#{offerId}\'); /&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodyComparative");
                for (var i = 5 * priceComparative.currentPage; i &lt; 5 * (priceComparative.currentPage + 1); i++) { //print the appropriate elements
                    if (priceComparative.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(priceComparative.productList[i]);
                    }
                }
                //Update Interface
                if (priceComparative.currentPage &lt; 1) {
                    $("nextButtonComparative").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("nextButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }
                if (priceComparative.currentPage &gt; 0) {
                    $("previousButtonComparative").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("previousButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }
            }
            
            PriceComparative.prototype.nextPage = function (){
                //Clear the table
                var tableBody = $("listBodyComparative");
                tableBody.update("");
                priceComparative.currentPage++;
                priceComparative.showTable();
				//update the current page in the interface
				 $("curPageComparative").update(priceComparative.currentPage+1);
            }
            
           PriceComparative.prototype.previousPage = function (){
                //Clear the table
                var tableBody = $("listBodyComparative");
                tableBody.update("");
                priceComparative.currentPage--;
                priceComparative.showTable();
				//update the current page in the interface;
				$("curPageComparative").update(priceComparative.currentPage+1);
            }
            
            var priceComparative = new PriceComparative();
			ScreenflowEngineFactory.getInstance().addScreenLoader("314", priceComparative.init);
			
        &lt;/script&gt;
	&lt;/head&gt;
	&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Price Comparative&lt;/h1&gt;
			&lt;div id="like"&gt;Offers for &lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 20%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                Price
                            &lt;/th&gt;
                            &lt;th style="width: 20%;"&gt;
                                Condition
                            &lt;/th&gt;
                            &lt;th style="width: 40%;"&gt;
                                Seller Information
                            &lt;/th&gt;
                            &lt;th style="width: 20%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                Ready to Buy?
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyComparative"&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
		    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgComparative" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonComparative" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesComparative"&gt;
					Page &lt;span id="curPageComparative"&gt;1&lt;/span&gt;/2
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonComparative" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
				
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesComparative{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonComparative, #nextButtonComparative {
				visibility:hidden;
			}
			#loadingImgComparative{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#listDiv tbody td {
				text-align: justify;
			}
			.tiny{
				font-size:10px;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
        &lt;script language="JavaScript"&gt;
        
        	function PriceComparative(){
	            //Next set of products to print in the table
	            this.currentPage = 0;
	            //Product list fetched from the Service
	            this.productList = new Array();
	            //Are we waiting for data?
	            this.waiting = true;
            };
            
            PriceComparative.prototype.init = function (){
                $("nextButtonComparative").observe("click", priceComparative.nextPage);
                $("previousButtonComparative").observe("click", priceComparative.previousPage);
				$$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
				$$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
				var tableBody = $("listBodyComparative");
                tableBody.update("");
                priceComparative.currentPage = 0;
	            priceComparative.productList = new Array();
	            priceComparative.waiting = true;
	            priceComparative.showProgress();
                priceComparative.fetch();
            }
            
            PriceComparative.prototype.fetch = function (){
            
            	//Get the facts to invoke the service
                var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
                var user = ScreenflowEngineFactory.getInstance().getFact('user');
                //Add the ItemSearch parameters
                var parameters = "";
				parameters += "&amp;ItemId=" + item.data.ASIN;
				parameters += "&amp;MerchantId=All&amp;Condition=All";
                
                //Base URL of the REST Service
				var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
				//Add the AccessKeyId (get from the user fact)
				/*if (user)
					url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
				else // if the KB doesn't contain a user key Id, add one by default
					url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
				//Add the operation Type
				url +="&amp;Operation=ItemLookup";
				//Add the parameters
				url += parameters;
				//Add the responseGroup
				url +="&amp;ResponseGroup=OfferFull";
				//Add the current version of the API
				url += "&amp;Version=2008-06-26";
                               
	
			var encoder = new URLAmazonEncoder();
			url = encoder.encode(url);
	

				//Invoke the service
		        new FastAPI.Request(url,{
		            'method':       'get',
		            'content':      'xml',
		            'context':      priceComparative,
		            'onSuccess':    priceComparative.addToList
		        });
            }
            
            PriceComparative.prototype.addToList = function (transport){
                var xml = transport;
                //Check if the service returned an error
                if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
                    alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
                }
                else { //Correct response, create the result List
                    var comparativelist = xml.getElementsByTagName("Offers")[0].getElementsByTagName("Offer");
                    //Fill the table, 1 row per item
                    $A(comparativelist).each(function(offer){
                        if (offer.getElementsByTagName("Name").length &gt; 0) 
                            var sellerName = offer.getElementsByTagName("Name")[0].firstChild.nodeValue;
						else
							if  (offer.getElementsByTagName("Nickname").length &gt; 0)
						    	var sellerName = offer.getElementsByTagName("Nickname")[0].firstChild.nodeValue;
							else
								var sellerName = "&amp;nbsp;";
                        if (offer.getElementsByTagName("SellerId").length &gt; 0) 
                            var sellerId = offer.getElementsByTagName("SellerId")[0].firstChild.nodeValue;
						else
						    var sellerId = "none";
                        if (offer.getElementsByTagName("AverageFeedbackRating").length &gt; 0) 
                            var averageRating = offer.getElementsByTagName("AverageFeedbackRating")[0].firstChild.nodeValue;
						else
						    var averageRating = "&amp;nbsp;";
                        if (offer.getElementsByTagName("TotalFeedback").length &gt; 0) 
                            var totalFeedback = offer.getElementsByTagName("TotalFeedback")[0].firstChild.nodeValue;
						else
						    var totalFeedback = "&amp;nbsp;";
                        if (offer.getElementsByTagName("Condition").length &gt; 0)
							var condition = offer.getElementsByTagName("Condition")[0].firstChild.nodeValue;             
						else
						    var condition = "&amp;nbsp;";
                        if (offer.getElementsByTagName("ConditionNote").length &gt; 0)
							var conditionNote = "(" + offer.getElementsByTagName("ConditionNote")[0].firstChild.nodeValue + ")";             
						else
						    var conditionNote = "&amp;nbsp;";
                        if (offer.getElementsByTagName("OfferListingId").length &gt; 0)
							var offerId = offer.getElementsByTagName("OfferListingId")[0].firstChild.nodeValue;             
						else
						    var offerId = "";
                        if (offer.getElementsByTagName("Price").length &gt; 0)
							var price = offer.getElementsByTagName("Price")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
						else
						    var price = "";
                        if (offer.getElementsByTagName("AmountSaved").length &gt; 0)
							var amountSaved = offer.getElementsByTagName("AmountSaved")[0].getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;             
						else
						    var amountSaved = "";
                        if (offer.getElementsByTagName("PercentageSaved").length &gt; 0)
							var percentageSaved = offer.getElementsByTagName("PercentageSaved")[0].firstChild.nodeValue;             
						else
						    var percentageSaved = "&amp;nbsp;";
                        if (offer.getElementsByTagName("Availability").length &gt; 0)
							var availability = offer.getElementsByTagName("Availability")[0].firstChild.nodeValue;             
						else
						    var availability = "&amp;nbsp;";
                        var row = {
                            sellerName: sellerName,
                            sellerId: sellerId,
                            location: location,
                            averageRating: averageRating,
							totalFeedback: totalFeedback,
							condition: condition,
							conditionNote: conditionNote,
							offerId: offerId,
							price: price,
							amountSaved: amountSaved,
							percentageSaved: percentageSaved,
							availability: availability
                        };
                        priceComparative.productList.push(row);
				    });
                    if (priceComparative.waiting) {
                        priceComparative.waiting = false;
                        priceComparative.showTable();
                    }
                }
            }
            
			PriceComparative.prototype.addToCart = function (offerId){
				var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
				var user = ScreenflowEngineFactory.getInstance().getFact('user');
				if (cart){//If the cart is already created, it will have an ID in the User Fact
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
					/*if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartAdd";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;CartId=" + cart.data.id;
					url += "&amp;HMAC=" + cart.data.HMAC;
					url += "&amp;Item.1.OfferListingId=" + offerId;
					url += "&amp;Item.1.Quantity=" + 1;
					
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Invoke the service
					new FastAPI.Request(url,{
	                    'method':       'get',
	                    'content':      'xml',
	                    'context':      priceComparative,
	                    'onSuccess':    priceComparative.productAdded
	                });
				}
				else { //Cart doesn't exist: Create a new cart with the product
					var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
					//Add the AccessKeyId (get from the user fact)
				/*	if (user)
						url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
					else // if the KB doesn't contain a user key Id, add one by default
						url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
					//Add the operation Type
					url +="&amp;Operation=CartCreate";
					//Add the current version of the API
					url += "&amp;Version=2008-06-26";
					//Add item ID
					url += "&amp;Item.1.OfferListingId=" + offerId;
					url += "&amp;Item.1.Quantity=" + 1;
					
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
					//Invoke the service
	                new FastAPI.Request(url,{
	                    'method':       'get',
	                    'content':      'xml',
	                    'context':      priceComparative,
	                    'onSuccess':    priceComparative.cartCreated
	                });
				}
			}
			
			PriceComparative.prototype.cartCreated = function (transport){
				var xml = transport;
				
				//The product is added to the cart,
				//tell it to the user
				if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True"){
					
					//Check if the product is eligible for shopping
					if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
						xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
						//The product is not elegible
						alert ("The product is not eligible to be added to the cart");
						return;
					}
					//Add the Cart ID to the KB
					var cart = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart',
								data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
									HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
					ScreenflowEngineFactory.getInstance().manageFacts([cart],[]);
					alert ("Product added to the shopping Cart");
				}
				else {
					alert ("Error adding the product to the cart");
			    }
			}
			
			PriceComparative.prototype.productAdded = function (transport){
				var xml = transport;
				//Check if the product is eligible for shopping
				if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
					xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
					//The product is not elegible
					alert ("The product is not eligible to be added to the cart");
					return;
				}
				//If the product is added to the cart,
				//tell it to the user
				if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True")
					alert ("Product added to the shopping Cart");
				else
					alert ("Error adding the product to the cart");
			}
			PriceComparative.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            PriceComparative.prototype.showProgress = function (){
                priceComparative.waiting = true;
                $("loadingImgComparative").show();
            }
            
            PriceComparative.prototype.showTable = function (){
            	if($("loadingImgComparative")){
                	$("loadingImgComparative").hide();
                }
                var templateString = '&lt;tr&gt;&lt;td&gt;&lt;span class="info"&gt;#{price}&lt;/span&gt; &lt;br /&gt;&lt;span class="tiny"&gt;You save #{amountSaved} (#{percentageSaved}%)&lt;/span&gt;&lt;/td&gt;';
				templateString += '&lt;td&gt;#{condition} #{conditionNote} &lt;/td&gt;'; 
			    templateString += '&lt;td&gt;&lt;a target="_blank" href="http://www.amazon.com/gp/help/seller/at-a-glance.html?seller=#{sellerId}"&gt;';
				templateString += '#{sellerName}&lt;/a&gt;&lt;br /&gt;&lt;span class="info"&gt;Rating:&lt;/span&gt; #{averageRating} of #{totalFeedback} user reviews';
				templateString += '&lt;br /&gt;&lt;span class="info"&gt;Availability:&lt;/span&gt; #{availability}&lt;/td&gt;';
				templateString += '&lt;td&gt;&lt;input width="112" type="image" height="21" border="0" align="absmiddle"';
				templateString += 'alt="Add to cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart-small.gif"';
				templateString += 'onclick="priceComparative.addToCart(\'#{offerId}\'); /&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodyComparative");
                for (var i = 5 * priceComparative.currentPage; i &lt; 5 * (priceComparative.currentPage + 1); i++) { //print the appropriate elements
                    if (priceComparative.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(priceComparative.productList[i]);
                    }
                }
                //Update Interface
                if (priceComparative.currentPage &lt; 1) {
                    $("nextButtonComparative").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("nextButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }
                if (priceComparative.currentPage &gt; 0) {
                    $("previousButtonComparative").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("previousButtonComparative").setStyle({
                        visibility: "hidden"
                    });
                }
            }
            
            PriceComparative.prototype.nextPage = function (){
                //Clear the table
                var tableBody = $("listBodyComparative");
                tableBody.update("");
                priceComparative.currentPage++;
                priceComparative.showTable();
				//update the current page in the interface
				 $("curPageComparative").update(priceComparative.currentPage+1);
            }
            
           PriceComparative.prototype.previousPage = function (){
                //Clear the table
                var tableBody = $("listBodyComparative");
                tableBody.update("");
                priceComparative.currentPage--;
                priceComparative.showTable();
				//update the current page in the interface;
				$("curPageComparative").update(priceComparative.currentPage+1);
            }
            
            var priceComparative = new PriceComparative();
			ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", priceComparative.init);
			
        &lt;/script&gt;
	&lt;/head&gt;
	&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Price Comparative&lt;/h1&gt;
			&lt;div id="like"&gt;Offers for &lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 20%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                Price
                            &lt;/th&gt;
                            &lt;th style="width: 20%;"&gt;
                                Condition
                            &lt;/th&gt;
                            &lt;th style="width: 40%;"&gt;
                                Seller Information
                            &lt;/th&gt;
                            &lt;th style="width: 20%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                Ready to Buy?
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodyComparative"&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
		    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgComparative" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonComparative" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesComparative"&gt;
					Page &lt;span id="curPageComparative"&gt;1&lt;/span&gt;/2
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonComparative" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
				
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="315" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">315</field>
        <field type="TextField" name="code">&lt;html&gt;
		    &lt;head&gt;
		        &lt;script language="JavaScript"&gt;
		        	function Order(){};
		        	
		        	Order.prototype.init = function (){
		        		var purchase = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL');
						var obj = new Element ('object',{type: "text/html", data: purchase.data.url, standby: "Loading...", width: "100%",  height: "100%"});
						$("bodyDivOrder").update(obj);
					}
					
					var order = new Order();
					ScreenflowEngineFactory.getInstance().addScreenLoader("315", order.init);
		        &lt;/script&gt;
		    &lt;/head&gt;
		    &lt;body&gt;
		        &lt;div id="bodyDivOrder"&gt;
		        &lt;/div&gt;
		    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
		    &lt;head&gt;
		        &lt;script language="JavaScript"&gt;
		        	function Order(){};
		        	
		        	Order.prototype.init = function (){
		        		var purchase = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#PurchaseURL');
						var obj = new Element ('object',{type: "text/html", data: purchase.data.url, standby: "Loading...", width: "100%",  height: "100%"});
						$("bodyDivOrder").update(obj);
					}
					
					var order = new Order();
					ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", order.init);
		        &lt;/script&gt;
		    &lt;/head&gt;
		    &lt;body&gt;
		        &lt;div id="bodyDivOrder"&gt;
		        &lt;/div&gt;
		    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="316" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">316</field>
        <field type="TextField" name="code">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesSuggestion{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonSuggestion, #nextButtonSuggestion {
				visibility:hidden;
			}
			#loadingImgSuggestion{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
        &lt;script language="JavaScript"&gt;
        
        	function SuggestionList(){
	            //Next set of products to print in the table (0-9)
	            this.currentPage = 0;
	            //Product list fetched from the Service
	            this.productList = new Array();
	            //Are we waiting for data?
	            this.waiting = true;
            };
            
            SuggestionList.prototype.init = function (){
                $("nextButtonSuggestion").observe("click", suggestionList.nextPage);
                $("previousButtonSuggestion").observe("click", suggestionList.previousPage);
				$$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
				$$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
				var tableBody = $("listBodySuggestion");
                tableBody.update("");
                suggestionList.currentPage = 0;
	            suggestionList.productList = new Array();
	            suggestionList.waiting = true;
	            suggestionList.showProgress();
                suggestionList.fetch();
            }
            
            SuggestionList.prototype.fetch = function (){
            
            	//Get the facts to invoke the service
                var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
                var user = ScreenflowEngineFactory.getInstance().getFact('user');
                //Add the ItemSearch parameters
                var parameters = "";
				parameters += "&amp;ItemId=" + item.data.ASIN;
                
                //Base URL of the REST Service
				var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
				//Add the AccessKeyId (get from the user fact)
				/*if (user)
					url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
				else // if the KB doesn't contain a user key Id, add one by default
					url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
				//Add the operation Type
				url +="&amp;Operation=SimilarityLookup";
				//Add the parameters
				url += parameters;
				//Add the responseGroup
				url +="&amp;ResponseGroup=Medium";
				//Add the current version of the API
				url += "&amp;Version=2008-06-26";

						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
				//Invoke the service
                new FastAPI.Request(url,{
                    'method':       'get',
                    'content':      'xml',
                    'context':      suggestionList,
                    'onSuccess':    suggestionList.addToList
                });
            }
            
            SuggestionList.prototype.addToList = function (transport){
                var xml = transport;
                //Check if the service returned an error
                if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
                    alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
                }
                else { //Correct response, create the result List
                    var suggestionlist = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
                    //Fill the table, 1 row per item
                    $A(suggestionlist).each(function(item){
                        if (item.getElementsByTagName("Title").length &gt; 0) 
                            var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
			else
			    var title = "&amp;nbsp;";
                        if (item.getElementsByTagName("FormattedPrice").length &gt; 0) 
                            var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
			else
			    var price = "&amp;nbsp;";
                        if (item.getElementsByTagName("ProductGroup").length &gt; 0) 
                            var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
			else
			    var pGroup = "&amp;nbsp;";
                        if (item.getElementsByTagName("ASIN").length &gt; 0) 
                            var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
                        var row = {
                            title: title,
                            price: price,
                            pGroup: pGroup,
                            ASIN: ASIN
                        };
                        suggestionList.productList.push(row);
                    });
                    if (suggestionList.waiting) {
                        suggestionList.waiting = false;
                        suggestionList.showTable();
                    }
                }
            }
            
            
            SuggestionList.prototype.productDetail = function (nodeElement,_ASIN){
				list.clearSelected ();
				//select the element
				nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
				var item = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#Item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
				ScreenflowEngineFactory.getInstance().manageFacts([item],['product']);
			}
			
			SuggestionList.prototype.clearSelected = function (){
				$$("tbody tr").each(function (element){
					element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
				});
			}
			
			SuggestionList.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            SuggestionList.prototype.showProgress = function (){
                suggestionList.waiting = true;
                $("loadingImgSuggestion").show();
            }
            
            SuggestionList.prototype.showTable = function (){
            	if($("loadingImgSuggestion")){
                	$("loadingImgSuggestion").hide();
                }
                var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="suggestionList.productDetail(this,\'#{ASIN}\');"';
				templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodySuggestion");
                for (var i = 5 * suggestionList.currentPage; i &lt; 5 * (suggestionList.currentPage + 1); i++) { //print the appropriate elements
                    if (suggestionList.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(suggestionList.productList[i]);
                    }
                }
                //Update Interface
                if (suggestionList.currentPage &lt; 1) {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
                if (suggestionList.currentPage &gt; 0) {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
            }
            
            SuggestionList.prototype.nextPage = function (){
                //Clear the table
                var tableBody = $("listBodySuggestion");
                tableBody.update("");
                suggestionList.currentPage++;
                suggestionList.showTable();
				//update the current page in the interface
				 $("curPageSuggestion").update(suggestionList.currentPage+1);
            }
            
            SuggestionList.prototype.previousPage = function (){
                //Clear the table
                var tableBody = $("listBodySuggestion");
                tableBody.update("");
                suggestionList.currentPage--;
                suggestionList.showTable();
				//update the current page in the interface;
				$("curPageSuggestion").update(suggestionList.currentPage+1);
            }
            
            var suggestionList = new SuggestionList();
			ScreenflowEngineFactory.getInstance().addScreenLoader("316", suggestionList.init);
			
        &lt;/script&gt;&lt;/head&gt;&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Related products to&lt;/h1&gt;
			&lt;h1 id="title"&gt;&lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/h1&gt;
			&lt;div id="like"&gt;Customers who bought &lt;span class="productTitle"&gt;&lt;/span&gt;, also bought ...&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 60%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                Title
                            &lt;/th&gt;
                            &lt;th style="width: 10%;"&gt;
                                Price
                            &lt;/th&gt;
                            &lt;th style="width: 20%;"&gt;
                                Product Group
                            &lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                &amp;nbsp;
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodySuggestion"&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
		    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgSuggestion" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonSuggestion" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesSuggestion"&gt;
					Page &lt;span id="curPageSuggestion"&gt;1&lt;/span&gt;/2
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonSuggestion" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
				
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
	&lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"&gt;
		&lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/table.css" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#pagesSuggestion{
				color:#FEBF43;
				font-weight: bold;
				padding: 10px;
			}
			#previousButtonSuggestion, #nextButtonSuggestion {
				visibility:hidden;
			}
			#loadingImgSuggestion{
				margin:auto;
				padding-top: 10px;
			}
			#like{
				padding: 5px;
				color: #777777;
			}
			.productTitle{
				font-weight:bold;
				font-style:normal;
			}
			#amazonImage{
				position:absolute;
				right:0px;
				top:3px;
			}
		&lt;/style&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
		&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
        &lt;script language="JavaScript"&gt;
        
        	function SuggestionList(){
	            //Next set of products to print in the table (0-9)
	            this.currentPage = 0;
	            //Product list fetched from the Service
	            this.productList = new Array();
	            //Are we waiting for data?
	            this.waiting = true;
            };
            
            SuggestionList.prototype.init = function (){
                $("nextButtonSuggestion").observe("click", suggestionList.nextPage);
                $("previousButtonSuggestion").observe("click", suggestionList.previousPage);
				$$('input[type="button"]').each(function(element){
					element.observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				
				});
				var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
				$$(".productTitle").each(function(element){
					element.update(item.data.title);
				});
				var tableBody = $("listBodySuggestion");
                tableBody.update("");
                suggestionList.currentPage = 0;
	            suggestionList.productList = new Array();
	            suggestionList.waiting = true;
	            suggestionList.showProgress();
                suggestionList.fetch();
            }
            
            SuggestionList.prototype.fetch = function (){
            
            	//Get the facts to invoke the service
                var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
                var user = ScreenflowEngineFactory.getInstance().getFact('user');
                //Add the ItemSearch parameters
                var parameters = "";
				parameters += "&amp;ItemId=" + item.data.ASIN;
                
                //Base URL of the REST Service
				var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
				//Add the AccessKeyId (get from the user fact)
				/*if (user)
					url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
				else // if the KB doesn't contain a user key Id, add one by default
					url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
				//Add the operation Type
				url +="&amp;Operation=SimilarityLookup";
				//Add the parameters
				url += parameters;
				//Add the responseGroup
				url +="&amp;ResponseGroup=Medium";
				//Add the current version of the API
				url += "&amp;Version=2008-06-26";

						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
				//Invoke the service
                new FastAPI.Request(url,{
                    'method':       'get',
                    'content':      'xml',
                    'context':      suggestionList,
                    'onSuccess':    suggestionList.addToList
                });
            }
            
            SuggestionList.prototype.addToList = function (transport){
                var xml = transport;
                //Check if the service returned an error
                if (xml.getElementsByTagName("IsValid")[0].childNodes[0].nodeValue == "False") {
                    alert(xml.getElementsByTagName("Message")[0].childNodes[0].nodeValue);
                }
                else { //Correct response, create the result List
                    var suggestionlist = xml.getElementsByTagName("Items")[0].getElementsByTagName("Item");
                    //Fill the table, 1 row per item
                    $A(suggestionlist).each(function(item){
                        if (item.getElementsByTagName("Title").length &gt; 0) 
                            var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
			else
			    var title = "&amp;nbsp;";
                        if (item.getElementsByTagName("FormattedPrice").length &gt; 0) 
                            var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
			else
			    var price = "&amp;nbsp;";
                        if (item.getElementsByTagName("ProductGroup").length &gt; 0) 
                            var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
			else
			    var pGroup = "&amp;nbsp;";
                        if (item.getElementsByTagName("ASIN").length &gt; 0) 
                            var ASIN = item.getElementsByTagName("ASIN")[0].firstChild.nodeValue;
                        var row = {
                            title: title,
                            price: price,
                            pGroup: pGroup,
                            ASIN: ASIN
                        };
                        suggestionList.productList.push(row);
                    });
                    if (suggestionList.waiting) {
                        suggestionList.waiting = false;
                        suggestionList.showTable();
                    }
                }
            }
            
            
            SuggestionList.prototype.productDetail = function (nodeElement,_ASIN){
				list.clearSelected ();
				//select the element
				nodeElement.parentNode.parentNode.setStyle({background: "#FFF8E8"});
				var item = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#Item', data:{ASIN: _ASIN, title: nodeElement.parentNode.parentNode.firstChild.firstChild.nodeValue}};
				ScreenflowEngineFactory.getInstance().manageFacts([item],['product']);
			}
			
			SuggestionList.prototype.clearSelected = function (){
				$$("tbody tr").each(function (element){
					element.setStyle ({background: "transparent url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td1.jpg) repeat-x top"});
				});
			}
			
			SuggestionList.prototype.onError = function (transport){
                //alert(transport.responseText);
            }
            
            SuggestionList.prototype.showProgress = function (){
                suggestionList.waiting = true;
                $("loadingImgSuggestion").show();
            }
            
            SuggestionList.prototype.showTable = function (){
            	if($("loadingImgSuggestion")){
                	$("loadingImgSuggestion").hide();
                }
                var templateString = '&lt;tr&gt;&lt;td&gt;#{title}&lt;/td&gt;&lt;td&gt;#{price}&lt;/td&gt;&lt;td&gt;#{pGroup}&lt;/td&gt;';
                templateString += '&lt;td style="border-right:none;"&gt;&lt;input type="button" onclick="suggestionList.productDetail(this,\'#{ASIN}\');"';
				templateString += ' onmouseover="this.setStyle({cursor:\'pointer\'});" value="Select"/&gt;&lt;/td&gt;&lt;/tr&gt;';
                var rowTemplate = new Template(templateString);
                
                var tableBody = $("listBodySuggestion");
                for (var i = 5 * suggestionList.currentPage; i &lt; 5 * (suggestionList.currentPage + 1); i++) { //print the appropriate elements
                    if (suggestionList.productList[i]) { //only if the product table is fetched
                        tableBody.innerHTML += rowTemplate.evaluate(suggestionList.productList[i]);
                    }
                }
                //Update Interface
                if (suggestionList.currentPage &lt; 1) {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("nextButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
                if (suggestionList.currentPage &gt; 0) {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "visible"
                    });
                }
                else {
                    $("previousButtonSuggestion").setStyle({
                        visibility: "hidden"
                    });
                }
            }
            
            SuggestionList.prototype.nextPage = function (){
                //Clear the table
                var tableBody = $("listBodySuggestion");
                tableBody.update("");
                suggestionList.currentPage++;
                suggestionList.showTable();
				//update the current page in the interface
				 $("curPageSuggestion").update(suggestionList.currentPage+1);
            }
            
            SuggestionList.prototype.previousPage = function (){
                //Clear the table
                var tableBody = $("listBodySuggestion");
                tableBody.update("");
                suggestionList.currentPage--;
                suggestionList.showTable();
				//update the current page in the interface;
				$("curPageSuggestion").update(suggestionList.currentPage+1);
            }
            
            var suggestionList = new SuggestionList();
			ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", suggestionList.init);
			
        &lt;/script&gt;&lt;/head&gt;&lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.png" /&gt;&lt;/span&gt;
            &lt;h1 id="title"&gt;Related products to&lt;/h1&gt;
			&lt;h1 id="title"&gt;&lt;span class="productTitle"&gt;&lt;/span&gt;&lt;/h1&gt;
			&lt;div id="like"&gt;Customers who bought &lt;span class="productTitle"&gt;&lt;/span&gt;, also bought ...&lt;/div&gt;
            &lt;div id="listDiv"&gt;
                &lt;table&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th style="width: 60%; -moz-border-radius-topleft: 13px; -moz-border-radius-topright: 0px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                Title
                            &lt;/th&gt;
                            &lt;th style="width: 10%;"&gt;
                                Price
                            &lt;/th&gt;
                            &lt;th style="width: 20%;"&gt;
                                Product Group
                            &lt;/th&gt;
                            &lt;th style="width: 10%; -moz-border-radius-topleft: 0px; -moz-border-radius-topright: 13px; -moz-border-radius-bottomright: 0px; -moz-border-radius-bottomleft: 0px;"&gt;
                                &amp;nbsp;
                            &lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody id="listBodySuggestion"&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
	                            &lt;tr&gt;
					&lt;td&gt;&amp;nbsp;&lt;/td&gt;
				    &lt;/tr&gt;
		    &lt;/tbody&gt;
                &lt;/table&gt;
                &lt;img style="display: none;" id="loadingImgSuggestion" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/ajaxLoader.gif"&gt;
                &lt;div id="buttonContainerDiv"&gt;
                    &lt;input style="visibility: hidden;" id="previousButtonSuggestion" class="button" value="&amp;lt;" type="button"&gt;
					&lt;span id="pagesSuggestion"&gt;
					Page &lt;span id="curPageSuggestion"&gt;1&lt;/span&gt;/2
					&lt;/span&gt;&lt;input style="visibility: visible;" id="nextButtonSuggestion" class="button" value="&amp;gt;" type="button"&gt;
                &lt;/div&gt;
				
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="317" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">317</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#bodyDiv{
				max-width: 550px;
			}
			#searchArea {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:50px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:98%;
			}
			#contents{
				padding:12px;
			}
			#send{
				margin-left: 15px;
			}
			#amazonImage{
				position:absolute;
				right:2px;
				top:3px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}

		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        	function Search(){};
        	
        	Search.prototype.init = function (){
				//List of possible searches
				var searchIndices = ["All","Apparel","Automotive","Baby","Beauty","Blended",
									 "Books","Classical", "DigitalMusic","DVD","Electronics",
									 "GourmetFood","HealthPersonalCare","HomeGarden","Industrial",
									 "Jewelry","KindleStore","Kitchen","Magazines","Merchants",
									 "Miscellaneous","MP3Downloads","Music","MusicalInstruments",
									 "MusicTracks","OfficeProducts","OutdoorLiving","PCHardware",
									 "PetSupplies","Photo","SilverMerchants","Software","SportingGoods",
									 "Tools","Toys","UnboxVideo","VHS","Video","VideoGames","Watches",
									 "Wireless","WirelessAccessories"];
				$("send").observe("click", search.send);
				$("send").observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				//Populate the product type select element
				search.populateOptions(searchIndices);
			}
			
			Search.prototype.populateOptions = function (_list){
				var templateString = "&lt;option value ='#{element}'&gt;#{caption}&lt;/option&gt;";
				var template = new Template(templateString);
				var optionHTML = "";
				$A(_list).each (function (element){
					optionHTML += template.evaluate({"element":element,"caption":search.separate(element)});
				});
				$("productType").update(optionHTML);
			}
			
			//This function returns a human readable element, 
			//separating words by white-spaces
			Search.prototype.separate = function (element){
				//Workaround for special cases
				//TODO: Create a generic solution, maybe another regexp?
				if (element=="DVD" || element=="VHS" || element=="MP3Downloads" || element=="PCHardware"){
					if (element=="MP3Downloads")
						return "MP3 Downloads";
					if (element=="PCHardware")
						return "PC Hardware";
					return element;
				}
				else{
					var result = element.replace(/([A-Z])/g, " $1");
					//Remove first white-space when necessary
					result = (result[0]==" "?result.substring(1,result.length):result);
					return result;
				}
			}
			
			Search.prototype.send = function (){
				if ($F("searchText").length==0){ //Empty keywords are forbidden
					alert ("You must introduce at least one keyword");
					return;
				}
				var filter = {uri: 'http://localhost:9000/FASTCatalogue/concepts/generic/SearchCriteria', data:{productType: $F("productType"), keywords: $F("searchText")}};
				ScreenflowEngineFactory.getInstance().manageFacts([filter],[]);
			}
			
			var search = new Search();
			ScreenflowEngineFactory.getInstance().addScreenLoader("317", search.init);
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/fast/images/gui/fastLogo.png" /&gt;&lt;/span&gt;
        	&lt;h1 id="title"&gt;Product Search&lt;/h1&gt;
			&lt;div id="searchArea"&gt;
				&lt;div id="contents"&gt;
					&lt;span class="title"&gt;Keywords: &lt;/span&gt; &lt;input type="text" id="searchText" /&gt;
					&lt;select id="productType"&gt;			
					&lt;/select&gt;
					&lt;input type="button" id="send" value="Search" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;       
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
			#bodyDiv{
				max-width: 550px;
			}
			#searchArea {
				border: 1px solid #F8A704;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				height:50px;
				margin:5px auto 0px;
				padding:0px;
				text-align:center;
				width:98%;
			}
			#contents{
				padding:12px;
			}
			#send{
				margin-left: 15px;
			}
			#amazonImage{
				position:absolute;
				right:2px;
				top:3px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}

		&lt;/style&gt;
        &lt;script language="JavaScript"&gt;
        	function Search(){};
        	
        	Search.prototype.init = function (){
				//List of possible searches
				var searchIndices = ["All","Apparel","Automotive","Baby","Beauty","Blended",
									 "Books","Classical", "DigitalMusic","DVD","Electronics",
									 "GourmetFood","HealthPersonalCare","HomeGarden","Industrial",
									 "Jewelry","KindleStore","Kitchen","Magazines","Merchants",
									 "Miscellaneous","MP3Downloads","Music","MusicalInstruments",
									 "MusicTracks","OfficeProducts","OutdoorLiving","PCHardware",
									 "PetSupplies","Photo","SilverMerchants","Software","SportingGoods",
									 "Tools","Toys","UnboxVideo","VHS","Video","VideoGames","Watches",
									 "Wireless","WirelessAccessories"];
				$("send").observe("click", search.send);
				$("send").observe("mouseover",function(event){
						var e = Event.element(event);
						e.setStyle({cursor:"pointer"});
					});
				//Populate the product type select element
				search.populateOptions(searchIndices);
			}
			
			Search.prototype.populateOptions = function (_list){
				var templateString = "&lt;option value ='#{element}'&gt;#{caption}&lt;/option&gt;";
				var template = new Template(templateString);
				var optionHTML = "";
				$A(_list).each (function (element){
					optionHTML += template.evaluate({"element":element,"caption":search.separate(element)});
				});
				$("productType").update(optionHTML);
			}
			
			//This function returns a human readable element, 
			//separating words by white-spaces
			Search.prototype.separate = function (element){
				//Workaround for special cases
				//TODO: Create a generic solution, maybe another regexp?
				if (element=="DVD" || element=="VHS" || element=="MP3Downloads" || element=="PCHardware"){
					if (element=="MP3Downloads")
						return "MP3 Downloads";
					if (element=="PCHardware")
						return "PC Hardware";
					return element;
				}
				else{
					var result = element.replace(/([A-Z])/g, " $1");
					//Remove first white-space when necessary
					result = (result[0]==" "?result.substring(1,result.length):result);
					return result;
				}
			}
			
			Search.prototype.send = function (){
				if ($F("searchText").length==0){ //Empty keywords are forbidden
					alert ("You must introduce at least one keyword");
					return;
				}
				var filter = {uri: 'http://localhost:9000/FASTCatalogue/concepts/generic/SearchCriteria', data:{productType: $F("productType"), keywords: $F("searchText")}};
				ScreenflowEngineFactory.getInstance().manageFacts([filter],[]);
			}
			
			var search = new Search();
			ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", search.init);
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="bodyDiv"&gt;
        	&lt;span id="amazonImage"&gt;&lt;img src="http://demo.fast.morfeo-project.org/fast/images/gui/fastLogo.png" /&gt;&lt;/span&gt;
        	&lt;h1 id="title"&gt;Product Search&lt;/h1&gt;
			&lt;div id="searchArea"&gt;
				&lt;div id="contents"&gt;
					&lt;span class="title"&gt;Keywords: &lt;/span&gt; &lt;input type="text" id="searchText" /&gt;
					&lt;select id="productType"&gt;			
					&lt;/select&gt;
					&lt;input type="button" id="send" value="Search" /&gt;
				&lt;/div&gt;
			&lt;/div&gt;       
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="318" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">318</field>
        <field type="TextField" name="code">&lt;html&gt;
		    &lt;head&gt;
		        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
		        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
				&lt;style type="text/css"&gt;
					#productImage{
						height: 170px;
						-moz-border-radius: 13px 13px;
						background: #FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
						border:1px solid #F8A704;
						margin:0px auto 13px;
						text-align:center;
						width:88%;
						padding-bottom:5px;
						padding-top:10px;
					}
					#leftColumn{
						position: relative;
						float:left;
						height: 100%;
						width: 35%;
					}
					#rightColumn{
						position: relative;
						float:right;
						height: 268px;
						width: 60%;
						-moz-border-radius:13px 13px;
						background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
						border:1px solid #F8A704;
						padding-top:5px;
						padding-right:0px;
						padding-left:5px;
						padding-bottom: 5px;
						position:relative;
					}
					#infoArea{
						text-align: left;
					}
					#titleInfo{
						float:left;
						margin: 5px;
						width:35%;
						overflow: hidden;
					}
					#valueInfo{
						float:left;
						margin: 5px 15px 5px 5px;
						width: 50%;
					}
					#moreInfo{
						float:left;
						margin-left: 5px;
					}
					.title{
						padding: 2px;
						color:#AAAAAA;
						font-weight: bold;
						font-family:Arial,Helvetica,sans-serif;	
						white-space:nowrap;
						overflow: hidden;
					}
					.info{
						padding: 2px;
						color:#888888;
						font-family:Arial,Helvetica,sans-serif;
						font-weight: bold;
						text-align: justify;
						white-space: nowrap;
						overflow: hidden;
					}
					#quantity {
						margin: 5px;
						color:#777777;
						font-weight: bold;
						font-family:Arial,Helvetica,sans-serif;
					}
					#cart {
						border: 1px solid #F8A704;
						-moz-border-radius:13px 13px;
						background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/bg_td2.jpg) repeat-x;
						border:1px solid #F8A704;
						height:78px;
						margin:5px auto 0px;
						padding:0px;
						text-align:center;
						width:88%;
					}
					#moreInfoText {
						color:#888888;
						font-family:Arial,Helvetica,sans-serif;
						font-size:13px;
						height:133px;
						margin:0;
						overflow:auto;
						padding:2px 15px 2px 2px;
						text-align:left;
						width:300px;
						max-width:300px;
					}
					.detailsElement {
						color:#888888;
						font-weight:bold;
					}
					#bodyDivDetails {
						max-width:550px;
						text-align:center;
						margin: 8px auto 20px auto;
						height:270px;
					}
					#amazonImage{
						position:absolute;
						right:0px;
						top:3px;
					}
				&lt;/style&gt;
				&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
				&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
		        &lt;script language="JavaScript"&gt;
		        
		        	function Product(){};
		        	
		        	Product.prototype.init = function (){
						var user = ScreenflowEngineFactory.getInstance().getFact('user');
						var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
						$("addToCart").observe("click", product.addToCart);
						//Base URL of the REST Service
						var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
						//Add the AccessKeyId (get from the user fact)
						/*if (user)
							url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
						else // if the KB doesn't contain a user key Id, add one by default
							url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
						//Add the operation Type
						url +="&amp;Operation=ItemLookup";
						//Add the responseGroup
						url +="&amp;ResponseGroup=Medium";
						//Add the current version of the API
						url += "&amp;Version=2008-06-26";
						//Add item ID
						url += "&amp;ItemId=" + item.data.ASIN;
						
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
						//Invoke the service
		                new FastAPI.Request(url,{
		                    'method':       'get',
		                    'content':      'xml',
		                    'context':      product,
		                    'onSuccess':    product.fetchProductInfo
		                });
					}
					
					Product.prototype.fetchProductInfo = function (transport){
						var xml = transport;
						var item = xml.getElementsByTagName("Item")[0];
						if (item.getElementsByTagName("Title").length &gt; 0)
							var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
						 if (item.getElementsByTagName("FormattedPrice").length &gt; 0) 
		                    var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
		                if (item.getElementsByTagName("ProductGroup").length &gt; 0) 
		                    var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
		                if (item.getElementsByTagName("DetailPageURL").length &gt; 0) 
		                    var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
		                if (item.getElementsByTagName("MediumImage").length &gt; 0) 
		                    var image = item.getElementsByTagName("MediumImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
						var _product = {
							title: title,
							price: price,
							pGroup: pGroup,
							url: url,
							image: image
						};
						product.showProductInfo (_product);
						product.showAdvancedDetails (item,pGroup);
						
						$("quantitySelect").value=1;
					}
					
					Product.prototype.showProductInfo = function (_product){
						if (_product.title){
							//Reset styles
							$("productTitle").setStyle ({"fontSize":"20px"});
							$("moreInfoText").setStyle({"height": "133px"});
							$("productTitle").update(_product.title);
							if ($("productTitle").clientHeight &gt; 28){//Big title
								//Big title, adapt styles
								$("productTitle").setStyle ({"fontSize":"16px"});
								if ($("productTitle").clientHeight &gt; 23) {//More than one line
									if ($("productTitle").clientHeight &gt; 46){//More than two lines
										if ($("productTitle").clientHeight &gt; 69){//More than three lines
											$("productTitle").setStyle ({"fontSize":"13px"});
											if ($("productTitle").clientHeight &gt; 49) //Still more than three lines
												$("moreInfoText").setStyle({"height": "90px"});
											else
												$("moreInfoText").setStyle({"height": "110px"});
										} 
										else{//Three lines
											$("moreInfoText").setStyle({"height": "110px"});
											$("productTitle").setStyle ({"fontSize":"14px"});	
										}
									}
									else //Two lines
										$("moreInfoText").setStyle({"height": "115px"});	
								}
								/*else //One line, 16px title
		 							$("moreInfoText").setStyle({
										"height": "125px"
									});*/
							}
							
						}
						if (_product.price){
							$("price").update(_product.price);
						} else {
							$("price").update("");
						}
						if (_product.pGroup){
							$("pGroup").update(_product.pGroup);
						} else {
							$("pGroup").update("");
						}
						if (_product.url){
							var a = new Element('a',{href:_product.url,target:"_blank"}).update ("Amazon");
							$("url").update (a);
						} else {
							$("url").update ("");
						}
						if (_product.image){
							var img = new Element ('img',{src: _product.image});
							$("productImage").update(img);
						} else {
							var img = new Element ('img',{src: "http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.jpg"});
							$("productImage").update(img);	
						}
										
					}
					
					Product.prototype.showAdvancedDetails = function (element,pGroup){
						/*List of possible product groups (with * groups already considered)
						 * Apparel,Baby Product,Beauty,*Book,*CE,*DVD,*eBooks,Furniture,Gourmet,Health and Beauty,
						 * Home,Home Improvement,Kitchen,Lawn &amp; Patio,Magazine,*Music,Musical Instruments,
						 * Office Product,*Personal Computer,Pet Products,*Photography,Single Detail Page Misc,
						 * *Software,Sports,*Theatrical Release,Toy,*Video,*Video Games,Watch,*Wireless,*Wireless Phone Accessory
						 */
						var itemAttributes = element.getElementsByTagName("ItemAttributes")[0];
						var attributesHTML = "&lt;ul&gt;";
						//List of elements to be shown
						var elementList = [];
						switch (pGroup){
							case "eBooks":
							case "Book":
								//Print all book authors
								attributesHTML += product.elementDetail("Author",itemAttributes,"Author(s)");
								//Print the remainder features
								elementList = [{nodeElement:"PublicationDate",caption:"Publication Date"},
											   "ISBN",
											   "Format",
											   {nodeElement:"Label", caption:"Publisher"},
											   {nodeElement:"NumberOfPages", caption:"Pages"}];	
							    attributesHTML += product.productDetailsList(elementList,itemAttributes);	
								break;
							case "Theatrical Release":
							case "Video":
							case "DVD":
								//Print all actors
								attributesHTML += product.elementDetail("Actor",itemAttributes,"Cast");
								//Print all directors
								attributesHTML += product.elementDetail("Director",itemAttributes);
								elementList = 	["Genre",
												{nodeElement:"RunningTime",caption: "Run Time"},
												{nodeElement:"AudienceRating", caption:"Audience Rating"},
												"Label",
												"Binding",
												"Region",
												{nodeElement:"AspectRatio", caption:"Aspect Ratio"},
												{nodeElement:"OriginalReleaseDate", caption:"Release Date"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.twoElements ("DVDLayers","DVDSides",itemAttributes,"DVD Layers / Sides");
								//Print technical details
								attributesHTML += product.elementDetail("Format",itemAttributes);
								break;
							case "Digital Music Track":
							case "Music":
								elementList = 	["Artist",
												"Genre",
												"Label",
												"Binding",
												"Format",
												{nodeElement:"NumberOfDiscs", caption:"Number of Discs"},
												{nodeElement:"ReleaseDate", caption:"Release Date"},
												{nodeElement:"OriginalReleaseDate", caption:"Original Release Date"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								break;
							case "Photography":
								//Print details 
								elementList = ["Brand","Model"];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);	
								//Print all camera features
								attributesHTML += product.elementDetail("Feature",itemAttributes,"Features",".");
								break;
							case "Personal Computer":
								elementList = 	["Model",
												"Label",
												"Binding"];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.twoElements ("CPUType","CPUSpeed",itemAttributes,"CPU", " ");
								elementList = 	[{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"HardDiskSize", caption:"Hard Disk Size"},
												{nodeElement:"DataLinkProtocol", caption:"Data Link Protocol"},
												{nodeElement:"FloppyDiskDriveDescription", caption:"Floppy Disk Drive"}];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.twoElements ("SystemMemorySize","SystemMemoryType",itemAttributes,"Memory", " ");								
								elementList = 	[{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												"Warranty",
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];	
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += product.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features
								attributesHTML += product.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							case "CE":
							case "Video Games":						
							case "Software":
							case "Wireless":
							case "Wireless Phone Accessory":
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"ESRBAgeRating", caption:"Age Rating"},
												{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += product.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features (only CE)
								attributesHTML += product.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							default:
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"ReleaseDate",caption:"Release Date"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.elementDetail("Feature",itemAttributes, "Features",".");
								break;				
						}
						attributesHTML += "&lt;/ul&gt;";
						if (attributesHTML.length&gt;9){//There is something to show
							$("moreInfoText").update(attributesHTML);
							$("moreInfoText").setStyle({"borderTop":"1px dotted #AAAAAA"});
							$("moreInfoTitle").update("Product Details");
						} 
							
					}
					//This function returns a html with pre-formatted details list
					//Each element of attributesList can be an object with two elements (nodeElement and caption)
					//or simply a string representing both of them
					Product.prototype.productDetailsList = function (attributesList,attributesNode){
						var result = "";
						$A(attributesList).each(function(attribute){
								var element = attributesNode.getElementsByTagName ((attribute.nodeElement?attribute.nodeElement:attribute));						
								if (element.length &gt; 0) {
									result += "&lt;li&gt;" + (attribute.caption?attribute.caption:attribute) + ": ";
									result += "&lt;span class='detailsElement'&gt;";
									result += element[0].firstChild.nodeValue;
									if (element[0].getAttribute("Units") &amp;&amp; element[0].getAttribute("Units")!= "unknown-units")
										result += " " + element[0].getAttribute("Units");
									result += "&lt;/span&gt;&lt;/li&gt;";
								}
						});
						return result;
					}
					//This function produces a single li with a list of elements (authors, features...)
					//caption parameter is optional
					//separationCharacter parameter is optional
					Product.prototype.elementDetail = function (element,attributesNode,caption,separationCharacter){
							var list = attributesNode.getElementsByTagName(element);
							var result = "";
							if (list.length &gt; 0){
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								$A(list).each (function (e){
									result += e.firstChild.nodeValue + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					}
					//This function produces a single li with a list of features. The original line has 
					//extrange separators
					//caption parameter is optional
					//separationCharacter parameter is optional
					Product.prototype.specialElementDetail = function (element,attributesNode,beforeSeparationCharacter,caption,separationCharacter){
							var element = attributesNode.getElementsByTagName(element);
							var result = "";
							if (element.length &gt; 0){
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								var list = element[0].firstChild.nodeValue.split(beforeSeparationCharacter);
								$A(list).each (function (e){
									result += e + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					}
					//This function produces a single li two elements separated by "/"
					//caption parameter is optional
					//separationCharacter is optional
					Product.prototype.twoElements = function (element1,element2,attributesNode, caption, separationCharacter){
							var _element1 = attributesNode.getElementsByTagName(element1);
							var _element2 = attributesNode.getElementsByTagName(element2);
							var result = "";
							//At least one correct element
							if (_element1.length &gt; 0 || _element2.length &gt; 0){
								result += "&lt;li&gt;" + (caption?caption:(element1 + " / " + element2))  + ": &lt;span class='detailsElement'&gt;";
								result += (_element1[0]?_element1[0].firstChild.nodeValue:"-");
								if (_element1[0].getAttribute("Units") &amp;&amp; _element1[0].getAttribute("Units")!= "unknown-units")
										result += " " + _element1[0].getAttribute("Units");
								result += (separationCharacter?separationCharacter:" / ");
								result += (_element2[0]?_element2[0].firstChild.nodeValue:"-");
								if (_element2[0].getAttribute("Units") &amp;&amp; _element2[0].getAttribute("Units")!= "unknown-units")
										result += " " + _element2[0].getAttribute("Units");
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;
					}
					
					Product.prototype.onError = function (transport){
		                //alert(transport.responseText);
		            }
		            
		            Product.prototype.addToCart = function (){
						var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
						var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
						var user = ScreenflowEngineFactory.getInstance().getFact('user');
						if (cart){//If the cart is already created, it will have an ID in the User Fact
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartGet";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;CartId=" + cart.data.id;
							url += "&amp;HMAC=" + cart.data.HMAC;
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
	                        new FastAPI.Request(url,{
	                            'method':       'get',
	                            'content':      'xml',
	                            'context':      product,
	                            'onSuccess':    product.isProductOnCart
	                        });
						}
						else { //Cart doesn't exist: Create a new cart with the product
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartCreate";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;Item.1.ASIN=" + item.data.ASIN;
							url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
	                    	new FastAPI.Request(url,{
                                'method':       'get',
                                'content':      'xml',
                                'context':      product,
                                'onSuccess':    product.cartCreated
                            });
						}
					}
					
					Product.prototype.cartCreated = function (transport){
						var xml = transport;
						
						//The product is added to the cart,
						//tell it to the user	
						if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True"){
							
							//Check if the product is eligible for shopping
							if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
								xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
								//The product is not elegible
								alert ("The product is not eligible to be added to the cart");
								return;
							}
							//Add the Cart ID to the KB
							var cart = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart',
										data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
											HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
							ScreenflowEngineFactory.getInstance().manageFacts([cart],[]);
							alert ("Product added to the shopping Cart");
						}		
						else 
							alert ("Error adding the product to the cart");
					}
					
					Product.prototype.productAdded = function (transport){
						var xml = transport;
						//Check if the product is eligible for shopping
						if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
							xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
							//The product is not elegible
							alert ("The product is not eligible to be added to the cart");
							return;
						}
						//If the product is added to the cart,
						//tell it to the user	
						if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True")
							alert ("Product added to the shopping Cart");
						else 
							alert ("Error adding the product to the cart");
					}		
					
					Product.prototype.isProductOnCart = function (transport){
						
						var xml = transport;
						var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
						var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
						var user = ScreenflowEngineFactory.getInstance().getFact('user');
						//products node
						if (xml.getElementsByTagName ("CartItems").length&gt;0){ //There are products on the cart
								var products = xml.getElementsByTagName ("CartItems")[0];
								//Product list (ASINs) added to the cart
								var asins = $A(products.getElementsByTagName ("ASIN"));
								//Check if the product is already added to the cart
								var found = false;
								//product Node
								var _product; 
								asins.each (function(asin){
									if (asin.firstChild.nodeValue == item.data.ASIN)
									{
										found = true; //The product is in the list
										_product = asin.parentNode; //product = CartItem
									}
								});
						}
						else {//If there aren't elements, the product will not be on the list
							found = false;
						}
						if (found) { 
							//If the product is already added to the cart,
							//increase the number of items of that product (CartModify)			
							//Get the item quantity
							var prevQuantity = _product.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
							//Add the new quantity to the previously stored
							var quantity = parseInt($F("quantitySelect")) + parseInt (prevQuantity);
							
							//Get the product Id within the cart
							var productId = _product.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;	
		
							//Create the call
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartModify";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;CartId=" + cart.data.id;
							url += "&amp;HMAC=" + cart.data.HMAC;
							url += "&amp;Item.1.CartItemId=" + productId;
							url += "&amp;Item.1.Quantity=" + quantity;
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
                            new FastAPI.Request(url,{
                                'method':       'get',
                                'content':      'xml',
                                'context':      product,
                                'onSuccess':    product.productAdded
                            });
						}
						else {
		                    //Create the call
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartAdd";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;CartId=" + cart.data.id;
							url += "&amp;HMAC=" + cart.data.HMAC;
							url += "&amp;Item.1.ASIN=" + item.data.ASIN;
							url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
                            new FastAPI.Request(url,{
                                'method':       'get',
                                'content':      'xml',
                                'context':      product,
                                'onSuccess':    product.productAdded
                            });
						}
					}
					
					var product = new Product();
					ScreenflowEngineFactory.getInstance().addScreenLoader("318", product.init);
		        &lt;/script&gt;
		    &lt;/head&gt;
		    &lt;body&gt;
		        &lt;div id="bodyDivDetails"&gt;
		        	&lt;div id="leftColumn"&gt;
				     	&lt;div id="productImage"&gt;
						&lt;/div&gt;
						&lt;div id="cart"&gt;
							&lt;div id="quantity"&gt;Quantity:  	&lt;select id="quantitySelect"&gt;
										  	&lt;option value ="1"&gt;1&lt;/option&gt;
										  	&lt;option value ="2"&gt;2&lt;/option&gt;
										  	&lt;option value ="3"&gt;3&lt;/option&gt;
										  	&lt;option value ="4"&gt;4&lt;/option&gt;
										  	&lt;option value ="5"&gt;5&lt;/option&gt;	
										 	&lt;option value ="6"&gt;6&lt;/option&gt;
										  	&lt;option value ="7"&gt;7&lt;/option&gt;	
										  	&lt;option value ="8"&gt;8&lt;/option&gt;		
											&lt;option value ="9"&gt;9&lt;/option&gt;	
										  	&lt;option value ="10"&gt;10&lt;/option&gt;						
											&lt;/select&gt;
							&lt;/div&gt;
							&lt;input border="0" height="27" width="160" type="image" id="addToCart" alt="Add to Shopping Cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart.gif"/&gt;
						&lt;/div&gt;       	
					&lt;/div&gt;
					&lt;div id="rightColumn"&gt;
						&lt;div id="productTitle" style="font-size: 20px; padding: 2px; color:#F8A704; font-weight: bold; font-style: italic; font-family:Arial,Helvetica,sans-serif; overflow: hidden;"&gt;&lt;/div&gt;
						&lt;div id="infoArea"&gt;
							&lt;span id="titleInfo"&gt;
								&lt;div class="title"&gt;Product Type: &lt;/div&gt;
								&lt;div class="title"&gt;Price: &lt;/div&gt;
								&lt;div class="title"&gt;Product Site: &lt;/div&gt;
								&lt;div class="title" id="titleInfo1"&gt;&lt;/div&gt;
							&lt;/span&gt;
							&lt;span id="valueInfo"&gt;
								&lt;div id="pGroup" class="info"&gt;&lt;/div&gt;
								&lt;div id="price" class="info"&gt;&lt;/div&gt;
								&lt;div id="url" class="info"&gt;&lt;/div&gt;
								&lt;div id="info1" class="info"&gt;&lt;/div&gt;
							&lt;/span&gt;
							&lt;div id="moreInfo"&gt;
								&lt;div class="title" id="moreInfoTitle"&gt;&lt;/div&gt;
								&lt;div id="moreInfoText"&gt;
								&lt;/div&gt;
							&lt;/div&gt;
						&lt;/div&gt;
					&lt;/div&gt;
		        &lt;/div&gt;
		    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
		    &lt;head&gt;
		        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
		        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
				&lt;style type="text/css"&gt;
					#productImage{
						height: 170px;
						-moz-border-radius: 13px 13px;
						background: #FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
						border:1px solid #F8A704;
						margin:0px auto 13px;
						text-align:center;
						width:88%;
						padding-bottom:5px;
						padding-top:10px;
					}
					#leftColumn{
						position: relative;
						float:left;
						height: 100%;
						width: 35%;
					}
					#rightColumn{
						position: relative;
						float:right;
						height: 268px;
						width: 60%;
						-moz-border-radius:13px 13px;
						background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
						border:1px solid #F8A704;
						padding-top:5px;
						padding-right:0px;
						padding-left:5px;
						padding-bottom: 5px;
						position:relative;
					}
					#infoArea{
						text-align: left;
					}
					#titleInfo{
						float:left;
						margin: 5px;
						width:35%;
						overflow: hidden;
					}
					#valueInfo{
						float:left;
						margin: 5px 15px 5px 5px;
						width: 50%;
					}
					#moreInfo{
						float:left;
						margin-left: 5px;
					}
					.title{
						padding: 2px;
						color:#AAAAAA;
						font-weight: bold;
						font-family:Arial,Helvetica,sans-serif;	
						white-space:nowrap;
						overflow: hidden;
					}
					.info{
						padding: 2px;
						color:#888888;
						font-family:Arial,Helvetica,sans-serif;
						font-weight: bold;
						text-align: justify;
						white-space: nowrap;
						overflow: hidden;
					}
					#quantity {
						margin: 5px;
						color:#777777;
						font-weight: bold;
						font-family:Arial,Helvetica,sans-serif;
					}
					#cart {
						border: 1px solid #F8A704;
						-moz-border-radius:13px 13px;
						background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/bg_td2.jpg) repeat-x;
						border:1px solid #F8A704;
						height:78px;
						margin:5px auto 0px;
						padding:0px;
						text-align:center;
						width:88%;
					}
					#moreInfoText {
						color:#888888;
						font-family:Arial,Helvetica,sans-serif;
						font-size:13px;
						height:133px;
						margin:0;
						overflow:auto;
						padding:2px 15px 2px 2px;
						text-align:left;
						width:300px;
						max-width:300px;
					}
					.detailsElement {
						color:#888888;
						font-weight:bold;
					}
					#bodyDivDetails {
						max-width:550px;
						text-align:center;
						margin: 8px auto 20px auto;
						height:270px;
					}
					#amazonImage{
						position:absolute;
						right:0px;
						top:3px;
					}
				&lt;/style&gt;
				&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/signAmazonURLs.js"&gt;&lt;/script&gt;
				&lt;script language="JavaScript" src="http://demo.fast.morfeo-project.org/gvsdata/amazonURL/jssha2/sha2.js"&gt;&lt;/script&gt;
		        &lt;script language="JavaScript"&gt;
		        
		        	function Product(){};
		        	
		        	Product.prototype.init = function (){
						var user = ScreenflowEngineFactory.getInstance().getFact('user');
						var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
						$("addToCart").observe("click", product.addToCart);
						//Base URL of the REST Service
						var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
						//Add the AccessKeyId (get from the user fact)
						/*if (user)
							url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
						else // if the KB doesn't contain a user key Id, add one by default
							url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
						//Add the operation Type
						url +="&amp;Operation=ItemLookup";
						//Add the responseGroup
						url +="&amp;ResponseGroup=Medium";
						//Add the current version of the API
						url += "&amp;Version=2008-06-26";
						//Add item ID
						url += "&amp;ItemId=" + item.data.ASIN;
						
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
						//Invoke the service
		                new FastAPI.Request(url,{
		                    'method':       'get',
		                    'content':      'xml',
		                    'context':      product,
		                    'onSuccess':    product.fetchProductInfo
		                });
					}
					
					Product.prototype.fetchProductInfo = function (transport){
						var xml = transport;
						var item = xml.getElementsByTagName("Item")[0];
						if (item.getElementsByTagName("Title").length &gt; 0)
							var title = item.getElementsByTagName("Title")[0].firstChild.nodeValue;
						 if (item.getElementsByTagName("FormattedPrice").length &gt; 0) 
		                    var price = item.getElementsByTagName("FormattedPrice")[0].firstChild.nodeValue;
		                if (item.getElementsByTagName("ProductGroup").length &gt; 0) 
		                    var pGroup = item.getElementsByTagName("ProductGroup")[0].firstChild.nodeValue;
		                if (item.getElementsByTagName("DetailPageURL").length &gt; 0) 
		                    var url = item.getElementsByTagName("DetailPageURL")[0].firstChild.nodeValue;
		                if (item.getElementsByTagName("MediumImage").length &gt; 0) 
		                    var image = item.getElementsByTagName("MediumImage")[0].getElementsByTagName("URL")[0].firstChild.nodeValue;
						var _product = {
							title: title,
							price: price,
							pGroup: pGroup,
							url: url,
							image: image
						};
						product.showProductInfo (_product);
						product.showAdvancedDetails (item,pGroup);
						
						$("quantitySelect").value=1;
					}
					
					Product.prototype.showProductInfo = function (_product){
						if (_product.title){
							//Reset styles
							$("productTitle").setStyle ({"fontSize":"20px"});
							$("moreInfoText").setStyle({"height": "133px"});
							$("productTitle").update(_product.title);
							if ($("productTitle").clientHeight &gt; 28){//Big title
								//Big title, adapt styles
								$("productTitle").setStyle ({"fontSize":"16px"});
								if ($("productTitle").clientHeight &gt; 23) {//More than one line
									if ($("productTitle").clientHeight &gt; 46){//More than two lines
										if ($("productTitle").clientHeight &gt; 69){//More than three lines
											$("productTitle").setStyle ({"fontSize":"13px"});
											if ($("productTitle").clientHeight &gt; 49) //Still more than three lines
												$("moreInfoText").setStyle({"height": "90px"});
											else
												$("moreInfoText").setStyle({"height": "110px"});
										} 
										else{//Three lines
											$("moreInfoText").setStyle({"height": "110px"});
											$("productTitle").setStyle ({"fontSize":"14px"});	
										}
									}
									else //Two lines
										$("moreInfoText").setStyle({"height": "115px"});	
								}
								/*else //One line, 16px title
		 							$("moreInfoText").setStyle({
										"height": "125px"
									});*/
							}
							
						}
						if (_product.price){
							$("price").update(_product.price);
						} else {
							$("price").update("");
						}
						if (_product.pGroup){
							$("pGroup").update(_product.pGroup);
						} else {
							$("pGroup").update("");
						}
						if (_product.url){
							var a = new Element('a',{href:_product.url,target:"_blank"}).update ("Amazon");
							$("url").update (a);
						} else {
							$("url").update ("");
						}
						if (_product.image){
							var img = new Element ('img',{src: _product.image});
							$("productImage").update(img);
						} else {
							var img = new Element ('img',{src: "http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/amazon.jpg"});
							$("productImage").update(img);	
						}
										
					}
					
					Product.prototype.showAdvancedDetails = function (element,pGroup){
						/*List of possible product groups (with * groups already considered)
						 * Apparel,Baby Product,Beauty,*Book,*CE,*DVD,*eBooks,Furniture,Gourmet,Health and Beauty,
						 * Home,Home Improvement,Kitchen,Lawn &amp; Patio,Magazine,*Music,Musical Instruments,
						 * Office Product,*Personal Computer,Pet Products,*Photography,Single Detail Page Misc,
						 * *Software,Sports,*Theatrical Release,Toy,*Video,*Video Games,Watch,*Wireless,*Wireless Phone Accessory
						 */
						var itemAttributes = element.getElementsByTagName("ItemAttributes")[0];
						var attributesHTML = "&lt;ul&gt;";
						//List of elements to be shown
						var elementList = [];
						switch (pGroup){
							case "eBooks":
							case "Book":
								//Print all book authors
								attributesHTML += product.elementDetail("Author",itemAttributes,"Author(s)");
								//Print the remainder features
								elementList = [{nodeElement:"PublicationDate",caption:"Publication Date"},
											   "ISBN",
											   "Format",
											   {nodeElement:"Label", caption:"Publisher"},
											   {nodeElement:"NumberOfPages", caption:"Pages"}];	
							    attributesHTML += product.productDetailsList(elementList,itemAttributes);	
								break;
							case "Theatrical Release":
							case "Video":
							case "DVD":
								//Print all actors
								attributesHTML += product.elementDetail("Actor",itemAttributes,"Cast");
								//Print all directors
								attributesHTML += product.elementDetail("Director",itemAttributes);
								elementList = 	["Genre",
												{nodeElement:"RunningTime",caption: "Run Time"},
												{nodeElement:"AudienceRating", caption:"Audience Rating"},
												"Label",
												"Binding",
												"Region",
												{nodeElement:"AspectRatio", caption:"Aspect Ratio"},
												{nodeElement:"OriginalReleaseDate", caption:"Release Date"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.twoElements ("DVDLayers","DVDSides",itemAttributes,"DVD Layers / Sides");
								//Print technical details
								attributesHTML += product.elementDetail("Format",itemAttributes);
								break;
							case "Digital Music Track":
							case "Music":
								elementList = 	["Artist",
												"Genre",
												"Label",
												"Binding",
												"Format",
												{nodeElement:"NumberOfDiscs", caption:"Number of Discs"},
												{nodeElement:"ReleaseDate", caption:"Release Date"},
												{nodeElement:"OriginalReleaseDate", caption:"Original Release Date"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								break;
							case "Photography":
								//Print details 
								elementList = ["Brand","Model"];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);	
								//Print all camera features
								attributesHTML += product.elementDetail("Feature",itemAttributes,"Features",".");
								break;
							case "Personal Computer":
								elementList = 	["Model",
												"Label",
												"Binding"];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.twoElements ("CPUType","CPUSpeed",itemAttributes,"CPU", " ");
								elementList = 	[{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"HardDiskSize", caption:"Hard Disk Size"},
												{nodeElement:"DataLinkProtocol", caption:"Data Link Protocol"},
												{nodeElement:"FloppyDiskDriveDescription", caption:"Floppy Disk Drive"}];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.twoElements ("SystemMemorySize","SystemMemoryType",itemAttributes,"Memory", " ");								
								elementList = 	[{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												"Warranty",
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];	
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += product.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features
								attributesHTML += product.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							case "CE":
							case "Video Games":						
							case "Software":
							case "Wireless":
							case "Wireless Phone Accessory":
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"DisplaySize", caption:"Display Size"},
												{nodeElement:"ESRBAgeRating", caption:"Age Rating"},
												{nodeElement:"HardwarePlatform", caption:"Hardware Platform"},
												{nodeElement:"OperatingSystem", caption:"Operating System"},
												{nodeElement:"ReleaseDate",caption:"Release Date"},
												{nodeElement:"LegalDisclaimer",caption:"Legal Disclaimer"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								//Print technical details
								attributesHTML += product.elementDetail("Feature",itemAttributes, "Features",".");
								//Print special features (only CE)
								attributesHTML += product.specialElementDetail("SpecialFeatures",itemAttributes,"|","Special Features",".");
								break;
							default:
								elementList = 	["Model",
												"Color",
												"Label",
												"Binding",
												{nodeElement:"ReleaseDate",caption:"Release Date"}
												];
								attributesHTML += product.productDetailsList(elementList,itemAttributes);
								attributesHTML += product.elementDetail("Feature",itemAttributes, "Features",".");
								break;				
						}
						attributesHTML += "&lt;/ul&gt;";
						if (attributesHTML.length&gt;9){//There is something to show
							$("moreInfoText").update(attributesHTML);
							$("moreInfoText").setStyle({"borderTop":"1px dotted #AAAAAA"});
							$("moreInfoTitle").update("Product Details");
						} 
							
					}
					//This function returns a html with pre-formatted details list
					//Each element of attributesList can be an object with two elements (nodeElement and caption)
					//or simply a string representing both of them
					Product.prototype.productDetailsList = function (attributesList,attributesNode){
						var result = "";
						$A(attributesList).each(function(attribute){
								var element = attributesNode.getElementsByTagName ((attribute.nodeElement?attribute.nodeElement:attribute));						
								if (element.length &gt; 0) {
									result += "&lt;li&gt;" + (attribute.caption?attribute.caption:attribute) + ": ";
									result += "&lt;span class='detailsElement'&gt;";
									result += element[0].firstChild.nodeValue;
									if (element[0].getAttribute("Units") &amp;&amp; element[0].getAttribute("Units")!= "unknown-units")
										result += " " + element[0].getAttribute("Units");
									result += "&lt;/span&gt;&lt;/li&gt;";
								}
						});
						return result;
					}
					//This function produces a single li with a list of elements (authors, features...)
					//caption parameter is optional
					//separationCharacter parameter is optional
					Product.prototype.elementDetail = function (element,attributesNode,caption,separationCharacter){
							var list = attributesNode.getElementsByTagName(element);
							var result = "";
							if (list.length &gt; 0){
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								$A(list).each (function (e){
									result += e.firstChild.nodeValue + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					}
					//This function produces a single li with a list of features. The original line has 
					//extrange separators
					//caption parameter is optional
					//separationCharacter parameter is optional
					Product.prototype.specialElementDetail = function (element,attributesNode,beforeSeparationCharacter,caption,separationCharacter){
							var element = attributesNode.getElementsByTagName(element);
							var result = "";
							if (element.length &gt; 0){
								result += "&lt;li&gt;" + (caption?caption:element)  + ": &lt;span class='detailsElement'&gt;";
								var list = element[0].firstChild.nodeValue.split(beforeSeparationCharacter);
								$A(list).each (function (e){
									result += e + (separationCharacter?separationCharacter + " ":", ");
								});
								//Remove last ", "
								result = result.substring(0,result.length-2);
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;			
					}
					//This function produces a single li two elements separated by "/"
					//caption parameter is optional
					//separationCharacter is optional
					Product.prototype.twoElements = function (element1,element2,attributesNode, caption, separationCharacter){
							var _element1 = attributesNode.getElementsByTagName(element1);
							var _element2 = attributesNode.getElementsByTagName(element2);
							var result = "";
							//At least one correct element
							if (_element1.length &gt; 0 || _element2.length &gt; 0){
								result += "&lt;li&gt;" + (caption?caption:(element1 + " / " + element2))  + ": &lt;span class='detailsElement'&gt;";
								result += (_element1[0]?_element1[0].firstChild.nodeValue:"-");
								if (_element1[0].getAttribute("Units") &amp;&amp; _element1[0].getAttribute("Units")!= "unknown-units")
										result += " " + _element1[0].getAttribute("Units");
								result += (separationCharacter?separationCharacter:" / ");
								result += (_element2[0]?_element2[0].firstChild.nodeValue:"-");
								if (_element2[0].getAttribute("Units") &amp;&amp; _element2[0].getAttribute("Units")!= "unknown-units")
										result += " " + _element2[0].getAttribute("Units");
								result += "&lt;/span&gt;&lt;/li&gt;";							
							}
							return result;
					}
					
					Product.prototype.onError = function (transport){
		                //alert(transport.responseText);
		            }
		            
		            Product.prototype.addToCart = function (){
						var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
						var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
						var user = ScreenflowEngineFactory.getInstance().getFact('user');
						if (cart){//If the cart is already created, it will have an ID in the User Fact
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartGet";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;CartId=" + cart.data.id;
							url += "&amp;HMAC=" + cart.data.HMAC;
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
	                        new FastAPI.Request(url,{
	                            'method':       'get',
	                            'content':      'xml',
	                            'context':      product,
	                            'onSuccess':    product.isProductOnCart
	                        });
						}
						else { //Cart doesn't exist: Create a new cart with the product
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartCreate";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;Item.1.ASIN=" + item.data.ASIN;
							url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
	                    	new FastAPI.Request(url,{
                                'method':       'get',
                                'content':      'xml',
                                'context':      product,
                                'onSuccess':    product.cartCreated
                            });
						}
					}
					
					Product.prototype.cartCreated = function (transport){
						var xml = transport;
						
						//The product is added to the cart,
						//tell it to the user	
						if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True"){
							
							//Check if the product is eligible for shopping
							if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
								xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
								//The product is not elegible
								alert ("The product is not eligible to be added to the cart");
								return;
							}
							//Add the Cart ID to the KB
							var cart = {uri: 'http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart',
										data:{id: xml.getElementsByTagName("CartId")[0].firstChild.nodeValue,
											HMAC: xml.getElementsByTagName("URLEncodedHMAC")[0].firstChild.nodeValue}};
							ScreenflowEngineFactory.getInstance().manageFacts([cart],[]);
							alert ("Product added to the shopping Cart");
						}		
						else 
							alert ("Error adding the product to the cart");
					}
					
					Product.prototype.productAdded = function (transport){
						var xml = transport;
						//Check if the product is eligible for shopping
						if ((xml.getElementsByTagName("Error").length &gt; 0) &amp;&amp; 
							xml.getElementsByTagName("Error")[0].firstChild.firstChild.nodeValue == "AWS.ECommerceService.ItemNotEligibleForCart"){
							//The product is not elegible
							alert ("The product is not eligible to be added to the cart");
							return;
						}
						//If the product is added to the cart,
						//tell it to the user	
						if (xml.getElementsByTagName("IsValid")[0].firstChild.nodeValue == "True")
							alert ("Product added to the shopping Cart");
						else 
							alert ("Error adding the product to the cart");
					}		
					
					Product.prototype.isProductOnCart = function (transport){
						
						var xml = transport;
						var item = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#Item');
						var cart = ScreenflowEngineFactory.getInstance().getFact('http://fast.morfeo-project.org/ontologies/amazon#ShoppingCart');
						var user = ScreenflowEngineFactory.getInstance().getFact('user');
						//products node
						if (xml.getElementsByTagName ("CartItems").length&gt;0){ //There are products on the cart
								var products = xml.getElementsByTagName ("CartItems")[0];
								//Product list (ASINs) added to the cart
								var asins = $A(products.getElementsByTagName ("ASIN"));
								//Check if the product is already added to the cart
								var found = false;
								//product Node
								var _product; 
								asins.each (function(asin){
									if (asin.firstChild.nodeValue == item.data.ASIN)
									{
										found = true; //The product is in the list
										_product = asin.parentNode; //product = CartItem
									}
								});
						}
						else {//If there aren't elements, the product will not be on the list
							found = false;
						}
						if (found) { 
							//If the product is already added to the cart,
							//increase the number of items of that product (CartModify)			
							//Get the item quantity
							var prevQuantity = _product.getElementsByTagName("Quantity")[0].firstChild.nodeValue;
							//Add the new quantity to the previously stored
							var quantity = parseInt($F("quantitySelect")) + parseInt (prevQuantity);
							
							//Get the product Id within the cart
							var productId = _product.getElementsByTagName("CartItemId")[0].firstChild.nodeValue;	
		
							//Create the call
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartModify";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;CartId=" + cart.data.id;
							url += "&amp;HMAC=" + cart.data.HMAC;
							url += "&amp;Item.1.CartItemId=" + productId;
							url += "&amp;Item.1.Quantity=" + quantity;
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
                            new FastAPI.Request(url,{
                                'method':       'get',
                                'content':      'xml',
                                'context':      product,
                                'onSuccess':    product.productAdded
                            });
						}
						else {
		                    //Create the call
							var url = "http://webservices.amazon.com/onca/xml?Service=AWSECommerceService";
							//Add the AccessKeyId (get from the user fact)
							/*if (user)
								url += "&amp;AWSAccessKeyId=" + user.data.KeyId;
							else // if the KB doesn't contain a user key Id, add one by default
								url += "&amp;AWSAccessKeyId=15TNKDQJGH6BD0Z4KY02";*/
							//Add the operation Type
							url +="&amp;Operation=CartAdd";
							//Add the current version of the API
							url += "&amp;Version=2008-06-26";
							//Add item ID
							url += "&amp;CartId=" + cart.data.id;
							url += "&amp;HMAC=" + cart.data.HMAC;
							url += "&amp;Item.1.ASIN=" + item.data.ASIN;
							url += "&amp;Item.1.Quantity=" + $F("quantitySelect");
							
						var encoder = new URLAmazonEncoder();
						url = encoder.encode(url);
	
							//Invoke the service
                            new FastAPI.Request(url,{
                                'method':       'get',
                                'content':      'xml',
                                'context':      product,
                                'onSuccess':    product.productAdded
                            });
						}
					}
					
					var product = new Product();
					ScreenflowEngineFactory.getInstance().addScreenLoader("{{screenId}}", product.init);
		        &lt;/script&gt;
		    &lt;/head&gt;
		    &lt;body&gt;
		        &lt;div id="bodyDivDetails"&gt;
		        	&lt;div id="leftColumn"&gt;
				     	&lt;div id="productImage"&gt;
						&lt;/div&gt;
						&lt;div id="cart"&gt;
							&lt;div id="quantity"&gt;Quantity:  	&lt;select id="quantitySelect"&gt;
										  	&lt;option value ="1"&gt;1&lt;/option&gt;
										  	&lt;option value ="2"&gt;2&lt;/option&gt;
										  	&lt;option value ="3"&gt;3&lt;/option&gt;
										  	&lt;option value ="4"&gt;4&lt;/option&gt;
										  	&lt;option value ="5"&gt;5&lt;/option&gt;	
										 	&lt;option value ="6"&gt;6&lt;/option&gt;
										  	&lt;option value ="7"&gt;7&lt;/option&gt;	
										  	&lt;option value ="8"&gt;8&lt;/option&gt;		
											&lt;option value ="9"&gt;9&lt;/option&gt;	
										  	&lt;option value ="10"&gt;10&lt;/option&gt;						
											&lt;/select&gt;
							&lt;/div&gt;
							&lt;input border="0" height="27" width="160" type="image" id="addToCart" alt="Add to Shopping Cart" src="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/images/addToCart.gif"/&gt;
						&lt;/div&gt;       	
					&lt;/div&gt;
					&lt;div id="rightColumn"&gt;
						&lt;div id="productTitle" style="font-size: 20px; padding: 2px; color:#F8A704; font-weight: bold; font-style: italic; font-family:Arial,Helvetica,sans-serif; overflow: hidden;"&gt;&lt;/div&gt;
						&lt;div id="infoArea"&gt;
							&lt;span id="titleInfo"&gt;
								&lt;div class="title"&gt;Product Type: &lt;/div&gt;
								&lt;div class="title"&gt;Price: &lt;/div&gt;
								&lt;div class="title"&gt;Product Site: &lt;/div&gt;
								&lt;div class="title" id="titleInfo1"&gt;&lt;/div&gt;
							&lt;/span&gt;
							&lt;span id="valueInfo"&gt;
								&lt;div id="pGroup" class="info"&gt;&lt;/div&gt;
								&lt;div id="price" class="info"&gt;&lt;/div&gt;
								&lt;div id="url" class="info"&gt;&lt;/div&gt;
								&lt;div id="info1" class="info"&gt;&lt;/div&gt;
							&lt;/span&gt;
							&lt;div id="moreInfo"&gt;
								&lt;div class="title" id="moreInfoTitle"&gt;&lt;/div&gt;
								&lt;div id="moreInfoText"&gt;
								&lt;/div&gt;
							&lt;/div&gt;
						&lt;/div&gt;
					&lt;/div&gt;
		        &lt;/div&gt;
		    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="275" model="buildingblock.buildingblockcode">
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">275</field>
        <field type="TextField" name="code">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
		    .detailsForm {
		        max-width:550px;
				text-align:center;
				margin: 8px auto 20px auto;
				height:270px;
		    }
			.image{
				height: 170px;
				-moz-border-radius: 13px 13px;
				background: #FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				margin:0px auto 13px;
				text-align:center;
				width:88%;
				padding-bottom:5px;
				padding-top:10px;
			}
            .image img {
                max-width: 99%;
                max-height: 99%;
            }
			.leftColumn{
				position: relative;
				float:left;
				height: 100%;
				width: 35%;
			}
			.rightColumn{
				position: relative;
				float:right;
				height: 268px;
				width: 60%;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				padding-top:5px;
				padding-right:0px;
				padding-left:5px;
				padding-bottom: 5px;
				position:relative;
			}
			.itemTitle {
			    font-size: 20px; 
			    padding: 2px; 
			    color:#F8A704; 
			    font-weight: bold; 
			    font-style: italic; 
			    font-family: Arial, Helvetica, sans-serif; 
			    overflow: hidden;
			}
			.infoArea{
				text-align: left;
			}
			.titleInfo{
				float:left;
				margin: 5px;
				width:25%;
				overflow: hidden;
			}
			.valueInfo{
				float:left;
				margin: 5px;
				width: 65%;
			}
			.moreInfo{
				float:left;
				margin-left: 5px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
			.info{
				padding: 2px;
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-weight: bold;
				text-align: justify;
				white-space: nowrap;
				overflow: hidden;
			}
			.moreInfoText {
				color: #888888;
				font-family: Arial, Helvetica, sans-serif;
				font-size: 13px;
				height: 133px;
				margin: 0;
				overflow: auto;
				padding: 2px 15px 2px 2px;
				text-align: left;
				width: 300px;
				max-width: 300px;
				border-top:1px dotted #AAAAAA;
			}
			.detailsElement {
				color:#888888;
				font-weight:bold;
			}
		&lt;/style&gt;
       &lt;script language="JavaScript"&gt;
        	var {{buildingblockId}} = Class.create(BuildingBlock,{
					init: function (){
					    var details = new Element('div', {
						    'class': 'detailsForm'
						});

						var body = $('{{screenId}}_body');
						body.innerHTML = '';
						body.appendChild(details);
						
						// Left Column (Image)
						var leftColumn = new Element('div', {
						    'class': 'leftColumn'
						});
						this._image = new Element('div', {
						    'class': 'image'
						});
						leftColumn.appendChild(this._image);
						details.appendChild(leftColumn);
						
						// Right Column (Details)
						var rightColumn = new Element('div', {
						    'class': 'rightColumn'
						});
						details.appendChild(rightColumn);
						
						this._title = new Element('div', {
						    'class': 'itemTitle'
						});
						rightColumn.appendChild(this._title);
						var infoArea = new Element('div', {
					        'class': 'infoArea'
						});
                        rightColumn.appendChild(infoArea);
                        
                        this._titleInfo = new Element('div', {
                            'class': 'titleInfo'
                        });
                        infoArea.appendChild(this._titleInfo);
                        this._valueInfo = new Element('div', {
                            'class': 'valueInfo'
                        });
                        infoArea.appendChild(this._valueInfo);
                        var moreInfo = new Element('div', {
                            'class': 'moreInfo'
                        });
                        this._moreInfoTitle = new Element('div', {
                            'class': 'title'
                        });
                        this._moreInfoText = new Element('div', {
                            'class': 'moreInfoText'
                        });
                        moreInfo.appendChild(this._moreInfoTitle);
                        moreInfo.appendChild(this._moreInfoText);
                        infoArea.appendChild(moreInfo);
					},

					showProductInfo: function (_product){
						if (_product.data.title) {
							//Reset styles
							this._title.setStyle ({"fontSize":"20px"});
							this._moreInfoText.setStyle({"height": "133px"});
							this._title.update(_product.data.title);
							if (this._title.clientHeight &gt; 28) {//Big title
								//Big title, adapt styles
								this._title.setStyle ({"fontSize":"16px"});
								if (this._title.clientHeight &gt; 23) {//More than one line
									if (this._title.clientHeight &gt; 46) {//More than two lines
										if (this._title.clientHeight &gt; 69) {//More than three lines
											this._title.setStyle ({"fontSize":"13px"});
											if (this._title.clientHeight &gt; 49) {//Still more than three lines
												this._moreInfoText.setStyle({"height": "90px"});
											} else {
												this._moreInfoText.setStyle({"height": "110px"});
											}
										} 
										else{//Three lines
											this._moreInfoText.setStyle({"height": "110px"});
											this._title.setStyle ({"fontSize":"14px"});
										}
									} else {//Two lines
										this._moreInfoText.setStyle({"height": "115px"});
									}
								}
							}
							
						}
						
						this.insertElement("Website", _product.data.url);
						if (_product.data.image) {
							var img = new Element ('img',{src: _product.data.image});
							this._image.update(img);
						}
						if (this.parameter &amp;&amp; this.parameter.elements) {
						    this.parameter.elements.each(function(element) {
						        this.insertElement(this.capitalize(element), 
						            _product.data.details[element]);
						    }.bind(this));
						}
						this.showAdvancedDetails(_product);
					},
					
					showAdvancedDetails: function(_product) {
					    
				        var details = $H(_product.data.details);
				        if (details) {
				            if (this.parameter &amp;&amp; this.parameter.itemTitle) {
				                this._moreInfoTitle.update(this.parameter.itemTitle + " Details");
				            } else {
				                this._moreInfoTitle.update("Details");
				            }
                
                            var list = new Element('ul');
				            details.each(function(pair){
				                var appendElement = true;
				                if (this.parameter &amp;&amp; this.parameter.elements) {
				                    if (this.parameter.elements.lastIndexOf(pair.key) != -1) {
				                        appendElement = false;
				                    }
				                }
				                if (appendElement) {
				                    var node = this.createDetailNode(pair.key, pair.value);
				                    if (node) {
				                       list.appendChild(node);
				                    }
				                }
				            }.bind(this));
				            this._moreInfoText.appendChild(list);
				        }
					},
					
					
					
					createDetailNode: function(key, value) {
					    var title = this.capitalize(key);
					    var li = new Element('li').update(title + ": ");
                        if (typeof value == "string") {
					        li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(this.sanitize(value)));
					        return li;
                        } else if (value instanceof Array) {
                            var finalValue = value.join(", ");
                            li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(finalValue));
					        return li; 
                        } else {
                            return null;
                        }
					},
					
					insertElement: function(title, value) {
					    if(value) {
				            this._titleInfo.appendChild(new Element('div', {
						        'class': 'title'
						    }).update(title + ': '));
							this._valueInfo.appendChild(new Element('div', {
							    'class': 'info'
							}).update(this.sanitize(value)));
						}
					},
					
					sanitize: function(value) {
					    var validChars = "[\\w\\!\\#\\$\\%\\&amp;\\\'\\*\\+\\-\\/\\=\\?\\^\\`\\{\\|\\}\\~]+";
                        var mail = new RegExp("("+validChars+"(?:\\."+validChars+")*@"+validChars+"(?:\\."+validChars+")+)", "g");
                        var url = new RegExp("(\\w+\\:\\/\\/\\w+(?:\\.\\w+)*(?:\\:\\d+)?(?:\\/\\w+)*(?:[\\w\\.\\?\\=\\/\\#\\%\\&amp;\\+\\-]*))", "g");
					    var finalValue = value.replace(mail, '&lt;a href="mailto:$1"&gt;$1&lt;/a&gt;');
                        finalValue = finalValue.replace(url, '&lt;a href="$1" target="_blank"&gt;$1&lt;/a&gt;');
                        return finalValue;
					},
					
					capitalize: function(text) {
					    return text.split(" ").collect(function(e){return e.capitalize()}).join(" ");
					},
					
					showMessage: function (message){
						// TODO
					}
        	});
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="{{screenId}}_body"&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
        <field type="TextField" name="unboundCode">&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /&gt;
        &lt;link type="text/css" rel="stylesheet" href="http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/screen.css" /&gt;
		&lt;style type="text/css"&gt;
		    .detailsForm {
		        max-width:550px;
				text-align:center;
				margin: 8px auto 20px auto;
				height:270px;
		    }
			.image{
				height: 170px;
				-moz-border-radius: 13px 13px;
				background: #FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				margin:0px auto 13px;
				text-align:center;
				width:88%;
				padding-bottom:5px;
				padding-top:10px;
			}
            .image img {
                max-width: 99%;
                max-height: 99%;
            }
			.leftColumn{
				position: relative;
				float:left;
				height: 100%;
				width: 35%;
			}
			.rightColumn{
				position: relative;
				float:right;
				height: 268px;
				width: 60%;
				-moz-border-radius:13px 13px;
				background:#FFF8E8 url(http://demo.fast.morfeo-project.org/gvsdata/amazonScreens/style/bg_td2.jpg) repeat-x;
				border:1px solid #F8A704;
				padding-top:5px;
				padding-right:0px;
				padding-left:5px;
				padding-bottom: 5px;
				position:relative;
			}
			.itemTitle {
			    font-size: 20px; 
			    padding: 2px; 
			    color:#F8A704; 
			    font-weight: bold; 
			    font-style: italic; 
			    font-family: Arial, Helvetica, sans-serif; 
			    overflow: hidden;
			}
			.infoArea{
				text-align: left;
			}
			.titleInfo{
				float:left;
				margin: 5px;
				width:25%;
				overflow: hidden;
			}
			.valueInfo{
				float:left;
				margin: 5px;
				width: 65%;
			}
			.moreInfo{
				float:left;
				margin-left: 5px;
			}
			.title{
				padding: 2px;
				color:#AAAAAA;
				font-weight: bold;
				font-family:Arial,Helvetica,sans-serif;	
				white-space:nowrap;
				overflow: hidden;
			}
			.info{
				padding: 2px;
				color:#888888;
				font-family:Arial,Helvetica,sans-serif;
				font-weight: bold;
				text-align: justify;
				white-space: nowrap;
				overflow: hidden;
			}
			.moreInfoText {
				color: #888888;
				font-family: Arial, Helvetica, sans-serif;
				font-size: 13px;
				height: 133px;
				margin: 0;
				overflow: auto;
				padding: 2px 15px 2px 2px;
				text-align: left;
				width: 300px;
				max-width: 300px;
				border-top:1px dotted #AAAAAA;
			}
			.detailsElement {
				color:#888888;
				font-weight:bold;
			}
		&lt;/style&gt;
       &lt;script language="JavaScript"&gt;
        	var {{buildingblockId}} = Class.create(BuildingBlock,{
					init: function (){
					    var details = new Element('div', {
						    'class': 'detailsForm'
						});

						var body = $('{{screenId}}_body');
						body.innerHTML = '';
						body.appendChild(details);
						
						// Left Column (Image)
						var leftColumn = new Element('div', {
						    'class': 'leftColumn'
						});
						this._image = new Element('div', {
						    'class': 'image'
						});
						leftColumn.appendChild(this._image);
						details.appendChild(leftColumn);
						
						// Right Column (Details)
						var rightColumn = new Element('div', {
						    'class': 'rightColumn'
						});
						details.appendChild(rightColumn);
						
						this._title = new Element('div', {
						    'class': 'itemTitle'
						});
						rightColumn.appendChild(this._title);
						var infoArea = new Element('div', {
					        'class': 'infoArea'
						});
                        rightColumn.appendChild(infoArea);
                        
                        this._titleInfo = new Element('div', {
                            'class': 'titleInfo'
                        });
                        infoArea.appendChild(this._titleInfo);
                        this._valueInfo = new Element('div', {
                            'class': 'valueInfo'
                        });
                        infoArea.appendChild(this._valueInfo);
                        var moreInfo = new Element('div', {
                            'class': 'moreInfo'
                        });
                        this._moreInfoTitle = new Element('div', {
                            'class': 'title'
                        });
                        this._moreInfoText = new Element('div', {
                            'class': 'moreInfoText'
                        });
                        moreInfo.appendChild(this._moreInfoTitle);
                        moreInfo.appendChild(this._moreInfoText);
                        infoArea.appendChild(moreInfo);
					},

					showProductInfo: function (_product){
						if (_product.data.title) {
							//Reset styles
							this._title.setStyle ({"fontSize":"20px"});
							this._moreInfoText.setStyle({"height": "133px"});
							this._title.update(_product.data.title);
							if (this._title.clientHeight &gt; 28) {//Big title
								//Big title, adapt styles
								this._title.setStyle ({"fontSize":"16px"});
								if (this._title.clientHeight &gt; 23) {//More than one line
									if (this._title.clientHeight &gt; 46) {//More than two lines
										if (this._title.clientHeight &gt; 69) {//More than three lines
											this._title.setStyle ({"fontSize":"13px"});
											if (this._title.clientHeight &gt; 49) {//Still more than three lines
												this._moreInfoText.setStyle({"height": "90px"});
											} else {
												this._moreInfoText.setStyle({"height": "110px"});
											}
										} 
										else{//Three lines
											this._moreInfoText.setStyle({"height": "110px"});
											this._title.setStyle ({"fontSize":"14px"});
										}
									} else {//Two lines
										this._moreInfoText.setStyle({"height": "115px"});
									}
								}
							}
							
						}
						
						this.insertElement("Website", _product.data.url);
						if (_product.data.image) {
							var img = new Element ('img',{src: _product.data.image});
							this._image.update(img);
						}
						if (this.parameter &amp;&amp; this.parameter.elements) {
						    this.parameter.elements.each(function(element) {
						        this.insertElement(this.capitalize(element), 
						            _product.data.details[element]);
						    }.bind(this));
						}
						this.showAdvancedDetails(_product);
					},
					
					showAdvancedDetails: function(_product) {
					    
				        var details = $H(_product.data.details);
				        if (details) {
				            if (this.parameter &amp;&amp; this.parameter.itemTitle) {
				                this._moreInfoTitle.update(this.parameter.itemTitle + " Details");
				            } else {
				                this._moreInfoTitle.update("Details");
				            }
                
                            var list = new Element('ul');
				            details.each(function(pair){
				                var appendElement = true;
				                if (this.parameter &amp;&amp; this.parameter.elements) {
				                    if (this.parameter.elements.lastIndexOf(pair.key) != -1) {
				                        appendElement = false;
				                    }
				                }
				                if (appendElement) {
				                    var node = this.createDetailNode(pair.key, pair.value);
				                    if (node) {
				                       list.appendChild(node);
				                    }
				                }
				            }.bind(this));
				            this._moreInfoText.appendChild(list);
				        }
					},
					
					
					
					createDetailNode: function(key, value) {
					    var title = this.capitalize(key);
					    var li = new Element('li').update(title + ": ");
                        if (typeof value == "string") {
					        li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(this.sanitize(value)));
					        return li;
                        } else if (value instanceof Array) {
                            var finalValue = value.join(", ");
                            li.appendChild(new Element('span', {
					            'class': 'detailsElement'
					        }).update(finalValue));
					        return li; 
                        } else {
                            return null;
                        }
					},
					
					insertElement: function(title, value) {
					    if(value) {
				            this._titleInfo.appendChild(new Element('div', {
						        'class': 'title'
						    }).update(title + ': '));
							this._valueInfo.appendChild(new Element('div', {
							    'class': 'info'
							}).update(this.sanitize(value)));
						}
					},
					
					sanitize: function(value) {
					    var validChars = "[\\w\\!\\#\\$\\%\\&amp;\\\'\\*\\+\\-\\/\\=\\?\\^\\`\\{\\|\\}\\~]+";
                        var mail = new RegExp("("+validChars+"(?:\\."+validChars+")*@"+validChars+"(?:\\."+validChars+")+)", "g");
                        var url = new RegExp("(\\w+\\:\\/\\/\\w+(?:\\.\\w+)*(?:\\:\\d+)?(?:\\/\\w+)*(?:[\\w\\.\\?\\=\\/\\#\\%\\&amp;\\+\\-]*))", "g");
					    var finalValue = value.replace(mail, '&lt;a href="mailto:$1"&gt;$1&lt;/a&gt;');
                        finalValue = finalValue.replace(url, '&lt;a href="$1" target="_blank"&gt;$1&lt;/a&gt;');
                        return finalValue;
					},
					
					capitalize: function(text) {
					    return text.split(" ").collect(function(e){return e.capitalize()}).join(" ");
					},
					
					showMessage: function (message){
						// TODO
					}
        	});
		&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="{{screenId}}_body"&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</field>
    </object>
    <object pk="1" model="buildingblock.tag">
        <field type="CharField" name="name">generic</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="2" model="buildingblock.tag">
        <field type="CharField" name="name">details</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="3" model="buildingblock.tag">
        <field type="CharField" name="name">list</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="4" model="buildingblock.tag">
        <field type="CharField" name="name">form</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="5" model="buildingblock.tag">
        <field type="CharField" name="name">amazon</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means">http://dbpedia.org/page/Amazon.com</field>
    </object>
    <object pk="6" model="buildingblock.tag">
        <field type="CharField" name="name">search</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="7" model="buildingblock.tag">
        <field type="CharField" name="name">ebay</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="8" model="buildingblock.tag">
        <field type="CharField" name="name">cart</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="9" model="buildingblock.tag">
        <field type="CharField" name="name">shopping</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="10" model="buildingblock.tag">
        <field type="CharField" name="name">price</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="11" model="buildingblock.tag">
        <field type="CharField" name="name">comparative</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="12" model="buildingblock.tag">
        <field type="CharField" name="name">order</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="13" model="buildingblock.tag">
        <field type="CharField" name="name">purchase</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="14" model="buildingblock.tag">
        <field type="CharField" name="name">suggestion</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="15" model="buildingblock.tag">
        <field type="CharField" name="name">product</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="16" model="buildingblock.tag">
        <field type="CharField" name="name">filter</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="17" model="buildingblock.tag">
        <field type="CharField" name="name">item</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="18" model="buildingblock.tag">
        <field type="CharField" name="name">mixer</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="19" model="buildingblock.tag">
        <field type="CharField" name="name">offer</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="20" model="buildingblock.tag">
        <field type="CharField" name="name">clear</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="21" model="buildingblock.tag">
        <field type="CharField" name="name">update</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="22" model="buildingblock.tag">
        <field type="CharField" name="name">scratch</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="23" model="buildingblock.tag">
        <field type="CharField" name="name">lista</field>
        <field type="CharField" name="language">es-es</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="24" model="buildingblock.tag">
        <field type="CharField" name="name">en-gb</field>
        <field type="CharField" name="language">amazon</field>
        <field type="CharField" name="means">http://dbpedia.org/page/Amazon.com</field>
    </object>
    <object pk="25" model="buildingblock.tag">
        <field type="CharField" name="name">en-gb</field>
        <field type="CharField" name="language">list</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="26" model="buildingblock.tag">
        <field type="CharField" name="name">en-gb</field>
        <field type="CharField" name="language">search</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="27" model="buildingblock.tag">
        <field type="CharField" name="name">nvivo</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="28" model="buildingblock.tag">
        <field type="CharField" name="name">events</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="29" model="buildingblock.tag">
        <field type="CharField" name="name">google</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="30" model="buildingblock.tag">
        <field type="CharField" name="name">amazon</field>
        <field type="CharField" name="language">en-gb</field>
        <field type="CharField" name="means"><None></None></field>
    </object>
    <object pk="940" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">2</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">318</field>
    </object>
    <object pk="939" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">15</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">318</field>
    </object>
    <object pk="938" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">318</field>
    </object>
    <object pk="937" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">318</field>
    </object>
    <object pk="936" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">317</field>
    </object>
    <object pk="935" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">317</field>
    </object>
    <object pk="934" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">316</field>
    </object>
    <object pk="933" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">14</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">316</field>
    </object>
    <object pk="932" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">316</field>
    </object>
    <object pk="931" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">316</field>
    </object>
    <object pk="930" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">12</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">315</field>
    </object>
    <object pk="929" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">315</field>
    </object>
    <object pk="928" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">315</field>
    </object>
    <object pk="927" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">314</field>
    </object>
    <object pk="926" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">11</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">314</field>
    </object>
    <object pk="925" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">314</field>
    </object>
    <object pk="924" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">314</field>
    </object>
    <object pk="923" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">8</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">313</field>
    </object>
    <object pk="922" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">313</field>
    </object>
    <object pk="921" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">313</field>
    </object>
    <object pk="920" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">312</field>
    </object>
    <object pk="919" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">7</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">312</field>
    </object>
    <object pk="918" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">312</field>
    </object>
    <object pk="917" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">312</field>
    </object>
    <object pk="916" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">311</field>
    </object>
    <object pk="915" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">311</field>
    </object>
    <object pk="914" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">311</field>
    </object>
    <object pk="913" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">23</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">310</field>
    </object>
    <object pk="912" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">310</field>
    </object>
    <object pk="911" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">310</field>
    </object>
    <object pk="910" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">22</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">310</field>
    </object>
    <object pk="909" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">17</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">309</field>
    </object>
    <object pk="908" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">309</field>
    </object>
    <object pk="907" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">309</field>
    </object>
    <object pk="906" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">308</field>
    </object>
    <object pk="905" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">308</field>
    </object>
    <object pk="904" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">9</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">308</field>
    </object>
    <object pk="903" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">308</field>
    </object>
    <object pk="902" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">30</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">308</field>
    </object>
    <object pk="901" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">17</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">307</field>
    </object>
    <object pk="900" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">307</field>
    </object>
    <object pk="899" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">29</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">307</field>
    </object>
    <object pk="898" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">306</field>
    </object>
    <object pk="897" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">306</field>
    </object>
    <object pk="896" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">9</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">306</field>
    </object>
    <object pk="895" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">306</field>
    </object>
    <object pk="894" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">29</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">306</field>
    </object>
    <object pk="893" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">305</field>
    </object>
    <object pk="892" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">305</field>
    </object>
    <object pk="891" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">9</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">305</field>
    </object>
    <object pk="890" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">29</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">305</field>
    </object>
    <object pk="889" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">304</field>
    </object>
    <object pk="888" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">304</field>
    </object>
    <object pk="887" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">28</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">304</field>
    </object>
    <object pk="886" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">27</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">304</field>
    </object>
    <object pk="885" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">303</field>
    </object>
    <object pk="884" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">303</field>
    </object>
    <object pk="883" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">303</field>
    </object>
    <object pk="882" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">7</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">303</field>
    </object>
    <object pk="881" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">17</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">302</field>
    </object>
    <object pk="880" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">302</field>
    </object>
    <object pk="879" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">7</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">302</field>
    </object>
    <object pk="878" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">301</field>
    </object>
    <object pk="877" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">14</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">301</field>
    </object>
    <object pk="876" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">301</field>
    </object>
    <object pk="875" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">11</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">300</field>
    </object>
    <object pk="874" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">10</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">300</field>
    </object>
    <object pk="873" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">300</field>
    </object>
    <object pk="872" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">21</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">299</field>
    </object>
    <object pk="871" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">9</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">299</field>
    </object>
    <object pk="870" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">8</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">299</field>
    </object>
    <object pk="869" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">299</field>
    </object>
    <object pk="840" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">289</field>
    </object>
    <object pk="839" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">17</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">289</field>
    </object>
    <object pk="838" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">16</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">289</field>
    </object>
    <object pk="837" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">288</field>
    </object>
    <object pk="836" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">18</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">288</field>
    </object>
    <object pk="835" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">287</field>
    </object>
    <object pk="834" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">17</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">287</field>
    </object>
    <object pk="833" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">16</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">287</field>
    </object>
    <object pk="832" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">2</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">286</field>
    </object>
    <object pk="831" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">15</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">286</field>
    </object>
    <object pk="830" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">286</field>
    </object>
    <object pk="829" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">285</field>
    </object>
    <object pk="828" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">14</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">285</field>
    </object>
    <object pk="827" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">285</field>
    </object>
    <object pk="826" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">13</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">284</field>
    </object>
    <object pk="825" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">12</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">284</field>
    </object>
    <object pk="824" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">284</field>
    </object>
    <object pk="823" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">283</field>
    </object>
    <object pk="822" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">11</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">283</field>
    </object>
    <object pk="821" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">10</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">283</field>
    </object>
    <object pk="820" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">283</field>
    </object>
    <object pk="819" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">9</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">282</field>
    </object>
    <object pk="818" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">8</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">282</field>
    </object>
    <object pk="817" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">282</field>
    </object>
    <object pk="816" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">281</field>
    </object>
    <object pk="815" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">7</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">281</field>
    </object>
    <object pk="814" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">281</field>
    </object>
    <object pk="813" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">280</field>
    </object>
    <object pk="812" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">280</field>
    </object>
    <object pk="811" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">2</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">279</field>
    </object>
    <object pk="810" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">279</field>
    </object>
    <object pk="809" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">278</field>
    </object>
    <object pk="808" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">278</field>
    </object>
    <object pk="807" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">4</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">277</field>
    </object>
    <object pk="806" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">277</field>
    </object>
    <object pk="805" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">276</field>
    </object>
    <object pk="804" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">276</field>
    </object>
    <object pk="803" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">2</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">275</field>
    </object>
    <object pk="802" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">275</field>
    </object>
    <object pk="868" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">8</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">298</field>
    </object>
    <object pk="867" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">298</field>
    </object>
    <object pk="866" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">298</field>
    </object>
    <object pk="865" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">298</field>
    </object>
    <object pk="864" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">15</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">297</field>
    </object>
    <object pk="863" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">297</field>
    </object>
    <object pk="862" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">296</field>
    </object>
    <object pk="861" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">296</field>
    </object>
    <object pk="860" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">296</field>
    </object>
    <object pk="859" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">8</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">295</field>
    </object>
    <object pk="858" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">17</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">295</field>
    </object>
    <object pk="857" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">295</field>
    </object>
    <object pk="856" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">9</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">294</field>
    </object>
    <object pk="855" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">8</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">294</field>
    </object>
    <object pk="854" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">20</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">294</field>
    </object>
    <object pk="853" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">294</field>
    </object>
    <object pk="852" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">9</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">293</field>
    </object>
    <object pk="851" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">19</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">293</field>
    </object>
    <object pk="850" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">293</field>
    </object>
    <object pk="849" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">3</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">292</field>
    </object>
    <object pk="848" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">6</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">292</field>
    </object>
    <object pk="847" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">7</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">292</field>
    </object>
    <object pk="846" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">16</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">291</field>
    </object>
    <object pk="845" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">7</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">291</field>
    </object>
    <object pk="844" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">5</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">291</field>
    </object>
    <object pk="843" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">1</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">290</field>
    </object>
    <object pk="842" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">17</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">290</field>
    </object>
    <object pk="841" model="buildingblock.usertag">
        <field to="buildingblock.tag" name="tag" rel="ManyToOneRel">16</field>
        <field to="auth.user" name="user" rel="ManyToOneRel">1</field>
        <field to="buildingblock.buildingblock" name="buildingBlock" rel="ManyToOneRel">290</field>
    </object>
</django-objects>