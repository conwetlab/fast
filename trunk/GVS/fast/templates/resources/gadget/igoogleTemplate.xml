{% extends "resources/gadget/igoogleTemplateBase.xml" %}
{% block content %}
<link rel="stylesheet" type="text/css" href="{{ gadgetUri }}/resources/menu/css/menu.css" />
<SCRIPT language="javascript" src="{{ gadgetUri }}/js/fast/menu.js"></SCRIPT>
<SCRIPT language="javascript" src="{{ gadgetUri }}/js/fast/engine.js"></SCRIPT>
<SCRIPT language="javascript" src="{{ gadgetUri }}/js/prototype/prototype.js"></SCRIPT>
<SCRIPT language="javascript" src="{{ gadgetUri }}/js/fastAPI/fastAPI.js"></SCRIPT>
<SCRIPT language="javascript" src="{{ gadgetUri }}/js/fastAPI/fastAPI_igoogle.js"></SCRIPT>
<SCRIPT language="javascript">
    var menu = null;
    var screens = new Hash();
{# Here the screens involved inside the gadget are defined #}
{% load fastFilters %}
{% for screen in gadgetScreens %}
    screens.set("{{ screen.label|cut:" " }}",
        {title: "{{ screen.label|cut:" " }}",
        contentEl:"{{ screen.label|cut:" " }}",
        pre: [{% for pre in screen.preconditions %}'{{ pre }}'{% if not forloop.last %}, {% endif %}{% endfor %}]});
{% endfor %}
    var events = new Hash();
    function loadMenu(){
        menu = new FASTMenu({renderTo: "menu"});
        
        EngineFactory.getInstance().setEngine(screens, events, menu);
        
        EngineFactory.getInstance().run();
    }
    _IG_RegisterOnloadHandler(loadMenu);
</SCRIPT>
<div id="menu"></div>
{# TODO: screen in screens should have a code field #}
{% for screen in gadgetScreens %}
<div id="{{ screen.label|cut:" " }}" class="tabcontentHide">
    <object id="{{ screen.label|cut:" " }}_obj" width="100%" height="100%">
        {{ screen.allCode|safe }}
    </object>
</div>
{% endfor %}
{% endblock content %}
